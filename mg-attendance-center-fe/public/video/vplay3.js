!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],t):t((e=e||self).vplay={},e.React)}(this,(function(e,t){"use strict";function s(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("media","screen"),t.innerHTML=e,document.head.appendChild(t),e}}var n="default"in t?t.default:t;function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e}).apply(this,arguments)}class r{constructor(){this.eventMap=new Map(),this.allEventMap=new Set(),this.singleEventMap=new Map(),this._disabled=!1}static transferEvent(e,t){e.onevery((e,...s)=>t.emit(e,...s))}disable(e=!0){this._disabled=e}copyEvent(e){e.eventMap.forEach((e,t)=>this.eventMap.set(t,new Set(e))),e.allEventMap.forEach(e=>this.allEventMap.add(e)),e.singleEventMap.forEach((e,t)=>this.singleEventMap.set(t,new Set(e)))}getEventMap(e,t){return e.get(t)||e.set(t,new Set()),e.get(t)}on(e,t){if(Array.isArray(e))return e.forEach(e=>this.getEventMap(this.eventMap,e).add(t)),()=>e.forEach(e=>this.getEventMap(this.eventMap,e).delete(t));{const s=this.getEventMap(this.eventMap,e);return s.add(t),()=>s.delete(t)}}once(e,t){this.getEventMap(this.singleEventMap,e).add(t)}onevery(e){this.allEventMap.add(e)}emit(e,...t){if(this._disabled)return;this.getEventMap(this.eventMap,e).forEach(e=>e(...t));const s=this.getEventMap(this.singleEventMap,e);s.forEach(e=>{e(...t),s.delete(e)}),this.allEventMap.forEach(s=>s(e,...t))}unEvent(e){this.eventMap.delete(e),this.singleEventMap.delete(e)}destory(){this.eventMap.clear(),this.allEventMap.clear(),this.singleEventMap.clear()}}let o=0;const a=["#d64e4e","#bada55","#7ec699"];class l{constructor(e,t){this.level={},this.name=void 0,this.color=void 0,this.name=e,this.color=`\n    color: ${a[o]};\n    font-style: italic;\n    padding: 2px;\n    width: 100px;\n  `,o++}log(e,...t){console[e](`%c${this.name}:`,this.color,...t)}info(e,...t){e&&this.log("log",...t)}group(...e){}groupEnd(...e){}debug(...e){this.level.debug&&this.log("log",...e)}warn(e,t,...s){return e&&console.log(`%c${this.name}:`,this.color,t,...s),e}error(e,...t){return e&&this.log("error",...t),e}destory(){}}l.level=1;class c{constructor(){this.buffer=[],this.complete=!1,this.next=null,this.totalLength=0}addBuffer(e){this.buffer.push(e),this.totalLength+=e.byteLength}isEnd(){return this.complete}endOfBuffer(){this.complete=!0}getBuffer(){if(0===this.totalLength)return new ArrayBuffer(0);if(1===this.buffer.length)return this.buffer[0];const e=new Uint8Array(this.totalLength);let t=0;for(let s=0;s<this.buffer.length;s++){const n=new Uint8Array(this.buffer[s]);e.set(n,t),t+=n.byteLength}return e.buffer}}function h(e,t){return e.status&t}function u(e){return{set:t=>function(e,t){e.status=t}(e,t),has:t=>h(e,t),no:t=>!h(e,t),contact:t=>function(e,t){e.status|=t}(e,t),remove:t=>function(e,t){e.status&=~t}(e,t),replace:(t,s)=>function(e,t,s){e.status&=~t,e.status|=s}(e,t,s)}}class d{constructor(){this.log=new l("basic-download"),this.status=0,this.error=null,this._onerror=null,this._onDownBuffer=null,this._onDownMessage=null,this._onpause=null,this._onresume=null,this._contentLength=0,this._receivedLength=0}set onerror(e){this._onerror=e}set onpause(e){this._onpause=e}set onresume(e){this._onresume=e}set contentLength(e){this._contentLength=e}set onDownBuffer(e){this._onDownBuffer=e}set onDownMessage(e){this._onDownMessage=e}open(){return this.log.debug('it\'s virutal function "open", please implements it'),Promise.resolve()}pause(){this.log.debug('it\'s virutal function "pause", please implements it')}resume(){this.log.debug('it\'s virutal function "resume", please implements it')}destory(){this.log.debug('it\'s virutal function "destory", please implements it')}isDone(){return this.log.debug('it\'s virutal function "isDone", please implements it'),!1}}function p(){}function m(){let e=[p,p];const t=new Promise((t,s)=>{e=[t,s]});return[e,t]}const f=new l("downloader");class y extends d{constructor(e){super(),this.url="",this.socket=void 0,this.opened=!1,this.onmessage=e=>{const t=e.data;if(t instanceof ArrayBuffer)this._onDownBuffer&&this._onDownBuffer(t,this.isDone());else if(t instanceof Blob){const e=new FileReader();e.onload=()=>{this._onDownBuffer&&this._onDownBuffer(e.result,this.isDone())},e.readAsArrayBuffer(t)}else"string"==typeof t&&this._onDownMessage&&this._onDownMessage(JSON.parse(t))},this.onclose=e=>{this.opened=!1,f.warn(!0,"socket connect closed")},this.url=e}open(){if(this.opened)return null;const[e,t]=m();try{const t=new WebSocket(this.url);t.binaryType="arraybuffer",t.onmessage=this.onmessage;let s=!1;t.onopen=()=>{f.debug(`${this.url} opened`),this.opened=!0,e[0]()},t.onerror=t=>{f.error(!0,t);const n=s?t.type:"network error 22";this._onerror&&this._onerror(n),this.error=n,this.opened=!1,e[1](t)},t.onclose=this.onclose,this.socket=t}catch(e){this._onerror&&this._onerror("network error 22")}return t}pause(){this._onpause&&this._onpause()}seek(){f.debug("download pause")}resume(){this._onresume&&this._onresume()}destory(){this.socket.close()}isDone(){return!1}}let b;!function(e){e[e.OPEN=1]="OPEN",e[e.PAUSE=2]="PAUSE",e[e.RESUME=4]="RESUME",e[e.DONE=8]="DONE"}(b||(b={}));class g extends d{constructor(e){super(),this.url="",this.url=e}open(){this.status=b.OPEN;let e=new Headers(),t={method:"GET",headers:e,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};return e.set("Range",`bytes=${this._receivedLength}-`),fetch(this.url,t).then(e=>{if(!e.ok||!(e.status>=200&&e.status<=299))return;const t=e.headers.get("Content-Length");null!=t&&(this._contentLength=this._contentLength||parseInt(t),this.pump(e.body.getReader()))})}async pump(e){if(this.status&b.PAUSE)return void e.cancel();const t=await e.read();if(t.done)null!==this._contentLength&&this._receivedLength<this._contentLength||(this.status=b.DONE);else{const s=t.value.buffer;this._receivedLength+=s.byteLength,this._receivedLength===this._contentLength&&(this.status=b.DONE),this._onDownBuffer(s,this.isDone()),this.pump(e)}}pause(){this.status=b.PAUSE}resume(){this.status&b.OPEN||(this._receivedLength>=this._contentLength?console.log("已经缓冲完成"):(this.status=b.OPEN,this.open()))}isDone(){return!!(this.status&b.DONE)}}const v={create:function(e){const{url:t,type:s}=e;switch(s){case"http":return new g(t);case"ws":return new y(t);default:return new g(t)}},destory:function(e){e.destory(),e.onDownBuffer=null,e=null}};let Z,R;!function(e){e[e.LOAD=1]="LOAD",e[e.LOADDATA=2]="LOADDATA",e[e.PLAYING=4]="PLAYING",e[e.PAUSE=8]="PAUSE",e[e.DISCARD=16]="DISCARD",e[e.FPLAY=32]="FPLAY",e[e.WAIT=64]="WAIT",e[e.BUFFER=128]="BUFFER"}(Z||(Z={}));class w extends r{constructor(e,t){super(),this.el=void 0,this.parent=void 0,this.url=void 0,this.urltype=void 0,this.isLive=!1,this.error=null,this.status=0,this.statusUtil=u(this),this.log=void 0,this.remoteDownload=null,this.download=null,this.downBufctl=null,this.preloadBuffer=new c(),this.avParams=null,this.playParams=void 0,this.playTag=null,this.seekTag=null,this.now=0,this.lastV=0,this.lastA=0,this.lastAEnd=0,this.endV=0,this.endA=0,this.avTag=0,this._actualTime=0,this._currentTime=0,this._animateTime=void 0,this._playbackRate=1,this._volume=0,this._controls=!0,this.shouldRender=void 0,this.onerror=e=>{if(e){if(this.error)return;this.error=e,this.emit("error",e)}else this.error=null},this.onPreloadBuffer=e=>{this.preloadBuffer.addBuffer(e)},this.onDownload=null,this.onDownloadMsg=e=>{this.emit("downmsg",e)},this.onDownloadErr=e=>{this.emit("downerror",e)},this.checkScrubbing=()=>{if(this.statusUtil.has(Z.DISCARD))return;const e=Math.max(this.endA,this.endV);this.currentTime>=e&&this.statusUtil.no(Z.WAIT)?(this.statusUtil.contact(Z.BUFFER),clearTimeout(this.playTag),this.playTag=setTimeout(()=>{this.waiting(),this.pauseRender(),this._currentTime=e,setTimeout(this.checkScrubbing,200)},100)):this.currentTime<e&&this.statusUtil.has(Z.BUFFER)?(this.statusUtil.remove(Z.BUFFER),clearTimeout(this.playTag),this.playTag=setTimeout(()=>{this.startRender(),this.statusUtil.has(Z.WAIT)&&this.emit("playing","waiting")},100)):this.statusUtil.has(Z.BUFFER)&&setTimeout(this.checkScrubbing,200)},this._resetAnimate=()=>{this.now=Date.now()},this._animate=()=>{if(this.statusUtil.no(Z.PLAYING)||this.statusUtil.has(Z.BUFFER))return;this._animateTime=requestAnimationFrame(this._animate);const e=Date.now(),t=(e-this.now)*this._playbackRate;this.now=e,this._actualTime+=t,this._currentTime+=t,this.checkScrubbing();const s=Math.max(this.endV,this.endA);this._currentTime>s&&(this._currentTime=s),this.onLoop(this._currentTime,t)},this.log=new l(t),this.setOptions(e)}bindElement(e){this.parent.appendChild(e),this.el=e}setOptions(e){this.url=e.url,this.urltype=e.type,this.parent=e.el,this.isLive=e.isLive||!1,this.remoteDownload=e.download,this.remoteDownload&&(this.remoteDownload.onDownBuffer=this.onPreloadBuffer)}copyStatus(e){super.copyEvent(e),this._controls=e._controls,this._volume=e._volume,this._playbackRate=e._playbackRate}waiting(){this.statusUtil.has(Z.WAIT)||(this.emit("waiting"),this.statusUtil.contact(Z.WAIT))}async load(){if(this.log.warn(this.statusUtil.has(Z.LOAD),"请勿重复加载视频"))throw 1;this.emit("loadstart"),this.waiting()}async reloadUrl(){this._currentTime=0,this._actualTime=0,this.statusUtil.remove(Z.LOADDATA),this.destoryDownload(),await this.loadDownload(),this.play(!1)}async loadDownload(){const[e,t]=m();if(this.remoteDownload?(this.download=this.remoteDownload,this.download.error&&this.onDownloadErr(this.download.error)):this.download=v.create({url:this.url,type:this.urltype}),this.download.onDownBuffer=this.onDownload,this.download.onDownMessage=this.onDownloadMsg,this.download.onerror=this.onDownloadErr,await this.download.open(),this.remoteDownload&&this.preloadBuffer.totalLength){const t=this.preloadBuffer.getBuffer();this.onDownload(t),this.download.onDownBuffer=this.onDownload,e[0]()}else this.download.onDownBuffer=(t,s)=>{this.onDownload(t,s),this.download.onDownBuffer=this.onDownload,e[0]()};await t}destoryDownload(){this.download&&v.destory(this.download),this.download=null,this.downBufctl&&this.downBufctl.cancelCheck(),this.downBufctl=null}framePlay(){}play(e){return this.log.warn(this.statusUtil.no(Z.LOAD),"视频还未加载成功")?(this.waiting(),!1):!this.log.warn(this.statusUtil.has(Z.PLAYING),"请勿重复调用")&&(this.statusUtil.replace(Z.PAUSE,Z.PLAYING),this.statusUtil.remove(Z.WAIT),this.emit("playing"),!0)}startRender(){}pauseRender(){}pauseDownload(){}pause(e){return this.log.warn(this.statusUtil.no(Z.LOAD),"视频还未加载")?(this.waiting(),!1):!this.statusUtil.has(Z.PAUSE)&&(e&&this.emit("pause"),this.statusUtil.replace(Z.PLAYING,Z.PAUSE),this.downBufctl.pause(),this.downBufctl.cancelCheck(),!0)}async seek(e){this.log.warn(this.statusUtil.no(Z.LOAD),"视频还未加载")?this.waiting():(this.emit("seeking"),this.seekTag&&this.seekTag.cancel(),this.pause(!1),this.seekTag=function(...e){let t=!1;const s=(e=e.filter(Boolean)).length;return function*(){for(let t=0;t<s;t++)yield e[t]()}(),async function s(n){const i=e.shift();if(!i||t)return n;s(await i(n))}(),{cancel:()=>{e=[],t=!0}}}(async()=>e&&await e(),async()=>await this.reloadUrl(),()=>this.emit("seeked")))}destory(){this.status=Z.DISCARD,this.destoryDownload(),this.emit("destory"),super.destory(),cancelAnimationFrame(this._animateTime),this.parent&&(this.parent.removeChild(this.el),this.parent=null,this.log.info(!0,"remove video tag")),this.el=null}syncAudio(e,t=20){return e+t<=this._currentTime?-1:e>this._currentTime+t?1:0}syncContorl(e,t){const s=Math.abs(e-t);return s<200?0:t>e?(this.log.info(1!==this.avTag,`视频超前 ${s}ms, 暂停视频`),this.avTag=1,-1):(this.log.info(2!==this.avTag,`视频落后 ${s}ms, 调整时间至${e}, 总时长${this.endV}`),this.avTag=2,e)}onLoop(e,t){}set currentTime(e){}get currentTime(){return null}set playbackRate(e){this._playbackRate=e,this.emit("ratechange",e)}get playbackRate(){return this._playbackRate}set volume(e){this._volume!==e&&(this._volume=e,this.emit("volumechange",e))}get volume(){return this._volume}set controls(e){this._controls!==e&&(this._controls=e,this.emit("controls",e))}get debugInfo(){return null}setSize(e,t,s,n){this.el instanceof HTMLCanvasElement&&(this.el.width=s,this.el.height=n),this.parent.style.width=Math.round(e)+"px",this.parent.style.height=Math.round(t)+"px"}}!function(e){e.LOAD="0x00000001",e.MODULE="MODULE",e.INIT="0x00000010",e.DESTORY="DESTORY",e.OPEN="0x00000100",e.FLUSH="FLUSH",e.RECEIVE="0x00001000",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.START="0x00010000",e.STOP="0x00100000",e.DECODE="0x01000000",e.FAILED="0x10000000",e.LOST="LOST"}(R||(R={}));const x=R;let V,G;!function(e){e.ERROR="error",e.LOADING_COMPLETE="loading_complete",e.RECOVERED_EARLY_EOF="recovered_early_eof",e.MEDIA_INFO="media_info",e.METADATA_ARRIVED="metadata_arrived",e.SCRIPTDATA_ARRIVED="scriptdata_arrived",e.STATISTICS_INFO="statistics_info"}(V||(V={})),function(e){e[e.UNKNOWN=1]="UNKNOWN",e[e.LOAD=4]="LOAD",e[e.OPEN=8]="OPEN"}(G||(G={}));const L=new l("decoder");class S extends r{constructor(e,t){super(),this.props=void 0,this.status=0,this.statusUtil=u(this),this.decodeWorker=void 0,this.getWorker=void 0,this.downloadBytes=0,this._onerror=null,this.onAVFrame=void 0,this.onAVLost=void 0,this.pendingFrames=0,this.lossFrames=0,this.onmessage=e=>{const{type:t,pending:s}=e.data;switch(t){case R.OPEN:this.statusUtil.contact(G.OPEN),this.emit(t,e.data);break;case R.AUDIO:case R.VIDEO:this.onAVFrame(e.data);case x.FAILED:this.pendingFrames=s;break;case x.LOST:this.onAVLost(e.data);break;default:L.debug(`not valid type [${t}]`)}},this.onDownloadBuffer=(e,t)=>{this.pendingFrames++,this.downloadBytes+=e.byteLength,this.sendBuffer(e),t&&(this.pendingFrames=NaN)},this.props=e,this.getWorker=t,this.statusUtil.set(G.UNKNOWN)}async load(){L.debug("prepare for load decoder"),this.decodeWorker=await this.getWorker(),this.decodeWorker.onmessage=this.onmessage,this.statusUtil.set(G.LOAD)}postMessage(e,t){t instanceof ArrayBuffer?this.decodeWorker.postMessage(t,[t]):this.decodeWorker.postMessage({type:e,data:t})}getVideoParams(){const[e,t]=m();return this.once(R.OPEN,t=>{e[0](t)}),t}startDecoding(){this.postMessage(x.START)}stopDecoding(){this.postMessage(x.STOP)}seekDecoding(){}flushBuffers(){this.postMessage(R.FLUSH)}sendBuffer(e){this.postMessage(x.RECEIVE,e)}destory(){this.pendingFrames=0,this.downloadBytes=0}isDone(){return NaN===this.pendingFrames}set onerror(e){this._onerror=e}}const W="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0),X=W&&"function"==typeof module.require?module.require:null;const T=function(e,t=null,s=!1){const n=W?function(e,t){return Buffer.from(e,"base64").toString(t?"utf16":"utf8")}(e,s):function(e,t){const s=atob(e);if(t){const e=new Uint8Array(s.length);return Array.prototype.forEach.call(e,(e,t,n)=>{n[t]=s.charCodeAt(t)}),String.fromCharCode.apply(null,new Uint16Array(e.buffer))}return s}(e,s),i=n.indexOf("\n",10)+1,r=n.substring(i)+(t?`//# sourceMappingURL=${t}`:"");if(X){const e=X("worker_threads").Worker;return function(t){return new e(r,Object.assign({},t,{eval:!0}))}}const o=new Blob([r],{type:"application/javascript"}),a=URL.createObjectURL(o);return function(e){return new Worker(a,e)}}("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwpsZXQgZT0wO2NvbnN0IHQ9WyIjZDY0ZTRlIiwiI2JhZGE1NSIsIiM3ZWM2OTkiXTtjbGFzcyBze2NvbnN0cnVjdG9yKHMsaSl7dGhpcy5sZXZlbD17fSx0aGlzLm5hbWU9dm9pZCAwLHRoaXMuY29sb3I9dm9pZCAwLHRoaXMubmFtZT1zLHRoaXMuY29sb3I9YFxuICAgIGNvbG9yOiAke3RbZV19O1xuICAgIGZvbnQtc3R5bGU6IGl0YWxpYztcbiAgICBwYWRkaW5nOiAycHg7XG4gICAgd2lkdGg6IDEwMHB4O1xuICBgLGUrK31sb2coZSwuLi50KXtjb25zb2xlW2VdKGAlYyR7dGhpcy5uYW1lfTpgLHRoaXMuY29sb3IsLi4udCl9aW5mbyhlLC4uLnQpe2UmJnRoaXMubG9nKCJsb2ciLC4uLnQpfWdyb3VwKC4uLmUpe31ncm91cEVuZCguLi5lKXt9ZGVidWcoLi4uZSl7dGhpcy5sZXZlbC5kZWJ1ZyYmdGhpcy5sb2coImxvZyIsLi4uZSl9d2FybihlLHQsLi4ucyl7cmV0dXJuIGUmJmNvbnNvbGUubG9nKGAlYyR7dGhpcy5uYW1lfTpgLHRoaXMuY29sb3IsdCwuLi5zKSxlfWVycm9yKGUsLi4udCl7cmV0dXJuIGUmJnRoaXMubG9nKCJlcnJvciIsLi4udCksZX1kZXN0b3J5KCl7fX1mdW5jdGlvbiBpKGUpe2NvbnN0IHQ9ZS5idWZmZXIuZ2V0VWludDgoZS5jdXJyZW50KTtyZXR1cm4gZS5jdXJyZW50Kz0xLHR9ZnVuY3Rpb24gcihlKXtjb25zdCB0PWUuYnVmZmVyLmdldFVpbnQxNihlLmN1cnJlbnQpO3JldHVybiBlLmN1cnJlbnQrPTIsdH1zLmxldmVsPTE7Y2xhc3Mgb3tzdGF0aWMgZ2V0U3RyZWFtKGUsdCl7Y29uc3Qgcz1PYmplY3QuY3JlYXRlKG5ldyBvKGUpKTtyZXR1cm4gdCYmT2JqZWN0LmtleXModCkuZm9yRWFjaChlPT57c1tlXT10W2VdfSksc31jb25zdHJ1Y3RvcihlKXt0aGlzLnN0YXJ0PTAsdGhpcy5lbmQ9MCx0aGlzLmV4dHJhUmFuZ2U9bnVsbCx0aGlzLl9idWZmZXI9dm9pZCAwLHRoaXMuX2J1ZmZlcj1lfWJ1ZmZlcigpe2lmKHRoaXMuZXh0cmFSYW5nZSl7Y29uc3QgZT10aGlzLmVuZC10aGlzLnN0YXJ0O2xldCB0PWU7dGhpcy5leHRyYVJhbmdlLmZvckVhY2goZT0+dCs9ZVsyXSk7Y29uc3Qgcz1uZXcgVWludDhBcnJheSh0KSxpPVtbdGhpcy5zdGFydCx0aGlzLmVuZCxlXSwuLi50aGlzLmV4dHJhUmFuZ2VdO2xldCByPTA7cmV0dXJuIGkuZm9yRWFjaChlPT57Y29uc3QgdD10aGlzLl9idWZmZXIuc2xpY2UoZVswXSxlWzFdKTtzLnNldChuZXcgVWludDhBcnJheSh0KSxyKSxyKz1lWzJdfSkscy5idWZmZXJ9cmV0dXJuIHRoaXMuX2J1ZmZlci5zbGljZSh0aGlzLnN0YXJ0LHRoaXMuZW5kKX1tZXJnZShlKXt0aGlzLmV4dHJhUmFuZ2V8fCh0aGlzLmV4dHJhUmFuZ2U9W10pLHRoaXMuZXh0cmFSYW5nZS5wdXNoKFtlLnN0YXJ0LGUuZW5kLGUuZW5kLWUuc3RhcnRdKX19ZnVuY3Rpb24gbihlKXtjb25zdCB0PSgxNCZpKGUpKTw8Mjkscz0oNjU1MzQmcihlKSk8PDE0LG89KDY1NTM0JnIoZSkpPj4xO3JldHVybiBNYXRoLnJvdW5kKCh0Pj4+MCkrcytvKX1mdW5jdGlvbiBhKGUpe2xldCB0PWUuYnVmZmVyLmJ5dGVMZW5ndGgtZS5jdXJyZW50LHM9MDtmb3IoO3Q+MDspe3QtLTtjb25zdCByPXM7aWYocz0xNjc3NzIxNSYoczw8OHxpKGUpKSwxPT09cilyZXR1cm4gc31yZXR1cm4tMX1jbGFzcyBke2NvbnN0cnVjdG9yKCl7dGhpcy5uYW1lPSJwcyBzdHJlYW0iLHRoaXMudmlkZW9UeXBlPXZvaWQgMCx0aGlzLmF1ZGlvVHlwZT12b2lkIDAsdGhpcy5zdHJlYW1zPVtdfXByb2JlKGUpe3JldHVybiB0aGlzLnBhcnNlKGUpLHRoaXMudmlkZW9UeXBlfXBhcnNlUFNNSChlKXtjb25zdCB0PXIoZSk7aShlKSxpKGUpLHIoZSkscihlKTtsZXQgcz10LTAtMTA7Zm9yKDtzPj00Oyl7Y29uc3QgdD1pKGUpO2koZSkscihlKSx0aGlzLnZpZGVvVHlwZT90aGlzLmF1ZGlvVHlwZT10OnRoaXMudmlkZW9UeXBlPXQscy09NH19cGFyc2VQRVMoZSx0KXtjb25zdCBzPXIoZSksbz1lLmN1cnJlbnQtMStzO2koZSk7Y29uc3QgYT1pKGUpLGQ9aShlKSxoPWUuY3VycmVudCtkOzEyOCZhJiYodC5wdHM9bihlKSw2NCZhJiZuKGUpKSx0LnN0YXJ0PWgsdC5lbmQ9bysxLGUuY3VycmVudD1vfXBhcnNlKGUpe3RoaXMuY2xlYXIoKTtjb25zdCB0PWZ1bmN0aW9uKGUsdD0wLHMpeyhzfHwwIT09dCkmJihzPXN8fGUuYnl0ZUxlbmd0aCsxLGU9ZS5zbGljZSh0LHMpKTtjb25zdCBpPW5ldyBEYXRhVmlldyhlKTtyZXR1cm57YnVmZmVyOmksY3VycmVudDowLHZhbHVlOmkuZ2V0VWludDMyKDApLGJpdHM6MCxhdmFsaWFiZTozMixpbmRleDowfX0oZSk7bGV0IHM9ITEsaT17fSxyPW51bGw7Zm9yKDtyPWEodCk7KXtpZigtMT09PXIpcmV0dXJuO3N3aXRjaChyKXtjYXNlIDQ0MjpzPSEwO2JyZWFrO2Nhc2UgNDQzOmJyZWFrO2Nhc2UgNDQ0OnRoaXMucGFyc2VQU01IKHQpO2JyZWFrO2Nhc2UgNDgwOmNhc2UgNDQ4OmNvbnN0IG49MjU1JnIsYT1vLmdldFN0cmVhbShlKTthLmlkPW4sdGhpcy5wYXJzZVBFUyh0LGEpLCFzJiZpW25dJiZpW25dLnB0cz09PWEucHRzP2lbbl0ubWVyZ2UoYSk6KHRoaXMuc3RyZWFtcy5wdXNoKGEpLGlbbl09YSxzPSExKX19fWNsZWFyKCl7dGhpcy5zdHJlYW1zPVtdfX1sZXQgaDshZnVuY3Rpb24oZSl7ZS5MT0FEPSIweDAwMDAwMDAxIixlLk1PRFVMRT0iTU9EVUxFIixlLklOSVQ9IjB4MDAwMDAwMTAiLGUuREVTVE9SWT0iREVTVE9SWSIsZS5PUEVOPSIweDAwMDAwMTAwIixlLkZMVVNIPSJGTFVTSCIsZS5SRUNFSVZFPSIweDAwMDAxMDAwIixlLlZJREVPPSJWSURFTyIsZS5BVURJTz0iQVVESU8iLGUuU1RBUlQ9IjB4MDAwMTAwMDAiLGUuU1RPUD0iMHgwMDEwMDAwMCIsZS5ERUNPREU9IjB4MDEwMDAwMDAiLGUuRkFJTEVEPSIweDEwMDAwMDAwIixlLkxPU1Q9IkxPU1QifShofHwoaD17fSkpO2NvbnN0IGM9aDtsZXQgdTshZnVuY3Rpb24oZSl7ZS5FUlJPUj0iZXJyb3IiLGUuTE9BRElOR19DT01QTEVURT0ibG9hZGluZ19jb21wbGV0ZSIsZS5SRUNPVkVSRURfRUFSTFlfRU9GPSJyZWNvdmVyZWRfZWFybHlfZW9mIixlLk1FRElBX0lORk89Im1lZGlhX2luZm8iLGUuTUVUQURBVEFfQVJSSVZFRD0ibWV0YWRhdGFfYXJyaXZlZCIsZS5TQ1JJUFREQVRBX0FSUklWRUQ9InNjcmlwdGRhdGFfYXJyaXZlZCIsZS5TVEFUSVNUSUNTX0lORk89InN0YXRpc3RpY3NfaW5mbyJ9KHV8fCh1PXt9KSk7Y2xhc3MgbHtjb25zdHJ1Y3Rvcigpe3RoaXMuYnVmZmVyPVtdLHRoaXMuY29tcGxldGU9ITEsdGhpcy5uZXh0PW51bGwsdGhpcy50b3RhbExlbmd0aD0wfWFkZEJ1ZmZlcihlKXt0aGlzLmJ1ZmZlci5wdXNoKGUpLHRoaXMudG90YWxMZW5ndGgrPWUuYnl0ZUxlbmd0aH1pc0VuZCgpe3JldHVybiB0aGlzLmNvbXBsZXRlfWVuZE9mQnVmZmVyKCl7dGhpcy5jb21wbGV0ZT0hMH1nZXRCdWZmZXIoKXtpZigwPT09dGhpcy50b3RhbExlbmd0aClyZXR1cm4gbmV3IEFycmF5QnVmZmVyKDApO2lmKDE9PT10aGlzLmJ1ZmZlci5sZW5ndGgpcmV0dXJuIHRoaXMuYnVmZmVyWzBdO2NvbnN0IGU9bmV3IFVpbnQ4QXJyYXkodGhpcy50b3RhbExlbmd0aCk7bGV0IHQ9MDtmb3IobGV0IHM9MDtzPHRoaXMuYnVmZmVyLmxlbmd0aDtzKyspe2NvbnN0IGk9bmV3IFVpbnQ4QXJyYXkodGhpcy5idWZmZXJbc10pO2Uuc2V0KGksdCksdCs9aS5ieXRlTGVuZ3RofXJldHVybiBlLmJ1ZmZlcn19Y2xhc3MgZntjb25zdHJ1Y3RvcihlLHQpe3RoaXMubGltaXQ9dm9pZCAwLHRoaXMubG9nPXZvaWQgMCx0aGlzLmNvdW50PTAsdGhpcy5maXJzdEZyYW1lPW51bGwsdGhpcy5jdXJyZW50RnJhbWU9bnVsbCx0aGlzLmxpbWl0PWUsdGhpcy5sb2c9bmV3IHModCl9Z2V0IGxlbmd0aCgpe3JldHVybiB0aGlzLmNvdW50fWNyZWF0ZUZyYW1lKCl7Y29uc3QgZT1uZXcgbDtyZXR1cm4gdGhpcy5lbnF1ZXVlKGUpLGV9ZW5xdWV1ZShlKXt0aGlzLmNvdW50PnRoaXMubGltaXQ/dGhpcy5sb2cuZXJyb3IoITAsYG1heCBMaW1pdCAke3RoaXMubGltaXR9YCk6KHRoaXMuY3VycmVudEZyYW1lPyh0aGlzLmN1cnJlbnRGcmFtZS5uZXh0PWUsdGhpcy5jdXJyZW50RnJhbWU9ZSk6KHRoaXMuY3VycmVudEZyYW1lPWUsdGhpcy5maXJzdEZyYW1lPW5ldyBsLHRoaXMuZmlyc3RGcmFtZS5uZXh0PWUpLHRoaXMuY291bnQrKyl9ZGVxdWV1ZSgpe2lmKDA9PT10aGlzLmNvdW50KXJldHVybiBudWxsO3RoaXMuY291bnQtLTtjb25zdCBlPXRoaXMuZmlyc3RGcmFtZS5uZXh0O3JldHVybiB0aGlzLmZpcnN0RnJhbWU9ZSxlfX12YXIgcDshZnVuY3Rpb24oZSl7ZVtlLlVOS05PV049MF09IlVOS05PV04iLGVbZS5MT0FEPTFdPSJMT0FEIixlW2UuUkVDRUlWRVNQUz0yXT0iUkVDRUlWRVNQUyIsZVtlLlBSRVBBUkU9NF09IlBSRVBBUkUiLGVbZS5ERUNPREU9OF09IkRFQ09ERSIsZVtlLkRFQ09ESU5HPTE2XT0iREVDT0RJTkciLGVbZS5QQVVTRT0zMl09IlBBVVNFIixlW2UuV0FTTUJVRkZFUkZVTEw9NjRdPSJXQVNNQlVGRkVSRlVMTCIsZVtlLkRPV05MQlVGRkVSPTEyOF09IkRPV05MQlVGRkVSIixlW2UuQlVGRkVSRlVMTD0yNTZdPSJCVUZGRVJGVUxMIixlW2UuRE9XTkxPQURET1dOPTUxMl09IkRPV05MT0FERE9XTiIsZVtlLkRPTkU9MTAyNF09IkRPTkUifShwfHwocD17fSkpO2NvbnN0IG09bmV3IHMoImRlY29kZXIiKTtjbGFzcyBne2NvbnN0cnVjdG9yKGUpe3RoaXMucHJvcHM9dm9pZCAwLHRoaXMucHNkZW11eD1uZXcgZCx0aGlzLmxvYWRlZD12b2lkIDAsdGhpcy5lZmZlY3RUYWc9cC5VTktOT1dOLHRoaXMud2F0Y2hlZFR5cGU9e30sdGhpcy5kb3dubG9hZEJ5dGVzPTAsdGhpcy5mcmFtZXNCdWZmZXJMSU1UPTAsdGhpcy5fb25lcnJvcj1udWxsLHRoaXMub25WaWRlb0ZyYW1lRGVjb2RlPXZvaWQgMCx0aGlzLmRvd25sb2FkUXVldWU9bmV3IGYoMTAwLCJkZWNvZGUgZG93bmxvYWQgcXVldWUiKSx0aGlzLnBlbmRpbmdGcmFtZXM9MCx0aGlzLnZpZGVvUXVldWU9W10sdGhpcy5hdWRpb1F1ZXVlPVtdLHRoaXMuY29tbWl0RnJhbWVzPTAsdGhpcy5MSU1JVEZSQU1FUz0xNWUzLHRoaXMuV0FTTUxJTUlUPTZlMyx0aGlzLnByb2JzaXplPTI2MjE0NCx0aGlzLmxvc3NGcmFtZXM9MCx0aGlzLm9uRG93bmxvYWRCdWZmZXI9ZT0+e3RoaXMuZG93bmxvYWRCeXRlcys9ZS5ieXRlTGVuZ3RoLHRoaXMucHNkZW11eC5wYXJzZShlKSx0aGlzLnBzZGVtdXguc3RyZWFtcy5mb3JFYWNoKGU9Pnt0aGlzLmFkZFBlbmRpbmdGcmFtZXMoZS5wdHMsZS5pZCl9KSx0aGlzLnNlbmRCdWZmZXIoZSksdGhpcy5vbkZyYW1lUmVjZWl2ZSgpfSx0aGlzLm9uRnJhbWVSZWNlaXZlPSgpPT57fnRoaXMuZWZmZWN0VGFnJnAuUFJFUEFSRSYmdGhpcy5kb3dubG9hZEJ5dGVzPj10aGlzLnByb2JzaXplJiYodGhpcy5lZmZlY3RUYWcmPX5wLlJFQ0VJVkVTUFMsdGhpcy5lZmZlY3RUYWd8PXAuUFJFUEFSRSx0aGlzLm9wZW5EZWNvZGVyKCksdGhpcy5lZmZlY3RUYWd8PXAuREVDT0RFKX0sdGhpcy5kZWNvZGVMb29wPSgpPT57dGhpcy5lZmZlY3RUYWcmcC5QQVVTRXx8KHRoaXMucGVuZGluZ0ZyYW1lcz4wP3RoaXMuZGVjb2RlT25jZSgpOnRoaXMuZWZmZWN0VGFnJnAuRE9XTkxCVUZGRVJ8fHRoaXMuZWZmZWN0VGFnJnAuRE9XTkxPQURET1dOJiYodGhpcy5lZmZlY3RUYWd8PXAuRE9ORSksc2V0VGltZW91dCh0aGlzLmRlY29kZUxvb3AsNSkpfSx0aGlzLndhaXRCdWZmZXJEZWNvZGU9KCk9PntpZigodGhpcy5lZmZlY3RUYWcmcC5ET1dOTEJVRkZFUikhPT1wLkRPV05MQlVGRkVSKXJldHVybjtjb25zdCBlPXRoaXMuZG93bmxvYWRRdWV1ZS5kZXF1ZXVlKCk7cmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMud2FpdEJ1ZmZlckRlY29kZSksZSYmKHRoaXMucGVuZGluZ0ZyYW1lcz4xMHx8KHRoaXMucHJvcHMubW9kdWxlV2FwcGVyLnNlbmRQYWNrZXQoZS5nZXRCdWZmZXIoKSksdGhpcy5kZWNvZGVPbmNlKCkpKX0sdGhpcy5wcm9wcz1lLHRoaXMubG9hZCgpfWxvYWQoKXttLndhcm4odGhpcy5lZmZlY3RUYWcmcC5MT0FELCJkZWNvZGVyIGhhcyBiZSBsb2FkZWQiKXx8KG0uZGVidWcoInN0YXJ0IHRvIGluaXQgZGVjb2RlciIpLHRoaXMucHJvcHMubW9kdWxlV2FwcGVyLmluaXREZWNvZGVyKCkpfW9wZW5EZWNvZGVyKCl7Y29uc3QgZT10aGlzLnByb3BzLm1vZHVsZVdhcHBlci5vcGVuRGVjb2Rlcih0aGlzLnByb2JzaXplKTtyZXR1cm4gdGhpcy5wcm9wcy5zZW5kTWVzc2FnZShoLk9QRU4sZSksZX1zdGFydERlY29kaW5nKCl7dGhpcy5lZmZlY3RUYWcmcC5ERUNPRElOR3x8dGhpcy5lZmZlY3RUYWcmcC5ERUNPREUmJihtLmRlYnVnKCJzdGFydCBsb29wIGRlY29kZSIpLHRoaXMuZWZmZWN0VGFnfD1wLkRFQ09ESU5HLHRoaXMuZWZmZWN0VGFnJj1+cC5QQVVTRSx0aGlzLmRlY29kZUxvb3AoKSl9ZGVjb2RlT25jZSgpe2lmKHRoaXMuZWZmZWN0VGFnJnAuREVDT0RFKXtjb25zdCBlPXRoaXMucHJvcHMubW9kdWxlV2FwcGVyLmRlb2NkZSgpO2lmKHRoaXMuc2V0UGVuZGluZ0ZyYW1lcyghMSksIWUpcmV0dXJuIHRoaXMudmlkZW9RdWV1ZS5zaGlmdCgpLHZvaWQgdGhpcy5wcm9wcy5zZW5kTWVzc2FnZShoLkZBSUxFRCx7cGVuZGluZzp0aGlzLnBlbmRpbmdGcmFtZXN9KTtjb25zdHt0eXBlOnQsYnVmZmVyOnMscHRzOmksZGVjb2RlVGltZTpyfT1lOyJ2aWRlbyI9PT10Pyh0aGlzLnZpZGVvUXVldWUuc2hpZnQoKSx0aGlzLnByb3BzLnNlbmRNZXNzYWdlKGguVklERU8se3BlbmRpbmc6dGhpcy5wZW5kaW5nRnJhbWVzLGRlY29kZVRpbWU6cixwdHM6aSxzdHJlYW06dH0scykpOih0aGlzLmF1ZGlvUXVldWUuc2hpZnQoKSx0aGlzLnByb3BzLnNlbmRNZXNzYWdlKGguQVVESU8se3BlbmRpbmc6dGhpcy5wZW5kaW5nRnJhbWVzLGRlY29kZVRpbWU6cixwdHM6aSxzdHJlYW06dH0scykpfX1zdG9wRGVjb2RpbmcoKXttLmRlYnVnKCJzdG9wIGxvb3AgZGVjb2RlIiksdGhpcy5lZmZlY3RUYWd8PXAuUEFVU0UsdGhpcy5lZmZlY3RUYWcmPX5wLkRFQ09ESU5HfXNlZWtEZWNvZGluZygpe31mbHVzaEJ1ZmZlcnMoKXt0aGlzLnBlbmRpbmdGcmFtZXM9MCx0aGlzLnZpZGVvUXVldWU9W10sdGhpcy5hdWRpb1F1ZXVlPVtdLHRoaXMucHJvcHMubW9kdWxlV2FwcGVyLmZsdXNoQnVmZmVycygpfXNldFBlbmRpbmdGcmFtZXMoZSl7aWYoZT90aGlzLnBlbmRpbmdGcmFtZXMrKzp0aGlzLnBlbmRpbmdGcmFtZXMtLSx0aGlzLnBlbmRpbmdGcmFtZXM+PXRoaXMuTElNSVRGUkFNRVM/dGhpcy5lZmZlY3RUYWd8PXAuQlVGRkVSRlVMTDp0aGlzLnBlbmRpbmdGcmFtZXM+PXRoaXMuV0FTTUxJTUlUP3AuRE9XTkxCVUZGRVImfnRoaXMuZWZmZWN0VGFnJiYodGhpcy5lZmZlY3RUYWd8PXAuRE9XTkxCVUZGRVJ8cC5XQVNNQlVGRkVSRlVMTCx0aGlzLndhaXRCdWZmZXJEZWNvZGUoKSk6KHRoaXMuZWZmZWN0VGFnJnAuQlVGRkVSRlVMTHx8dGhpcy5lZmZlY3RUYWcmcC5XQVNNQlVGRkVSRlVMTCkmJih0aGlzLmVmZmVjdFRhZyY9fihwLldBU01CVUZGRVJGVUxMfHAuQlVGRkVSRlVMTCkpLHRoaXMucGVuZGluZ0ZyYW1lcz41MDApe2NvbnN0IGU9dGhpcy52aWRlb1F1ZXVlW3RoaXMudmlkZW9RdWV1ZS5sZW5ndGgtMV0ucHRzLzkwO3RoaXMuZmx1c2hCdWZmZXJzKCksdGhpcy5wcm9wcy5zZW5kTWVzc2FnZShoLkxPU1Qse3B0czplfSl9fWFkZFBlbmRpbmdGcmFtZXMoZSx0KXtlJiYoMTkyPT09dD90aGlzLmF1ZGlvUXVldWUucHVzaCh7cHRzOmV9KTp0aGlzLnZpZGVvUXVldWUucHVzaCh7cHRzOmV9KSksdGhpcy5zZXRQZW5kaW5nRnJhbWVzKCEwKX1zZW5kQnVmZmVyKGUpe3RoaXMucHJvcHMubW9kdWxlV2FwcGVyLnNlbmRQYWNrZXQoZSl9ZGVzdG9yeSgpe3RoaXMuc3RvcERlY29kaW5nKCksdGhpcy5wcm9wcy5tb2R1bGVXYXBwZXIuZGVzdG9yeURlY29kZXIoKX1pc0RvbmUoKXtyZXR1cm4hISh0aGlzLmVmZmVjdFRhZyZwLkRPTkUpfX1jb25zdCBFPW5ldyBzKCJkZWNvZGVyV29ya2VyIik7Y29uc3QgRD1uZXcgcygid2Vid29ya2VyIik7bGV0IEY7Y29uc3R7b3JpZ2luOmJ9PWdsb2JhbFRoaXMubG9jYXRpb24sVD1gJHtifS9iY2xpZW50L2NvbW1vbnJlc291cmNlL29jeC5qc2AsTz1gJHtifS9iY2xpZW50L2NvbW1vbnJlc291cmNlL29jeC53YXNtYDtsZXQgTDtjb25zdCBSPW5ldyBjbGFzc3tjb25zdHJ1Y3Rvcigpe3RoaXMuTW9kdWxlPXZvaWQgMCx0aGlzLnZpZGVvUGFyYW1zPXZvaWQgMCx0aGlzLmF1ZGlvUGFyYW1zPXZvaWQgMCx0aGlzLmRlY29kZUZyYW1lPXZvaWQgMCx0aGlzLmludGVydmFsPXZvaWQgMCx0aGlzLmludGVydmFsVGltZT0xMCx0aGlzLmRlY29kZVRpbWU9MCx0aGlzLmNhbGxEb25lPSExLHRoaXMubG9hZENhbGxiYWNrPShlLHQscyxpKT0+e3RoaXMudmlkZW9QYXJhbXM9e2hlaWdodDplLHdpZHRoOnQscmF0ZTpzfSxFLmRlYnVnKCJ2aWRlbyBwYXJhbXMiLHRoaXMudmlkZW9QYXJhbXMpLGkvPTQ7Y29uc3Qgcj10aGlzLk1vZHVsZS5IRUFQVTMyLnN1YmFycmF5KGksaSszKTswPT09clswXT9FLmRlYnVnKCJubyBhdWRpbyBzdHJlYW0iKToodGhpcy5hdWRpb1BhcmFtcz17c2FtcGxlRm10OnJbMF0sY2hhbm5lbHM6clsxXSxzYW1wbGVSYXRlOnJbMl19LEUuZGVidWcoImF1ZGlvIHN0cmVhbSIsdGhpcy5hdWRpb1BhcmFtcykpfSx0aGlzLnZpZGVvQ2FsbGJhY2s9KGUsdCxzKT0+e2NvbnN0IGk9dGhpcy5Nb2R1bGUuSEVBUFU4LnN1YmFycmF5KGUsZSt0KSxyPW5ldyBVaW50OEFycmF5KGkpO3RoaXMuZGVjb2RlVGltZT1EYXRlLm5vdygpLXRoaXMuZGVjb2RlVGltZSx0aGlzLmRlY29kZUZyYW1lPXt0eXBlOiJ2aWRlbyIscHRzOk1hdGgucm91bmQoMWUzKnMpLGRlY29kZVRpbWU6dGhpcy5kZWNvZGVUaW1lLGJ1ZmZlcjpyfX0sdGhpcy5hdWRpb0NhbGxiYWNrPShlLHQscyk9Pntjb25zdCBpPXRoaXMuTW9kdWxlLkhFQVBVOC5zdWJhcnJheShlLGUrdCkscj1uZXcgVWludDhBcnJheShpKTt0aGlzLmRlY29kZVRpbWU9RGF0ZS5ub3coKS10aGlzLmRlY29kZVRpbWUsdGhpcy5kZWNvZGVGcmFtZT17dHlwZToiYXVkaW8iLHB0czpNYXRoLnJvdW5kKDFlMypzKSxkZWNvZGVUaW1lOnRoaXMuZGVjb2RlVGltZSxidWZmZXI6cn19fWluaXQoKXt0aGlzLk1vZHVsZT1Nb2R1bGUsdGhpcy5pbml0Q2FsbGJhY2soKSx0aGlzLnZpZGVvUGFyYW1zPXt3aWR0aDowLGhlaWdodDowLHJhdGU6MH0sdGhpcy5Nb2R1bGUuX3NldExvZ0xldmVsKDApfWluaXRDYWxsYmFjaygpe3RoaXMuTW9kdWxlJiYhdGhpcy5jYWxsRG9uZSYmKHRoaXMubG9hZENhbGxiYWNrPXRoaXMuTW9kdWxlLmFkZEZ1bmN0aW9uKHRoaXMubG9hZENhbGxiYWNrKSx0aGlzLnZpZGVvQ2FsbGJhY2s9dGhpcy5Nb2R1bGUuYWRkRnVuY3Rpb24odGhpcy52aWRlb0NhbGxiYWNrKSx0aGlzLmF1ZGlvQ2FsbGJhY2s9dGhpcy5Nb2R1bGUuYWRkRnVuY3Rpb24odGhpcy5hdWRpb0NhbGxiYWNrKSx0aGlzLmNhbGxEb25lPSEwKX1pbml0RGVjb2Rlcigpe3RoaXMuTW9kdWxlLl9pbml0RGVjb2Rlcih0aGlzLmxvYWRDYWxsYmFjayx0aGlzLnZpZGVvQ2FsbGJhY2ssdGhpcy5hdWRpb0NhbGxiYWNrKSxFLmRlYnVnKCJpbml0IGRlY29kZXJXb3JrZXIgc3VjY2VzcyIpfWRlc3RvcnlEZWNvZGVyKCl7dGhpcy5Nb2R1bGUuX2Rlc3RvcnlEZWNvZGVyKCl9b3BlbkRlY29kZXIoZSl7dGhpcy5Nb2R1bGUuX29wZW5EZWNvZGVyKGUpO3JldHVybiBFLmRlYnVnKCJvcGVuIGRlY29kZXJXb3JrZXIgc3VjY2VzcyIpLHt2aWRlbzp0aGlzLnZpZGVvUGFyYW1zLGF1ZGlvOnRoaXMuYXVkaW9QYXJhbXN9fWZsdXNoQnVmZmVycygpe3RoaXMuTW9kdWxlLl9mbHVzaEJ1ZmZlcnMoKX1kZW9jZGUoKXtyZXR1cm4gdGhpcy5kZWNvZGVUaW1lPURhdGUubm93KCksMCE9PXRoaXMuTW9kdWxlLl9kZWNvZGluZygpP251bGw6dGhpcy5kZWNvZGVGcmFtZX1zZW5kUGFja2V0KGUpe2NvbnN0IHQ9bmV3IFVpbnQ4QXJyYXkoZSkscz1Nb2R1bGUuX21hbGxvYyh0LmJ5dGVMZW5ndGgpO01vZHVsZS5IRUFQVTguc2V0KHQscyksTW9kdWxlLl9zZW5kUGFja2V0KHMsdC5ieXRlTGVuZ3RoKX19O2Z1bmN0aW9uIEEoKXtSLmluaXQoKSxMPW5ldyBnKHtzZW5kTWVzc2FnZTpVLG1vZHVsZVdhcHBlcjpSfSksVShoLkxPQUQpfW9ubWVzc2FnZT1mdW5jdGlvbihlKXtsZXQgdD1udWxsLHM9bnVsbDtzd2l0Y2goZS5kYXRhIGluc3RhbmNlb2YgQXJyYXlCdWZmZXI/KHQ9Yy5SRUNFSVZFLHM9ZS5kYXRhKToodD1lLmRhdGEudHlwZSxzPWUuZGF0YSksdCl7Y2FzZSBjLklOSVQ6aWYoc2VsZi5Nb2R1bGUpcmV0dXJuIHZvaWQgQSgpO3NlbGYuTW9kdWxlPXtub0luaXRpYWxSdW46ITAsb25SdW50aW1lSW5pdGlhbGl6ZWQoKXtBKCl9LGxvY2F0ZUZpbGU6KGUsdCk9PmAke2J9L2JjbGllbnQvY29tbW9ucmVzb3VyY2UvJHtlfWAsbWFpblNjcmlwdFVybE9yQmxvYjpULGFzeW5jIGluc3RhbnRpYXRlV2FzbShlLHQpe2lmKEYpe3JldHVybiB2b2lkIHQoYXdhaXQgV2ViQXNzZW1ibHkuaW5zdGFudGlhdGUoRixlKSxGKX1sZXQgczt7Y29uc3QgdD1uZXcgWE1MSHR0cFJlcXVlc3Q7dC5vcGVuKCJHRVQiLE8sITEpLHQucmVzcG9uc2VUeXBlPSJhcnJheWJ1ZmZlciIsdC5zZW5kKG51bGwpO2NvbnN0IGk9bmV3IFVpbnQ4QXJyYXkodC5yZXNwb25zZSk7cz1hd2FpdCBXZWJBc3NlbWJseS5pbnN0YW50aWF0ZShpLGUpfVUoaC5NT0RVTEUse21vZHVsZTpGfSksdChzLmluc3RhbmNlLHMubW9kdWxlKX19LGltcG9ydFNjcmlwdHMoVCk7YnJlYWs7Y2FzZSBjLk1PRFVMRTpGPXMubW9kdWxlO2JyZWFrO2Nhc2UgYy5TVEFSVDpMLnN0YXJ0RGVjb2RpbmcoKTticmVhaztjYXNlIGMuU1RPUDpMLnN0b3BEZWNvZGluZygpO2JyZWFrO2Nhc2UgYy5ERUNPREU6YnJlYWs7Y2FzZSBjLlJFQ0VJVkU6TC5vbkRvd25sb2FkQnVmZmVyKHMpO2JyZWFrO2Nhc2UgYy5GTFVTSDpMLmZsdXNoQnVmZmVycygpO2JyZWFrO2Nhc2UgYy5ERVNUT1JZOkwmJkwuZGVzdG9yeSgpLEw9bnVsbDticmVhaztkZWZhdWx0OkQuZXJyb3IoITAsYG5vIHR5cGUgJHt0fWApfX07Y29uc3QgVT0oZSx0LHMpPT57cz9wb3N0TWVzc2FnZSh7dHlwZTplLC4uLnQsYnVmZmVyOnN9LFtzLmJ1ZmZlcl0pOnBvc3RNZXNzYWdlKHt0eXBlOmUsLi4udH0pfTsKCg==",null,!1),U=new l("DecoderManager"),k=window.navigator.hardwareConcurrency;let E=0;function M(){}let C=!0,N=null;const I=[];function A(e){const[t,s]=m();return e.onmessage===M&&N&&e.postMessage(N),e.postMessage({type:x.INIT}),e.onmessage=s=>{const{type:n}=s.data;n===R.LOAD?t[0](e):n===R.MODULE&&(N=s.data)},s}async function F(){if(!C&&!N)for(;await new Promise(e=>setTimeout(e,1e3)),!N;);return C=!1,I.length>0?A(I.pop()):A(new T())}const Y={create:function(e){return U.warn(E>=k,`当前总播放数${E}, 推荐播放数${k}`),new S(e,F)},destory:function e(t){if(t)if(E--,t.statusUtil.has(G.LOAD)){{const e=t.decodeWorker;e.postMessage({type:x.DESTORY}),I.push(e),e.onmessage=M}t=null}else setTimeout(()=>{e(t)},1e3)}};var z;!function(e){e[e.INIT=1]="INIT",e[e.START=2]="START",e[e.PAUSE=4]="PAUSE",e[e.RESUME=8]="RESUME",e[e.COMPLETE=16]="COMPLETE"}(z||(z={}));class D{constructor(e){this.options=void 0,this.log=void 0,this.currentTime=void 0,this.currentCacheDuration=void 0,this.status=void 0,this.statusUtil=u(this),this.checktime=void 0,this.options=e,this.log=new l(e.unit)}checkstatus(){const{minimum:e,maximum:t,getValue:s,isDone:n}=this.options;if(n())return void this.complete();const i=s();i>t?this.pause():i<e&&this.resume()}checkloop(){this.checktime=window.setTimeout(()=>{this.checkloop(),this.checkstatus()},1e3)}startCheck(){this.statusUtil.has(z.START)||(this.statusUtil.set(z.START),this.checkstatus(),this.checkloop())}cancelCheck(){this.statusUtil.set(z.INIT),clearTimeout(this.checktime)}pause(){this.statusUtil.has(z.PAUSE)||(this.statusUtil.replace(z.RESUME,z.PAUSE),this.options.pause())}resume(){this.statusUtil.has(z.RESUME)||(this.statusUtil.replace(z.PAUSE,z.RESUME),this.options.resume())}complete(){this.statusUtil.contact(z.PAUSE),this.statusUtil.contact(z.RESUME),this.statusUtil.contact(z.COMPLETE),this.cancelCheck()}}const P="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0),J=P&&"function"==typeof module.require?module.require:null;const _=function(e,t=null,s=!1){const n=P?function(e,t){return Buffer.from(e,"base64").toString(t?"utf16":"utf8")}(e,s):function(e,t){const s=atob(e);if(t){const e=new Uint8Array(s.length);return Array.prototype.forEach.call(e,(e,t,n)=>{n[t]=s.charCodeAt(t)}),String.fromCharCode.apply(null,new Uint16Array(e.buffer))}return s}(e,s),i=n.indexOf("\n",10)+1,r=n.substring(i)+(t?`//# sourceMappingURL=${t}`:"");if(J){const e=J("worker_threads").Worker;return function(t){return new e(r,Object.assign({},t,{eval:!0}))}}const o=new Blob([r],{type:"application/javascript"}),a=URL.createObjectURL(o);return function(e){return new Worker(a,e)}}("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwpsZXQgZT0wO2NvbnN0IHQ9WyIjZDY0ZTRlIiwiI2JhZGE1NSIsIiM3ZWM2OTkiXTtjbGFzcyBye2NvbnN0cnVjdG9yKHIsaSl7dGhpcy5sZXZlbD17fSx0aGlzLm5hbWU9dm9pZCAwLHRoaXMuY29sb3I9dm9pZCAwLHRoaXMubmFtZT1yLHRoaXMuY29sb3I9YFxuICAgIGNvbG9yOiAke3RbZV19O1xuICAgIGZvbnQtc3R5bGU6IGl0YWxpYztcbiAgICBwYWRkaW5nOiAycHg7XG4gICAgd2lkdGg6IDEwMHB4O1xuICBgLGUrK31sb2coZSwuLi50KXtjb25zb2xlW2VdKGAlYyR7dGhpcy5uYW1lfTpgLHRoaXMuY29sb3IsLi4udCl9aW5mbyhlLC4uLnQpe2UmJnRoaXMubG9nKCJsb2ciLC4uLnQpfWdyb3VwKC4uLmUpe31ncm91cEVuZCguLi5lKXt9ZGVidWcoLi4uZSl7dGhpcy5sZXZlbC5kZWJ1ZyYmdGhpcy5sb2coImxvZyIsLi4uZSl9d2FybihlLHQsLi4ucil7cmV0dXJuIGUmJmNvbnNvbGUubG9nKGAlYyR7dGhpcy5uYW1lfTpgLHRoaXMuY29sb3IsdCwuLi5yKSxlfWVycm9yKGUsLi4udCl7cmV0dXJuIGUmJnRoaXMubG9nKCJlcnJvciIsLi4udCksZX1kZXN0b3J5KCl7fX1yLmxldmVsPTE7Y29uc3QgaT1uZXcgcigid2ViZ2wiKTtjbGFzcyBze2NvbnN0cnVjdG9yKGUsdCxyLGkpe3RoaXMuZ2w9dm9pZCAwLHRoaXMudGV4dHVyZT12b2lkIDAsdGhpcy5maWxsPShlLHQscik9Pntjb25zdCBpPXRoaXMuZ2w7aS5iaW5kVGV4dHVyZShpLlRFWFRVUkVfMkQsdGhpcy50ZXh0dXJlKSxpLnRleEltYWdlMkQoaS5URVhUVVJFXzJELDAsaS5MVU1JTkFOQ0UsZSx0LDAsaS5MVU1JTkFOQ0UsaS5VTlNJR05FRF9CWVRFLHIpfSx0aGlzLmdsPWUsZS5hY3RpdmVUZXh0dXJlKFtlLlRFWFRVUkUwLGUuVEVYVFVSRTEsZS5URVhUVVJFMl1baV0pLHRoaXMudGV4dHVyZT1lLmNyZWF0ZVRleHR1cmUoKSxlLmJpbmRUZXh0dXJlKGUuVEVYVFVSRV8yRCx0aGlzLnRleHR1cmUpLGUudGV4UGFyYW1ldGVyaShlLlRFWFRVUkVfMkQsZS5URVhUVVJFX1dSQVBfUyxlLkNMQU1QX1RPX0VER0UpLGUudGV4UGFyYW1ldGVyaShlLlRFWFRVUkVfMkQsZS5URVhUVVJFX1dSQVBfVCxlLkNMQU1QX1RPX0VER0UpLGUudGV4UGFyYW1ldGVyaShlLlRFWFRVUkVfMkQsZS5URVhUVVJFX01JTl9GSUxURVIsZS5MSU5FQVIpLGUudGV4UGFyYW1ldGVyaShlLlRFWFRVUkVfMkQsZS5URVhUVVJFX01BR19GSUxURVIsZS5MSU5FQVIpLGUudW5pZm9ybTFpKGUuZ2V0VW5pZm9ybUxvY2F0aW9uKHQsciksaSl9fWNsYXNzIGF7Y29uc3RydWN0b3IoZSl7dGhpcy5jYW52YXM9dm9pZCAwLHRoaXMuZ2w9dm9pZCAwLHRoaXMueT12b2lkIDAsdGhpcy51PXZvaWQgMCx0aGlzLnY9dm9pZCAwLHRoaXMuc3RvcFJlbmRlcj0hMSx0aGlzLmNhbnZhcz1lLHRoaXMuZ2w9ZS5nZXRDb250ZXh0KCJ3ZWJnbDIiLHtwcmVzZXJ2ZURyYXdpbmdCdWZmZXI6ITB9KSx0aGlzLmluaXQoKX1pbml0KCl7Y29uc3QgZT10aGlzLmdsO2lmKGkud2FybighZSwiZ2wgbm90IHN1cHBvcnTvvIEiKSlyZXR1cm47ZS5waXhlbFN0b3JlaShlLlVOUEFDS19BTElHTk1FTlQsNCk7Y29uc3QgdD10aGlzLmNvbXBpbGVTaGFkZXIoIlxuICAgICAgYXR0cmlidXRlIGxvd3AgdmVjNCBhX3ZlcnRleFBvc2l0aW9uO1xuICAgICAgYXR0cmlidXRlIHZlYzIgYV90ZXh0dXJlUG9zaXRpb247XG4gICAgICB2YXJ5aW5nIHZlYzIgdl90ZXhDb29yZDtcbiAgICAgIHZvaWQgbWFpbigpIHtcbiAgICAgICAgZ2xfUG9zaXRpb24gPSBhX3ZlcnRleFBvc2l0aW9uO1xuICAgICAgICB2X3RleENvb3JkID0gYV90ZXh0dXJlUG9zaXRpb247XG4gICAgICB9XG4gICAgIixlLlZFUlRFWF9TSEFERVIpLHI9dGhpcy5jb21waWxlU2hhZGVyKCJcbiAgICAgIHByZWNpc2lvbiBsb3dwIGZsb2F0O1xuICAgICAgdW5pZm9ybSBzYW1wbGVyMkQgc2FtcGxlclk7XG4gICAgICB1bmlmb3JtIHNhbXBsZXIyRCBzYW1wbGVyVTtcbiAgICAgIHVuaWZvcm0gc2FtcGxlcjJEIHNhbXBsZXJWO1xuICAgICAgdmFyeWluZyB2ZWMyIHZfdGV4Q29vcmQ7XG4gICAgICB2b2lkIG1haW4oKSB7XG4gICAgICAgIGZsb2F0IHIsZyxiLHksdSx2LGZZbXVsO1xuICAgICAgICB5ID0gdGV4dHVyZTJEKHNhbXBsZXJZLCB2X3RleENvb3JkKS5yO1xuICAgICAgICB1ID0gdGV4dHVyZTJEKHNhbXBsZXJVLCB2X3RleENvb3JkKS5yO1xuICAgICAgICB2ID0gdGV4dHVyZTJEKHNhbXBsZXJWLCB2X3RleENvb3JkKS5yO1xuXG4gICAgICAgIGZZbXVsID0geSAqIDEuMTY0MzgyODEyNTtcbiAgICAgICAgciA9IGZZbXVsICsgMS41OTYwMjczNDM3NSAqIHYgLSAwLjg3MDc4NzU5ODtcbiAgICAgICAgZyA9IGZZbXVsIC0gMC4zOTE3NjE3MTg3NSAqIHUgLSAwLjgxMjk2ODc1ICogdiArIDAuNTI5NTkzNzU7XG4gICAgICAgIGIgPSBmWW11bCArIDIuMDE3MjMwNDY4NzUgKiB1IC0gMS4wODEzODkxNjAzNzU7XG4gICAgICAgIGdsX0ZyYWdDb2xvciA9IHZlYzQociwgZywgYiwgMS4wKTtcbiAgICAgIH0iLGUuRlJBR01FTlRfU0hBREVSKSxhPXRoaXMuY3JlYXRlUHJvZ3JhbSh0LHIpO3RoaXMuaW5pdFZlcnRleEJ1ZmZlcnMoYSksdGhpcy55PW5ldyBzKGUsYSwic2FtcGxlclkiLDApLHRoaXMudT1uZXcgcyhlLGEsInNhbXBsZXJVIiwxKSx0aGlzLnY9bmV3IHMoZSxhLCJzYW1wbGVyViIsMil9Y29tcGlsZVNoYWRlcihlLHQpe2NvbnN0IHI9dGhpcy5nbC5jcmVhdGVTaGFkZXIodCk7aWYodGhpcy5nbC5zaGFkZXJTb3VyY2UocixlKSx0aGlzLmdsLmNvbXBpbGVTaGFkZXIociksIXRoaXMuZ2wuZ2V0U2hhZGVyUGFyYW1ldGVyKHIsdGhpcy5nbC5DT01QSUxFX1NUQVRVUykpe2NvbnN0IGU9dGhpcy5nbC5nZXRTaGFkZXJJbmZvTG9nKHIpO3RoaXMuZ2wuZGVsZXRlU2hhZGVyKHIpLGkuZXJyb3IoITAsImNvdWxkIG5vdCBjb21waWxlIHNoYWRlciIsZSl9cmV0dXJuIHJ9Y3JlYXRlUHJvZ3JhbShlLHQpe2NvbnN0IHI9dGhpcy5nbCxzPXIuY3JlYXRlUHJvZ3JhbSgpO3IuYXR0YWNoU2hhZGVyKHMsZSksci5hdHRhY2hTaGFkZXIocyx0KSxyLmxpbmtQcm9ncmFtKHMpLHIudXNlUHJvZ3JhbShzKTtjb25zdCBhPXIuZ2V0UHJvZ3JhbVBhcmFtZXRlcihzLHRoaXMuZ2wuTElOS19TVEFUVVMpO3JldHVybiBpLmVycm9yKCFhLCJwcm9ncmFtIGZhaWwgdG8gbGluayIrci5nZXRTaGFkZXJJbmZvTG9nKHQpKSxzfWluaXRWZXJ0ZXhCdWZmZXJzKGUpe2NvbnN0IHQ9dGhpcy5nbCxyPXQuY3JlYXRlQnVmZmVyKCksaT1uZXcgRmxvYXQzMkFycmF5KFsxLDEsMCwtMSwxLDAsMSwtMSwwLC0xLC0xLDBdKTt0LmJpbmRCdWZmZXIodC5BUlJBWV9CVUZGRVIsciksdC5idWZmZXJEYXRhKHQuQVJSQVlfQlVGRkVSLGksdC5TVEFUSUNfRFJBVyk7Y29uc3Qgcz10LmdldEF0dHJpYkxvY2F0aW9uKGUsImFfdmVydGV4UG9zaXRpb24iKTt0LnZlcnRleEF0dHJpYlBvaW50ZXIocywzLHQuRkxPQVQsITEsMCwwKSx0LmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KHMpO2NvbnN0IGE9bmV3IEZsb2F0MzJBcnJheShbMSwwLDAsMCwxLDEsMCwxXSksbz10LmNyZWF0ZUJ1ZmZlcigpO3QuYmluZEJ1ZmZlcih0LkFSUkFZX0JVRkZFUixvKSx0LmJ1ZmZlckRhdGEodC5BUlJBWV9CVUZGRVIsYSx0LlNUQVRJQ19EUkFXKTtjb25zdCBuPXQuZ2V0QXR0cmliTG9jYXRpb24oZSwiYV90ZXh0dXJlUG9zaXRpb24iKTt0LnZlcnRleEF0dHJpYlBvaW50ZXIobiwyLHQuRkxPQVQsITEsMCwwKSx0LmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KG4pfXJlbmRlckZyYW1lKGUsdCxyKXtpZih0aGlzLnN0b3BSZW5kZXIpcmV0dXJuO2NvbnN0IGk9dGhpcy5nbDtpLnZpZXdwb3J0KDAsMCxpLmNhbnZhcy53aWR0aCxpLmNhbnZhcy5oZWlnaHQpLGkuY2xlYXJDb2xvcigwLDAsMCwwKSxpLmNsZWFyKGkuQ09MT1JfQlVGRkVSX0JJVCk7Y29uc3Qgcz1lKnQsYT1lPj4xLG89dD4+MSxuPWEqbzt0aGlzLnkuZmlsbChlLHQsci5zdWJhcnJheSgwLHMpKSx0aGlzLnUuZmlsbChhLG8sci5zdWJhcnJheShzLHMrbikpLHRoaXMudi5maWxsKGEsbyxyLnN1YmFycmF5KHMrbixyLmxlbmd0aCkpLGkuZHJhd0FycmF5cyhpLlRSSUFOR0xFX1NUUklQLDAsNCl9cmVzaXplKGUsdCl7dGhpcy5zdG9wUmVuZGVyPSEwLGUmJih0aGlzLmNhbnZhcy53aWR0aD1lKSx0JiYodGhpcy5jYW52YXMuaGVpZ2h0PXQpLHNldFRpbWVvdXQoKCk9Pnt0aGlzLnN0b3BSZW5kZXI9ITF9LDEwMCl9ZGVzdHJveSgpe2NvbnN0IGU9dGhpcy5nbDt0aGlzLmdsLmNsZWFyKGUuQ09MT1JfQlVGRkVSX0JJVHxlLkRFUFRIX0JVRkZFUl9CSVR8ZS5TVEVOQ0lMX0JVRkZFUl9CSVQpfX1sZXQgbzshZnVuY3Rpb24oZSl7ZVtlLkNBTlZBUz0wXT0iQ0FOVkFTIixlW2UuSU5JVD0xXT0iSU5JVCIsZVtlLlBMQVk9Ml09IlBMQVkiLGVbZS5ERVNUT1JZPTNdPSJERVNUT1JZIixlW2UuU0laRT00XT0iU0laRSIsZVtlLlNUQVJUPTVdPSJTVEFSVCIsZVtlLlBBVVNFPTZdPSJQQVVTRSJ9KG98fChvPXt9KSk7bGV0IG49bnVsbCxoPW51bGw7Y29uc3QgbD1uZXcgY2xhc3N7Y29uc3RydWN0b3IoZSl7dGhpcy5sYXN0PTAsdGhpcy5mcmFtZT12b2lkIDAsdGhpcy50aW1lPTAsdGhpcy5xdWV1ZT1bXSx0aGlzLmZyYW1lVGltZT12b2lkIDAsdGhpcy5jdXJyZW50PTAsdGhpcy5tYXhOdW09MCx0aGlzLmxvZz12b2lkIDAsdGhpcy5jYWxjdWxhdGU9KCk9Pntjb25zdCBlPURhdGUubm93KCksdD1NYXRoLnJvdW5kKDFlMyp0aGlzLmZyYW1lLyhlLXRoaXMubGFzdCkpO3RoaXMubGFzdD1lLHRoaXMuZnJhbWU9MCx0aGlzLmN1cnJlbnQ9dCx0aGlzLmxvZy5kZWJ1Zyh0KX0sdGhpcy5yZW5kZXJMb29wPSgpPT57dGhpcy5xdWV1ZS5sZW5ndGgmJnRoaXMucmVuZGVyRnJhbWUodGhpcy5xdWV1ZS5zaGlmdCgpKSx0aGlzLmZyYW1lVGltZT1yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5yZW5kZXJMb29wKX0sdGhpcy5zdGFydD0oKT0+e3RoaXMuZnJhbWU9MCxjbGVhclRpbWVvdXQodGhpcy50aW1lKSx0aGlzLm1heE51bSYmdGhpcy5yZW5kZXJMb29wKCksdGhpcy50aW1lPXNlbGYuc2V0SW50ZXJ2YWwodGhpcy5jYWxjdWxhdGUsMWUzKX0sdGhpcy5wYXN1ZT0oKT0+e2NsZWFyVGltZW91dCh0aGlzLnRpbWUpLHRoaXMubWF4TnVtJiZjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLmZyYW1lVGltZSl9LHRoaXMuY2xlYXI9KCk9Pnt0aGlzLnBhc3VlKCksdGhpcy5xdWV1ZT1bXX0sdGhpcy5yZXF1ZXN0RnJhbWU9ZT0+e3RoaXMubWF4TnVtPyh0aGlzLnF1ZXVlLmxlbmd0aD50aGlzLm1heE51bSYmKHRoaXMucXVldWU9W10pLHRoaXMucXVldWUucHVzaChlKSk6KHRoaXMuZnJhbWUrKyxyZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZSkpfSx0aGlzLnJlbmRlckZyYW1lPWU9Pnt0aGlzLmZyYW1lKyssZSgpfSx0aGlzLmxvZz1uZXcgcihlKX19KCJ3ZWJnbCBjb21taXQgZnBzIik7bC5tYXhOdW09MSxvbm1lc3NhZ2U9ZnVuY3Rpb24oZSl7Y29uc3QgdD1lLmRhdGE7c3dpdGNoKHQudHlwZSl7Y2FzZSBvLkNBTlZBUzpoPXQuY2FudmFzO2Nhc2Ugby5JTklUOm49bmV3IGEoaCk7YnJlYWs7Y2FzZSBvLlBMQVk6bC5yZXF1ZXN0RnJhbWUoKCk9Pntjb25zdHt3aWR0aDplLGhlaWdodDpyLGJ1ZmZlcjppfT10O24ucmVuZGVyRnJhbWUoZSxyLGkpfSk7YnJlYWs7Y2FzZSBvLlNUQVJUOmwuc3RhcnQoKTticmVhaztjYXNlIG8uUEFVU0U6bC5wYXN1ZSgpO2JyZWFrO2Nhc2Ugby5TSVpFOm4ucmVzaXplKHQud2lkdGgsdC5oZWlnaHQpO2JyZWFrO2Nhc2Ugby5ERVNUT1JZOm4mJm4uZGVzdHJveSgpLGwuY2xlYXIoKSxuPW51bGx9fTsKCg==",null,!1);let B;!function(e){e[e.CANVAS=0]="CANVAS",e[e.INIT=1]="INIT",e[e.PLAY=2]="PLAY",e[e.DESTORY=3]="DESTORY",e[e.SIZE=4]="SIZE",e[e.START=5]="START",e[e.PAUSE=6]="PAUSE"}(B||(B={}));const H=[];const K=new WeakMap();class O{constructor(e){if(this.canvas=void 0,this.webglWorker=void 0,this.current=void 0,this.sendMessage=(e,t,s)=>{s?this.webglWorker.postMessage({type:e,...t},[s]):this.webglWorker.postMessage({type:e,...t})},this.fullscreen=()=>{const e=this.canvas;e.requestFullscreen&&e.requestFullscreen()},this.exitfullscreen=()=>{document.exitFullscreen&&document.exitFullscreen()},this.canvas=e,this.webglWorker=H.length?H.pop():new _(),K.has(e))this.sendMessage(B.INIT);else{!function(e,t){let s=0,n=t.width,i=t.height;const r=()=>e.postMessage({type:B.SIZE,width:n,height:i});Object.defineProperties(t,{width:{get:()=>n,set:e=>{n=e,clearTimeout(s),s=window.setTimeout(r,100)}},height:{get:()=>i,set:e=>{i=e,clearTimeout(s),s=window.setTimeout(r,100)}}})}(this.webglWorker,e);const t=e.transferControlToOffscreen();this.sendMessage(B.CANVAS,{canvas:t},t),K.set(e,!0)}}renderFrame(e,t,s){this.sendMessage(B.PLAY,{width:e,height:t,buffer:s},s.buffer)}start(){this.sendMessage(B.START)}pause(){this.sendMessage(B.PAUSE)}destory(){this.sendMessage(B.DESTORY),H.push(this.webglWorker)}}const Q=new Set();function j(){document.removeEventListener("click",j),document.removeEventListener("keydown",j),Q.forEach(e=>e()),Q.clear()}document.addEventListener("click",j),document.addEventListener("keydown",j);class ${constructor(e){this.props=void 0,this.audioCtx=void 0,this.gainNode=void 0,this.bufferSource=void 0,this.duration=0,this.paused=!0,this.hasAudio=!1,this.buffers=[],this.currentPTS=0,this.acutalTime=0,this.nextTime=0,this.audioCtx=new(window.AudioContext||window.webkitAudioContext)(),this.gainNode=this.audioCtx.createGain(),this.setOptions(e),"running"!==this.audioCtx.state&&Q.add(()=>this.audioCtx.resume())}setOptions(e){e&&(this.props={...this.props,...e},"volume"in e&&this.setVolume(e.volume))}setVolume(e){this.gainNode.gain.setValueAtTime(e,this.audioCtx.currentTime)}append(e){"running"===this.audioCtx.state&&(this.buffers.push(e),!this.paused&&this.nextTime<=this.audioCtx.currentTime&&this.flush())}play(){this.paused=!1,this.flush()}pause(){this.paused=!0,this.bufferSource&&this.bufferSource.stop(this.audioCtx.currentTime)}flush(){if(0===this.buffers.length)return void(this.hasAudio=!1);this.hasAudio=!0,this.currentPTS=this.buffers[0].pts;const e=this.getBuffer(this.buffers.map(e=>e.buffer));this.buffers=[],this.playBuffer(e)}flushBuffer(){this.buffers=[],this.hasAudio=!1}getBuffer(e){if(!Array.isArray(e))return e;let t=0;e.forEach(e=>t+=e.length);const s=new Uint8Array(t);let n=0;return e.forEach(e=>{s.set(e,n),n+=e.length}),s}playBuffer(e){const t=this.audioCtx,{channels:s,sampleRate:n,sampleFmt:i}=this.props,r=i<<1,o=e.length/r/s,a=t.createBuffer(s,o,n);this.adjustBuffer(a,o,this.getTypeArray(e.buffer));const l=t.createBufferSource();return l.buffer=a,l.connect(this.gainNode),this.gainNode.connect(this.audioCtx.destination),this.nextTime<=t.currentTime?(this.nextTime=t.currentTime,this.acutalTime=this.nextTime):this.acutalTime=this.nextTime,l.start(this.nextTime),l.onended=()=>{this.acutalTime=this.nextTime,this.flush()},this.nextTime+=a.duration,this.bufferSource=l,a.duration}getTypeArray(e){switch(this.props.sampleFmt){case 1:const t=new Int16Array(e),s=32768;return e=>t[e]/s;case 2:const n=new Float32Array(e);return e=>n[e]}}adjustBuffer(e,t,s){const{channels:n}=this.props;for(let i=0;i<n;i++){const r=e.getChannelData(i);let o=i;for(let e=0;e<t;e++)r[e]=s(o),o+=n}}get currentTime(){return this.audioCtx.currentTime-this.acutalTime+this.currentPTS/1e3}}class q{constructor(e){this.last=0,this.frame=void 0,this.time=0,this.queue=[],this.frameTime=void 0,this.current=0,this.maxNum=0,this.log=void 0,this.calculate=()=>{const e=Date.now(),t=Math.round(1e3*this.frame/(e-this.last));this.last=e,this.frame=0,this.current=t,this.log.debug(t)},this.renderLoop=()=>{this.queue.length&&this.renderFrame(this.queue.shift()),this.frameTime=requestAnimationFrame(this.renderLoop)},this.start=()=>{this.frame=0,clearTimeout(this.time),this.maxNum&&this.renderLoop(),this.time=self.setInterval(this.calculate,1e3)},this.pasue=()=>{clearTimeout(this.time),this.maxNum&&cancelAnimationFrame(this.frameTime)},this.clear=()=>{this.pasue(),this.queue=[]},this.requestFrame=e=>{this.maxNum?(this.queue.length>this.maxNum&&(this.queue=[]),this.queue.push(e)):(this.frame++,requestAnimationFrame(e))},this.renderFrame=e=>{this.frame++,e()},this.log=new l(e)}}var ee;!function(e){e[e.PROBESIZE=2048]="PROBESIZE",e[e.MAXDOWNLOADBUFFER=1e3]="MAXDOWNLOADBUFFER",e[e.MINDOWNLOADBUFFER=1e3]="MINDOWNLOADBUFFER"}(ee||(ee={}));class te extends w{static probe(){return!0}constructor(e){super(e,"WasmPlayer"),this.decodeBufctl=void 0,this.totalLength=0,this.bufferLimit=100,this.bufferNumber=0,this.webgl=void 0,this.audio=void 0,this.fps=new q("webgl pending fps"),this.decoder=void 0,this.avParams=void 0,this.baseVideoTime=0,this.baseAudioTime=0,this.fpsInterval=0,this.videoQueue=[],this.audioQueue=[],this.commonFrames=0,this.lostFrames=0,this.lostPacketFrames=0,this.lastFramesTime=[],this.avFrame=void 0,this.avDecodeTime=void 0,this.decodeTotalTime=0,this.decodeTotalFrame=0,this.onDownload=(e,t)=>this.decoder.onDownloadBuffer(e,t),this.onAVBuffer=e=>{"video"===e.stream?(this.videoQueue.push(e),e.pts=e.pts-this.baseVideoTime,this.endV=e.pts,this.endV):(this.audio.append(e),e.pts=e.pts-this.baseAudioTime,this.endA=e.pts),this.lastFramesTime.push(e.decodeTime),this.lastFramesTime.length>30&&this.lastFramesTime.shift(),this.decodeTotalTime+=e.decodeTime,this.decodeTotalFrame+=1},this.onAVLost=({pts:e})=>{this._currentTime=e-this.baseVideoTime,this.videoQueue=[],this.audio.flush()},this.renderFrame=e=>{const{width:t,height:s}=this.playParams;this.fps.renderFrame(()=>this.shouldRender&&this.webgl.renderFrame(t,s,e.buffer))},this.onLoop=(e,t)=>{this.videoQueue.length>50&&(this.videoQueue.splice(0,25),this._currentTime=this.videoQueue[0].pts,e=this._currentTime,this.lostFrames+=50);let s=e;for(this.audio.hasAudio&&(s=1e3*this.audio.currentTime,this._currentTime=s);this.videoQueue.length;){if(!(this.videoQueue[0].pts<=s))break;this.renderFrame(this.videoQueue.shift())}},this.createMediaElement()}createMediaElement(){const e=document.createElement("canvas");e.style.width="100%",e.style.height="100%",super.bindElement(e),this.webgl=new O(e)}async load(){try{if(super.load(),this.decoder=Y.create({}),await this.decoder.load(),this.status===Z.DISCARD)return;if(this.loadDownload(),this.decoder.onerror=this.onerror,this.decodeBufctl=new D({unit:"decode video number",minimum:25,maximum:75,getValue:()=>this.videoQueue.length,pause:()=>this.decoder.stopDecoding(),resume:()=>this.decoder.startDecoding(),isDone:()=>this.decoder.isDone(),destory:()=>this.decoder.destory()}),this.downBufctl.startCheck(),this.avParams=await this.decoder.getVideoParams(),this.status===Z.DISCARD)return;const{width:e,height:t,rate:s}=this.avParams.video;this.playParams={width:e,height:t},this.fpsInterval=1e3/s,this.statusUtil.set(Z.LOAD),this.emit("loadedmetadata"),this.on("volumechange",()=>this.audio&&this.audio.setOptions({volume:this._volume}))}catch(e){}}async reloadUrl(){this.pause(!1),this.decoder.flushBuffers(),await super.reloadUrl(),this.baseVideoTime=null,this.baseAudioTime=null,this.videoQueue=[],this.audio.flushBuffer()}loadDownload(){const e=super.loadDownload();return this.downBufctl=new D({unit:"pending frame",minimum:100,maximum:200,getValue:()=>this.decoder.pendingFrames,pause:()=>this.download.pause(),resume:()=>this.download.resume(),isDone:()=>this.download.isDone(),destory:()=>this.download.destory()}),e}play(e=!0){return!!super.play(e)&&(this.statusUtil.no(Z.LOADDATA)?this.firstPlay():(e&&this.emit("play"),this.downBufctl.startCheck(),this.normalPlay()),this.audio=new $({...this.avParams.audio,volume:this._volume}),this.decodeBufctl.startCheck(),this.decoder.startDecoding(),!0)}firstPlay(){this.decoder.onAVFrame=e=>{this.baseVideoTime||"video"!==e.stream||(this.baseVideoTime=e.pts),this.baseAudioTime||"audio"!==e.stream||(this.baseAudioTime=e.pts),this.onAVBuffer(e),this.videoQueue.length<10||(this.emit("loadeddata"),this.statusUtil.contact(Z.LOADDATA),this.decoder.onAVFrame=this.onAVBuffer,this.normalPlay())},this.decoder.onAVLost=this.onAVLost}normalPlay(){this.commonFrames=0,this.startRender()}framePlay(){if(this.statusUtil.no(Z.FPLAY)&&(this.statusUtil.replace(Z.PLAYING,Z.PAUSE),this.decodeBufctl.startCheck(),this.downBufctl.startCheck()),this.videoQueue.length){const e=this.videoQueue.shift();super._currentTime=e.pts,this.renderFrame(e)}}startRender(){this.audio.play(),this.fps.start(),this.webgl.start(),this._resetAnimate(),this._animate()}pauseRender(){this.audio.pause(),this.fps.pasue(),this.webgl.pause()}pause(e=!0){return!!super.pause(e)&&(this.decodeBufctl.pause(),this.decodeBufctl.cancelCheck(),this.pauseRender(),!0)}destory(){super.destory(),this.decodeBufctl&&this.decodeBufctl.cancelCheck(),Y.destory(this.decoder),this.decoder=null,this.videoQueue=[],this.audio.flushBuffer(),this.webgl&&this.webgl.destory(),this.fps.clear()}set currentTime(e){this._currentTime=e,this.seek(),this.emit("timeupdate",e)}get currentTime(){return this._currentTime}get debugInfo(){const{decodeTotalFrame:e,decodeTotalTime:t,lastFramesTime:s,videoQueue:n}=this;let i=0;s.forEach(e=>i+=e);(t/e).toFixed(2);const r=(i/s.length).toFixed(2);return{"当前时间":this._currentTime/1e3,"下三帧时间":n.slice(0,3).map(e=>e.pts/1e3).join(", "),"队列长度":n.length,"丢帧数":this.lostFrames,"近30帧时间":`${r}ms`}}}function se(e,t=0,s){(s||0!==t)&&(s=s||e.byteLength+1,e=e.slice(t,s));const n=new DataView(e);return{buffer:n,current:0,value:n.getUint32(0),bits:0,avaliabe:32,index:0}}function ne(e,t){if(0===t)return 0;let s;if(e.avaliabe>=t)e.bits+=t,e.avaliabe=32-e.bits,s=e.value>>>e.avaliabe;else{e.current+=4,e.bits=t-e.avaliabe,e.avaliabe=32-e.bits;const n=e.buffer.getUint32(e.current);s=e.value<<e.bits|n>>>e.avaliabe,e.value=n}return 0===e.avaliabe?(e.current+=4,e.bits=0,e.avaliabe=32,e.value=e.buffer.getUint32(e.current)):e.value&=(1<<e.avaliabe)-1>>>0,e.index+=t,s}function ie(e){const t=e.buffer.getUint8(e.current);return e.current+=1,t}function re(e){const t=e.buffer.getUint16(e.current);return e.current+=2,t}function oe(e){const t=e.value;if(e.current+=4,e.value=e.buffer.getUint32(e.current),32===e.avaliabe)return t;return t*2**e.bits+(t>>>e.avaliabe)}function ae(e,t){const s=e.byteLength-4;for(;t.current<s;t.current++)if(1===e.getUint32(t.current))return t.current+=le,t.current}const le=4;class ce{static getStream(e,t){const s=Object.create(new ce(e));return t&&Object.keys(t).forEach(e=>{s[e]=t[e]}),s}constructor(e){this.start=0,this.end=0,this.extraRange=null,this._buffer=void 0,this._buffer=e}buffer(){if(this.extraRange){const e=this.end-this.start;let t=e;this.extraRange.forEach(e=>t+=e[2]);const s=new Uint8Array(t),n=[[this.start,this.end,e],...this.extraRange];let i=0;return n.forEach(e=>{const t=this._buffer.slice(e[0],e[1]);s.set(new Uint8Array(t),i),i+=e[2]}),s.buffer}return this._buffer.slice(this.start,this.end)}merge(e){this.extraRange||(this.extraRange=[]),this.extraRange.push([e.start,e.end,e.end-e.start])}}const he={id:null,pid:null,container:void 0,inputTimeScale:0,sequenceNumber:0,timescale:null,duration:null,pixelRatio:null,samples:null},ue={id:null,units:null,pts:null,dts:null,duration:0};function de(e){const t=(14&ie(e))<<29,s=(65534&re(e))<<14,n=(65534&re(e))>>1;return Math.round((t>>>0)+s+n)}function pe(e){let t=e.buffer.byteLength-e.current,s=0;for(;t>0;){t--;const n=s;if(s=16777215&(s<<8|ie(e)),1===n)return s}return-1}class me{constructor(){this.name="ps stream",this.videoType=void 0,this.audioType=void 0,this.streams=[]}probe(e){return this.parse(e),this.videoType}parsePSMH(e){const t=re(e);ie(e),ie(e),re(e),re(e);let s=t-0-10;for(;s>=4;){const t=ie(e);ie(e),re(e),this.videoType?this.audioType=t:this.videoType=t,s-=4}}parsePES(e,t){const s=re(e),n=e.current-1+s;ie(e);const i=ie(e),r=ie(e),o=e.current+r;128&i&&(t.pts=de(e),64&i&&de(e)),t.start=o,t.end=n+1,e.current=n}parse(e){this.clear();const t=se(e);let s=!1,n={},i=null;for(;i=pe(t);){if(-1===i)return;switch(i){case 442:s=!0;break;case 443:break;case 444:this.parsePSMH(t);break;case 480:case 448:const r=255&i,o=ce.getStream(e);o.id=r,this.parsePES(t,o),!s&&n[r]&&n[r].pts===o.pts?n[r].merge(o):(this.streams.push(o),n[r]=o,s=!1)}}}clear(){this.streams=[]}}function fe(e){const{current:t,bits:s}=e;for(;0===ne(e,1););const n=8*(e.current-t)+(e.bits-s)-1;return(1<<n|ne(e,n))-1}function ye(e){const t=fe(e);return 1&t?1+t>>>1:-1*(t>>>1)}const be=[[0,1],[1,1],[12,11],[10,11],[16,11],[40,33],[24,11],[20,11],[32,11],[80,33],[18,11],[15,11],[64,33],[160,99],[4,3],[3,2],[2,1]];function ge(e,t){if(!ne(e,1))return 0;let s=8,n=8;for(let i=0;i<t;i++){if(n){const t=ye(e);if(t<-128||t>128)return 0;n=s+t&255}if(!i&&!n)break;s=n||s}return 0}function ve(e){const t=ne(e,8),s=ne(e,6);!function(e,t){const s=e.bits+t;if(e.bits>32){const t=Math.floor(s/8);e.current+=t,e.bits=s-8*t}else e.bits=s;e.avaliabe=32-e.bits,e.value&=(1<<e.avaliabe)-1,e.index+=t}(e,2);const n=ne(e,8),i={sps_id:fe(e),time_offset_length:24,profile_idc:t,constraint_set_flags:s,level_idc:n,full_range:-1,scaling_matrix_present:0,color_primaries:0,color_trc:null,colorspace:2,colour_description_present_flag:0,offset_for_ref_frame:[],mb_width:0,mb_height:0,sar:{num:0,den:0}};if(100===t||110===t||122===t||244===t||44===t||83===t||86===t||118===t||128===t||138===t||144===t){const t=fe(e);if(i.chroma_format_idc=t,t>3);else if(3===t){ne(e,1)}fe(e),fe(e),ne(e,1);!function(e,t){let s=0;ne(e,1)&&(s|=ge(e,16),s|=ge(e,16),s|=ge(e,16),s|=ge(e,16),s|=ge(e,16),s|=ge(e,16),s|=ge(e,64),s|=ge(e,64),3===t.chroma_format_idc&&(s|=ge(e,64),s|=ge(e,64),s|=ge(e,64),s|=ge(e,64)))}(e,i)}fe(e);const r=fe(e);if(0===r){fe(e)}else if(1===r){ne(e,1),fe(e),fe(e);const t=fe(e);for(let s=0;s<t;s++)i.offset_for_ref_frame[s]=fe(e)}fe(e),ne(e,1);if(i.mb_width=fe(e)+1,i.mb_height=fe(e)+1,i.frame_mbs_only_flag=ne(e,1),0===i.frame_mbs_only_flag){ne(e,1)}i.mb_height*=2-i.frame_mbs_only_flag;ne(e,1);if(ne(e,1)){i.crop_left=fe(e),i.crop_right=fe(e),i.crop_top=fe(e),i.crop_bottom=fe(e);const t=1===i.chroma_format_idc?1:0,s=1<<(1===i.chroma_format_idc||2===i.chroma_format_idc?1:0),n=2-i.frame_mbs_only_flag<<t;i.crop_left=i.crop_left*s,i.crop_right=i.crop_right*s,i.crop_top=i.crop_top*n,i.crop_bottom=i.crop_bottom*n}else i.crop_left=0,i.crop_right=0,i.crop_top=0,i.crop_bottom=0;ne(e,1)&&function(e,t){if(ne(t,1)){const s=ne(t,8);if(255===s)e.sar.num=ne(t,16),e.sar.den=ne(t,16);else if(s<be.length){const t=be[s];e.sar={num:t[0],den:t[1]}}}else e.sar.num=0,e.sar.den=0;if(ne(t,1)&&ne(t,1),ne(t,1)&&(ne(t,3),e.full_range=ne(t,1),e.colour_description_present_flag=ne(t,1),e.colour_description_present_flag&&(e.color_primaries=ne(t,8),e.color_trc=ne(t,8),e.colorspace=ne(t,8))),ne(t,1)){fe(t);fe(t)}if(e.timing_info_present_flag=ne(t,1),e.timing_info_present_flag){const s=oe(t),n=oe(t);s&&n?(e.num_units_in_tick=s,e.time_scale=n):e.timing_info_present_flag=0,e.fixed_frame_rate_flag=ne(t,1)}}(i,e),(0===i.sar.den||i.sar.num)&&(i.sar={den:1,num:1});let o=0;return i.time_scale&&(o=i.time_scale/i.num_units_in_tick,o=1===i.fixed_frame_rate_flag?o/2:o),{width:16*i.mb_width-(i.crop_right+i.crop_left),height:16*i.mb_height-(i.crop_top+i.crop_bottom),pixelRatio:i.sar,fps:o}}var Ze;function Re(e){let t="avc1.";return e.subarray(1,4).forEach(e=>{let s=e.toString(16);s.length<2&&(s=`0${s}`),t+=s}),t}!function(e){e[e.NAL_UNKNOWN=100]="NAL_UNKNOWN",e[e.NAL_SLICE=1]="NAL_SLICE",e[e.NAL_SLICE_DPA=2]="NAL_SLICE_DPA",e[e.NAL_SLICE_DPB=3]="NAL_SLICE_DPB",e[e.NAL_SLICE_DPC=4]="NAL_SLICE_DPC",e[e.NAL_SLICE_IDR=5]="NAL_SLICE_IDR",e[e.NAL_SEI=6]="NAL_SEI",e[e.NAL_SPS=7]="NAL_SPS",e[e.NAL_PPS=8]="NAL_PPS"}(Ze||(Ze={}));class we extends class{constructor(){this.current=0}}{constructor(...e){super(...e),this.sps=void 0,this.pps=void 0,this.spsIndex=void 0,this.ppsIndex=void 0}probe(e){this.parse(e,Ze.NAL_SPS);return this.sps?Re(new Uint8Array(this.sps.buffer)):""}parse(e,t){const s=new DataView(e);this.current=0;const n=[];let i=!1;for(this.spsIndex=-1,this.ppsIndex=-1;ae(s,this);){const r=n.length,o=31&s.getUint8(this.current);switch(i=!0,o){case Ze.NAL_SLICE:case Ze.NAL_SLICE_IDR:case Ze.NAL_SLICE_DPA:case Ze.NAL_SLICE_DPB:case Ze.NAL_SLICE_DPC:case Ze.NAL_SEI:break;case Ze.NAL_SPS:const t=ve(se(e,this.current+1));0===t.fps&&(t.fps=25),this.spsIndex=r,this.sps=Object.assign(t,{buffer:null});break;case Ze.NAL_PPS:this.ppsIndex=r,this.pps={buffer:null};break;case Ze.NAL_UNKNOWN:default:i=!1}if(i&&(r&&(n[r-1].end=this.current-le),n[r]=ce.getStream(e,{type:o,start:this.current})),o===t)break}return n.length&&(n[n.length-1].end=e.byteLength),-1!==this.spsIndex&&(this.sps.buffer=n[this.spsIndex].buffer()),-1!==this.ppsIndex&&(this.pps.buffer=n[this.ppsIndex].buffer()),n}createTrack(e,t){const s={...he,samples:[],id:1,type:"video",container:"video/mp2t",codec:null,timescale:9e4,inputTimeScale:9e4,sps:null,pps:null,width:null,height:null,fps:null},{height:n,width:i,fps:r,pixelRatio:o}=this.sps;return s.width=i,s.height=n,s.fps=r,s.pixelRatio=[o.den,o.num],s.sps=[new Uint8Array(e)],s.pps=[new Uint8Array(t)],s.codec=Re(s.sps[0]),s}}const xe=Math.pow(2,32)-1,Ve=new Uint8Array([0,0,0,0,0,0,0,0]),Ge=new Uint8Array([105,115,111,109]),Le=new Uint8Array([97,118,99,49]),Se=new Uint8Array([0,0,0,1]),We=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),Xe={avc1:null,avcC:null,btrt:null,dinf:null,dref:null,esds:null,ftyp:null,hdlr:null,mdat:null,mdhd:null,mdia:null,mfhd:null,minf:null,moof:null,moov:null,mp4a:null,".mp3":null,mvex:null,mvhd:null,pasp:null,sdtp:null,stbl:null,stco:null,stsc:null,stsd:null,stsz:null,stts:null,tfdt:null,tfhd:null,traf:null,trak:null,trun:null,trex:null,tkhd:null,vmhd:null,smhd:null};Object.keys(Xe).forEach(e=>{Xe[e]=new Uint8Array([e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)])});class Te{static box(e,...t){let s=8,n=t.length;for(;n--;)s+=t[n].byteLength;const i=new Uint8Array(s);i[0]=s>>24&255,i[1]=s>>16&255,i[2]=s>>8&255,i[3]=255&s,i.set(e,4);const r=t.length;for(n=0,s=8;n<r;n++)i.set(t[n],s),s+=t[n].byteLength;return i}static mdat(e){return Te.box(Te.types.mdat,e)}static trun(e,t){const s=e.samples||[],n=s.length,i=12+16*n,r=new Uint8Array(i);t+=8+i,r.set([0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,255&n,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0);for(let e=0;e<n;e++){const{duration:t,size:n,flags:i,cts:o}=s[e];r.set([t>>>24&255,t>>>16&255,t>>>8&255,255&t,n>>>24&255,n>>>16&255,n>>>8&255,255&n,i.isLeading<<2|i.dependsOn,i.isDependedOn<<6|i.hasRedundancy<<4|i.paddingValue<<1|i.isNonSync,61440&i.degradPrio,15&i.degradPrio,o>>>24&255,o>>>16&255,o>>>8&255,255&o],12+16*e)}return Te.box(Te.types.trun,r)}static sdtp(e){const t=e.samples||[],s=new Uint8Array(4+t.length);for(let e=0;e<t.length;e++){const n=t[e].flags;s[e+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy}return Te.box(Te.types.sdtp,s)}static traf(e,t){let s=Te.sdtp(e),n=e.id,i=Math.floor(t/(xe+1)),r=Math.floor(t%(xe+1));return Te.box(Te.types.traf,Te.box(Te.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),Te.box(Te.types.tfdt,new Uint8Array([1,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,r>>24,r>>16&255,r>>8&255,255&r])),Te.trun(e,s.length+16+20+8+16+8+8),s)}static mfhd(e){return Te.box(Te.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}static moof(e,t,s){return Te.box(Te.types.moof,Te.mfhd(e),Te.traf(s,t))}static avc1(e){let t=[],s=[];for(let s=0;s<e.sps.length;s++){const n=e.sps[s],i=n.byteLength;t.push(i>>>8&255),t.push(255&i),t=t.concat(Array.prototype.slice.call(n))}for(let t=0;t<e.pps.length;t++){const n=e.pps[t],i=n.byteLength;s.push(i>>>8&255),s.push(255&i),s=s.concat(Array.prototype.slice.call(n))}const n=Te.box(Te.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(s))),i=e.width,r=e.height,o=e.pixelRatio[0],a=e.pixelRatio[1];return Te.box(Te.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,i>>8&255,255&i,r>>8&255,255&r,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),n,Te.box(Te.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Te.box(Te.types.pasp,new Uint8Array([o>>24,o>>16&255,o>>8&255,255&o,a>>24,a>>16&255,a>>8&255,255&a])))}static esds(e){let t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static mp4a(e){let t=e.samplerate;return Te.box(Te.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]),Te.box(Te.types.esds,Te.esds(e)))}static mp3(e){let t=e.samplerate;return Te.box(Te.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]))}static stsd(e){return"audio"===e.type?e.isAAC||"mp3"!==e.codec?Te.box(Te.types.stsd,Te.STSD,Te.mp4a(e)):Te.box(Te.types.stsd,Te.STSD,Te.mp3(e)):Te.box(Te.types.stsd,Te.STSD,Te.avc1(e))}static stbl(e){return Te.box(Te.types.stbl,Te.stsd(e),Te.box(Te.types.stts,Te.STTS),Te.box(Te.types.stsc,Te.STSC),Te.box(Te.types.stsz,Te.STSZ),Te.box(Te.types.stco,Te.STCO))}static minf(e){return"audio"===e.type?Te.box(Te.types.minf,Te.box(Te.types.smhd,Te.SMHD),Te.DINF,Te.stbl(e)):Te.box(Te.types.minf,Te.box(Te.types.vmhd,Te.VMHD),Te.DINF,Te.stbl(e))}static hdlr(e){return Te.box(Te.types.hdlr,Te.HDLR_TYPES[e])}static mdhd(e,t){t*=e;const s=Math.floor(t/(xe+1)),n=Math.floor(t%(xe+1));return Te.box(Te.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,s>>24,s>>16&255,s>>8&255,255&s,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))}static mdia(e){const{type:t,timescale:s,duration:n}=e;return Te.box(Te.types.mdia,Te.mdhd(s,n),Te.hdlr(t),Te.minf(e))}static tkhd(e){const{id:t,width:s=0,height:n=0,timescale:i}=e,r=e.duration*e.timescale,o=Math.floor(r/(xe+1)),a=Math.floor(r%(xe+1));return Te.box(Te.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,a>>24,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,255&s,0,0,n>>8&255,255&n,0,0]))}static trak(e){return e.duration=e.duration||4294967295,Te.box(Te.types.trak,Te.tkhd(e),Te.mdia(e))}static trex(e){let t=e.id;return Te.box(Te.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static mvex(e){return Te.box(Te.types.mvex,...e.map(e=>Te.trex(e)))}static mvhd(e){const t=e.timescale,s=t*e.duration,n=Math.floor(s/(xe+1)),i=Math.floor(s%(xe+1)),r=e.isLive?[255,255,255,255,255,255,255,255]:[n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i],o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,...r,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Te.box(Te.types.mvhd,o)}static moov(e){return Te.box(Te.types.moov,Te.mvhd(e[0]),...e.map(e=>Te.trak(e)),Te.mvex(e))}static initSegment(e){const t=Te.moov(e),s=new Uint8Array(Te.FTYP.byteLength+t.byteLength);return s.set(Te.FTYP),s.set(t,Te.FTYP.byteLength),s}}function Ue(e,t){if(void 0===t)return e;let s=null;for(s=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=s;return e}let ke,Ee;Te.types=Xe,Te.HDLR_TYPES={video:new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),audio:new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0])},Te.STTS=Ve,Te.STSC=Ve,Te.STCO=Ve,Te.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Te.STSD=new Uint8Array([0,0,0,0,0,0,0,1]),Te.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Te.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Te.FTYP=Te.box(Te.types.ftyp,Ge,Se,Ge,Le),Te.DINF=Te.box(Te.types.dinf,Te.box(Te.types.dref,We)),function(e){e.INIT_SEGMENT="INIT_SEGMENT",e.PARSING_DATA="PARSING_DATA"}(ke||(ke={}));class Me extends r{constructor(){super(),this.log=new l("mp4 remux"),this.init=!1,this.initPTS=void 0,this.initDTS=void 0,this.nextAvcDts=void 0}resetSegment(){this.init=!1}generateIS(e,t,s){const n=void 0===this.initPTS,i={};let r,o;if(n&&(r=o=1/0),t.sps&&t.pps&&t.samples.length){const{inputTimeScale:e,codec:a,width:l,height:c,fps:h,samples:u}=t;t.timescale=e,i.video={container:"video/mp4",codec:a,initSegment:Te.initSegment([t]),metadata:{width:l,height:c,rate:h}},n&&(this.initPTS=Math.min(r,u[0].pts-e*s),this.initDTS=Math.min(o,u[0].dts-e*s))}Object.keys(i).length,this.init=!0,this.emit(ke.INIT_SEGMENT,i)}remuxAudio(e,t,s){}remuxEmptyAudio(e){const t=e.inputTimeScale;e.samplerate&&e.samplerate}remuxVideo(e,t,s){let n=0;const i=e.timescale,r=e.samples;let o=0;s||(o=t*i);r.forEach(e=>{e.pts=Ue(e.pts-0,o),e.dts=Ue(e.dts-0,o)}),r.sort((e,t)=>{const s=e.dts-t.dts,n=e.pts-t.pts;return s||n||e.id-t.id});const a=r[0],l=Math.max(a.pts,0),c=Math.max(a.dts,0),h=r[r.length-1],u=Math.max(h.pts,0),d=Math.max(h.dts,0);let p=0,m=0;r.forEach((e,t)=>{let s=0;e.units.forEach(e=>s+=e.data.byteLength),p+=s,m+=e.units.length,e.length=s,e.dts=Math.max(e.dts,c),e.pts=Math.max(e.pts,e.dts)});let f=p+4*m+8;const y=new Uint8Array(f),b=new DataView(y.buffer);b.setUint32(0,f),y.set(Te.types.mdat,4);let g=8;const v=[];r.forEach((e,t)=>{let s=0;if(e.units.forEach(e=>{const t=e.data;b.setUint32(g,t.byteLength),g+=4,y.set(new Uint8Array(t),g),g+=t.byteLength,s+=4+t.byteLength}),t<r.length-1)n=r[t+1].dts-e.dts;else{const s=e.dts-r[t>0?t-1:t].dts;n=s}v.push({size:s,duration:n,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e.key?2:1,isNonSync:e.key?0:1}})}),this.nextAvcDts=d+n,e.samples=v;const Z=Te.moof(e.sequenceNumber++,c,e);e.samples=[];const R=new Uint8Array(Z.byteLength+y.byteLength);R.set(Z,0),R.set(y,Z.byteLength);const w={segment:R,startPTS:l/i,endPTS:(u+n)/i,startDTS:c/i,endDTS:this.nextAvcDts/i,type:"video",hasAudio:!1,hasVideo:!0,nb:v.length,dropped:0};this.emit(ke.PARSING_DATA,w)}remux(e,t,s){this.init||this.generateIS(e,t,s);const n=t.samples.length;if(e&&n){e.samples[0].pts,t.samples[0].pts,t.inputTimeScale}this.remuxVideo(t,s,!1)}}function Ce(e){let t=(112&(e^=85))>>4,s=15&e;return s<<=4,0!=t&&(s|=264,s<<=t-1),0===(128&e)?-s:s}!function(e){e.PCM_INIT="PCM_INIT",e.PCM_DATA="PCM_DATA"}(Ee||(Ee={}));class Ne extends r{constructor(...e){super(...e),this.params={sampleFmt:1,channels:1,sampleRate:8e3},this.init=!1}parse(e,t){this.init||(this.emit(Ee.PCM_INIT,this.params),this.init=!0);const s=function(e){const t=e.length,s=new Uint16Array(t);for(let n=0;n<t;n++)s[n]=Ce(e[n]);return new Uint8Array(s.buffer)}(new Uint8Array(e));this.emit(Ee.PCM_DATA,{pts:t,buffer:s})}}class Ie extends r{constructor(e){super(),this.isLive=!1,this.psdemux=new me(),this.avcDemux=new we(),this.mp4Remux=new Me(),this.audioDecode=new Ne(),this.probed=!1,this.tracks={video:null,audio:null},this.firstAPTS=null,this.firstVPTS=null,this.append=e=>{const t=this.psdemux;if(t.parse(e),27===this.psdemux.videoType)return this.psdemux.audioType,t.streams.forEach(e=>{224===e.id?this.demuxVideo(e):this.demuxAudio(e)}),this.remux()},r.transferEvent(this.mp4Remux,this),r.transferEvent(this.audioDecode,this),e&&(this.isLive=e.isLive||!1)}demuxVideo(e){null===this.firstVPTS&&(this.firstVPTS=e.pts);const t=e.buffer(),s=this.avcDemux.parse(t),{tracks:n}=this;if(!n.video){const{sps:e,pps:t}=this.avcDemux;if(!e||!t)return;const s=this.avcDemux.createTrack(e.buffer,t.buffer);n.video=s,s.isLive=this.isLive,this.mp4Remux.resetSegment()}const i={...ue,units:[]};i.pts=i.dts=e.pts-this.firstVPTS,i.units=s.map(e=>({...e,data:e.buffer()})),n.video.samples.push(i)}demuxAudio(e){null===this.firstAPTS&&(this.firstAPTS=e.pts),e.pts-=this.firstAPTS,this.audioDecode&&this.audioDecode.parse(e.buffer(),e.pts/90)}remux(){const{video:e,audio:t}=this.tracks;if(!e||e.samples.length<2)return!1;const{samples:s}=e,n=s[s.length-1].pts-s[0].dts;e.duration=n/e.inputTimeScale,this.mp4Remux.remux(t,e,0),e.samples=[]}}const Ae=new we();let Fe=1;class Ye extends w{static probe(e){const t=Ae.probe(e);return MediaSource.isTypeSupported(`video/mp4;codecs="${t}"`)}constructor(e){super(e,"MSEPlayer"+Fe),this.ms=void 0,this.sourceBuffer={},this.objectUrl=void 0,this.buffered=0,this.trackList=[],this.pendingSemgemt=[],this.contorller=null,this.audio=void 0,this.pcmFrames=[],this.downBufctl=void 0,this.visibility=!0,this.offScreen={playedTime:0,start:0},this.onMediaSourceOpen=()=>{this.log.debug("media source opened")},this.onMediaSourceEnded=()=>{this.log.debug("media source ended")},this.onMediaSourceClose=()=>{this.log.debug("media source closed")},this.visibilityChange=()=>{if(this.statusUtil.has(Z.PLAYING))if("visible"===document.visibilityState){if(this.visibility=!0,this.audio.hasAudio)this.el.currentTime=this.audio.currentTime;else{const e=Math.floor(this.buffered);this.el.currentTime=Math.max(e-1,0)}this.offScreen={start:0,playedTime:0},this.el.paused&&this.el.play(),this.log.debug(`[visibilitychange] currentTime set to ${this.el.currentTime}`)}else this.el.pause(),this.offScreen.start=Date.now(),this.visibility=!1,this.offScreen.playedTime=this.el.currentTime},this.onSBUpdateStart=()=>{},this.onSBUpdateError=e=>{this.log.error(!0,this.el,e)},this.onSBAbort=e=>{this.trackList.forEach(e=>this.removeSourceBuffer(e.type))},this.onSBUpdateEnd=e=>{this.doAppend();const t=this.statusUtil.has(Z.PLAYING);Object.keys(this.sourceBuffer).forEach(e=>{const s=t&&!this.visibility?this.getOffscreenTime():this.el.currentTime,n=Math.max(Math.floor(s)-5,0);this.removeBufferRange(e,0,n,10)})},this.appendSemgemt=e=>{this.pendingSemgemt.push(e),this.buffered=e.endPTS,this.doAppend()},this.initSemgemt=async e=>{this.avParams=this.avParams||{};for(let t in e){const s=t;if(this.sourceBuffer[s])break;const n={...e[s],type:s},{initSegment:i,metadata:r}=n;this.appendSemgemt({type:s,segment:i,startPTS:0,endPTS:0}),this.avParams[s]=r,this.trackList.push(n)}const[t,s]=m();"open"===this.ms.readyState?t[0]():this.ms.onsourceopen=()=>{t[0]()},await s,this.ms.onsourceopen=null,this.createSourceBuffers(this.trackList),this.doAppend()},this.onDownload=(e,t)=>this.contorller.append(e),this.onLoop=(e,t)=>{if(!this.audio.hasAudio)return void(2===this.el.readyState&&(this.el.currentTime=e/1e3));const s=1e3*this.el.currentTime,n=1e3*this.audio.currentTime,i=super.syncContorl(n,s);-1===i?this.el.paused||this.el.pause():0!==i&&(this.el.paused&&this.el.play(),this.el.currentTime=i/1e3,this.lastV=i)},Fe++,this.createMediaElement()}createMediaElement(){const e=document.createElement("video");e.style.width="100%",e.style.height="100%",e.style.objectFit="fill",e.controls=!1,e.muted=!0,e.preload="none",super.bindElement(e),this.mediaAttach(e),this.log.info(!0,"create video tag")}getOffscreenTime(){const{start:e,playedTime:t}=this.offScreen,s=(Date.now()-e)/1e3;return Math.min(t+s,this.buffered)}removeVideo(){this.el&&(this.el.pause(),this.el.removeAttribute("src"),this.el.load())}mediaAttach(e){const t=new MediaSource();t.addEventListener("sourceopen",this.onMediaSourceOpen),t.addEventListener("sourceended",this.onMediaSourceEnded),t.addEventListener("sourceclose",this.onMediaSourceClose),document.addEventListener("visibilitychange",this.visibilityChange),document.addEventListener("unbeforeload",this.removeVideo),this.on("ratechange",e=>{this.el.playbackRate=e}),this.ms=t;const s=URL.createObjectURL(t);e.src=s,e.load(),this.objectUrl=s}mediaDetach(){if(this.ms){try{"open"===this.ms.readyState&&this.ms.endOfStream()}catch(e){this.log.debug(`onMediaDetaching:${e.message} while calling endOfStream`)}this.ms.removeEventListener("sourceopen",this.onMediaSourceOpen),this.ms.removeEventListener("sourceended",this.onMediaSourceEnded),this.ms.removeEventListener("sourceclose",this.onMediaSourceClose)}document.removeEventListener("visibilitychange",this.visibilityChange),this.objectUrl&&(URL.revokeObjectURL(this.objectUrl),this.objectUrl=null),this.removeVideo()}removeSourceBuffer(e){const t=this.sourceBuffer[e];t&&(t.abort(),this.ms.removeSourceBuffer(t),this.sourceBuffer[e]=null,this.log.debug(`[remove sourcebuffer] [${e}]`),t.removeEventListener("updatestart",this.onSBUpdateStart),t.removeEventListener("updateend",this.onSBUpdateEnd),t.removeEventListener("error",this.onSBUpdateError),t.removeEventListener("abort",this.onSBAbort))}removeBufferRange(e,t,s,n=.5){const i=this.sourceBuffer[e];if(!i||i.updating)return!0;try{for(let r=0;r<i.buffered.length;r++){const o=i.buffered.start(r),a=i.buffered.end(r),l=Math.max(o,t),c=Math.min(a,s),h=r===i.buffered.length-1;if(c-l>n&&h||c>l&&!h){const t=this.el.currentTime;return this.log.debug(`[sourcebuffer ${e} buffer remove] [${o}, ${a}], remove [${l}, ${c}] , pos: ${t}`),i.remove(l,c),!0}}}catch(e){this.log.warn(!0,e)}}doAppend(){if(!this.pendingSemgemt.length)return;if(this.el.error)return;const{type:e,segment:t}=this.pendingSemgemt[0],s=this.sourceBuffer[e];if(!s||s.updating)return;try{this.pendingSemgemt.shift(),s.appendBuffer(t)}catch(e){console.error(e)}const n=s.buffered.length;n&&(this.endV=1e3*s.buffered.end(n-1))}createSourceBuffers(e){const{sourceBuffer:t,ms:s}=this;e.forEach(e=>{const{container:n,codec:i,type:r}=e;if(t[r])return;const o=`${n};codecs="${i}"`,a=s.addSourceBuffer(o);a.addEventListener("updatestart",this.onSBUpdateStart),a.addEventListener("updateend",this.onSBUpdateEnd),a.addEventListener("error",this.onSBUpdateError),a.addEventListener("abort",this.onSBAbort),t[r]=a})}async load(){super.load(),await this.loadDownload(),this.status!==Z.DISCARD&&(this.downBufctl.startCheck(),this.statusUtil.contact(Z.LOAD),this.emit("loadedmetadata"),this.on("volumechange",()=>this.audio&&this.audio.setOptions({volume:this._volume})))}async reloadUrl(){this.pause(!1);const e=super.reloadUrl();this.pendingSemgemt=[];const t=this.trackList.map(async({type:e})=>{const[t,s]=m(),n=this.sourceBuffer[e],i=()=>{const s=n.onupdateend;this.removeBufferRange(e,0,1/0),n.onupdateend=()=>{n.onupdateend=s,t[0]()}};return n.updating?n.onupdateend=i:i(),s});await Promise.all(t),await e,this.el.currentTime=0}loadDownload(){super.loadDownload(),this.contorller=new Ie({isLive:this.isLive}),this.downBufctl=new D({unit:"buffer time",minimum:0,maximum:10,getValue:()=>this.buffered-this.el.currentTime,pause:()=>this.download.pause(),resume:()=>this.download.resume(),isDone:()=>this.download.isDone(),destory:()=>this.download.destory()});const[e,t]=m();return this.contorller.on(ke.INIT_SEGMENT,async t=>{await this.initSemgemt(t),e[0]()}),this.audio=new $(null),this.contorller.on(ke.PARSING_DATA,this.appendSemgemt),this.contorller.on(Ee.PCM_INIT,e=>{this.audio.setOptions({...e,volume:this._volume})}),this.contorller.on(Ee.PCM_DATA,e=>{this.audio.append(e),this.endA=e.pts}),t}play(e=!0){return!!super.play(e)&&(this.statusUtil.has(Z.LOADDATA)&&(e&&this.emit("play"),this.downBufctl.startCheck()),this.statusUtil.contact(Z.LOADDATA),this.log.debug("start play"),this._resetAnimate(),"visible"===document.visibilityState?(this.el.play(),this.el.onplaying=()=>{this.el.onplaying=null,this.audio.play(),this._animate()}):(this.visibilityChange(),this._animate(),this.audio.play()),!0)}framePlay(){this.statusUtil.no(Z.FPLAY)&&(this.statusUtil.replace(Z.PLAYING,Z.PAUSE),this.downBufctl.startCheck(),this.el.pause()),this.el.currentTime+=1/this.avParams.video.rate}startRender(){this._resetAnimate(),this._animate()}pauseRender(){this.audio.pause()}pause(e=!0){return!!super.pause(e)&&(this.el.pause(),this.audio.pause(),!0)}destory(){this.mediaDetach(),this.pendingSemgemt=[],this.trackList=[],this.sourceBuffer={},super.destory(),this.log.info(!0,"destroy")}set currentTime(e){this.el.currentTime=e/1e3}get currentTime(){return 1e3*this.el.currentTime}get debugInfo(){const e=this.sourceBuffer.video.buffered,t=[];for(let s=0;s<e.length;s++)t.push(`${e.start(s)}, ${e.end(s)}`);return{"缓存区":t,"视频时间":this.el.currentTime,"音频时间":this.audio.hasAudio?this.audio.currentTime:0,"下载时间":Math.max(this.endV,this.endA)/1e3,"主时钟":this._actualTime/1e3}}}const ze=new l("PlayerManager");class De{constructor(){this.x=0,this.y=0,this.w=0,this.h=0}static create(e,t,s,n){const i=new De();return i.x=e,i.y=t,i.w=s,i.h=n,i}static attach(e){const t=new De();return t.x=e.offsetLeft,t.y=e.offsetTop,t.w=e.offsetWidth,t.h=e.offsetHeight,t}static sizeOf(e){const t=new De();return t.w=e.offsetWidth,t.h=e.offsetHeight,t}static fork(e){const t=new De();return t.x=e.offsetLeft,t.y=e.offsetTop,t.w=e.offsetWidth,t.h=e.offsetHeight,t}static fromPoints(e,t){const[s,n,i,r]=[Math.min(e[0],t[0]),Math.min(e[1],t[1]),Math.max(e[0],t[0]),Math.max(e[1],t[1])];return De.create(s,n,i-s,r-n)}static fromPoint(e,t,s,n="br"){const i=new De();switch(i.x=e[0],i.y=e[1],n){case"br":i.x2=i.x+t,i.y2=i.y+s;break;case"bl":i.x2=i.x-t,i.y2=i.y+s;break;case"tl":i.x2=i.x-t,i.y2=i.y-s;break;case"tr":i.x2=i.x+t,i.y2=i.y-s}return i}set x1(e){this.w=this.x2-e,this.x=e}set y1(e){this.h=this.y2-e,this.y=e}get x2(){return this.x+this.w}set x2(e){this.w=e-this.x}get y2(){return this.y+this.h}set y2(e){this.h=e-this.y}get aspect(){return this.w/this.h}round(){return De.create(Math.round(this.x),Math.round(this.y),Math.round(this.w),Math.round(this.h))}normalize(){const[e,t,s,n]=[Math.min(this.x,this.x2),Math.min(this.y,this.y2),Math.max(this.x,this.x2),Math.max(this.y,this.y2)];return De.create(e,t,s-e,n-t)}rebound(e,t){const s=this.normalize();return s.x<0&&(s.x=0),s.y<0&&(s.y=0),s.x2>e&&(s.x=e-s.w),s.y2>t&&(s.y=t-s.h),s}scale(e,t){return t=t||e,De.create(this.x*e,this.y*t,this.w*e,this.h*t)}unscale(e,t){return t=t||e,De.create(this.x/e,this.y/t,this.w/e,this.h/t)}center(e,t){return De.create((e-this.w)/2,(t-this.h)/2,this.w,this.h)}toArray(){return[this.x,this.y,this.w,this.h]}}class Pe{constructor(e){this.el=void 0,this.el=e}appendTo(e){return e.appendChild(this.el),this}emit(e){const t=document.createEvent("Event");t.initEvent(e,!0,!0),t.cropTarget=this,this.el.dispatchEvent(t)}removeClass(e){return this.el.className=this.el.className.split(" ").filter(t=>e!==t).join(" "),this}hasClass(e){return this.el.className.split(" ").filter(t=>e===t).length}addClass(e){return this.hasClass(e)||(this.el.className+=" "+e),this}listen(e,t){return this.el.addEventListener(e,e=>t(e.cropTarget,e)),this}}function Je(e,t,s,n){let i,r,o,a;function l(s){const n=s instanceof TouchEvent?s.touches[0]:s,{top:l,left:u}=e.getBoundingClientRect();i=n.pageX,r=n.pageY,o=i-e.scrollLeft-u,a=r-e.scrollTop-l,s.preventDefault(),s.stopPropagation(),t(o,a,n)&&("mousedown"===s.type?(window.addEventListener("mousemove",c),document.addEventListener("mouseup",h)):"touchstart"===s.type&&(document.addEventListener("touchmove",c),document.addEventListener("touchend",h)))}function c(e){const t=e instanceof TouchEvent?e.changedTouches[0]:e;e.stopPropagation();const n=t.pageX-i,l=t.pageY-r;s(n+o,l+a,n,l)}function h(e){const t=e instanceof TouchEvent?e.changedTouches[0]:e,l=t.pageX-i,u=t.pageY-r;l&u&&s(l+o,u+a,l,u),document.removeEventListener("mouseup",h),window.removeEventListener("mousemove",c),document.removeEventListener("touchmove",c),document.removeEventListener("touchend",h),n()}return"string"==typeof e&&(e=document.getElementById(e)),e.addEventListener("mousedown",l),e.addEventListener("touchstart",l),{remove:function(){e.removeEventListener("mousedown",l),e.removeEventListener("touchstart",l)}}}class _e extends Pe{static create(e){const t=document.createElement("div");return t.className=e,new _e(t)}}class Be{constructor(e,t,s,n){this.sw=void 0,this.sh=void 0,this.rect=void 0,this.locked=void 0,this.stuck=void 0,this.sw=t,this.sh=s,this.rect=e,this.locked=this.getCornerPoint(this.getOppositeCorner(n)),this.stuck=this.getCornerPoint(n)}static create(e,t,s,n){return new Be(e,t,s,n)}move(e,t){return De.fromPoints(this.locked,this.translateStuckPoint(e,t))}getDragQuadrant(e,t){const s=this.locked[0]-e,n=this.locked[1]-t;return s<0&&n<0?"br":s>=0&&n>=0?"tl":s<0&&n>=0?"tr":"bl"}translateStuckPoint(e,t){const[s,n,i]=this.stuck;var r=null===s?i:s+e,o=null===n?i:n+t;return r>this.sw&&(r=this.sw),o>this.sh&&(o=this.sh),r<0&&(r=0),o<0&&(o=0),[r,o]}getCornerPoint(e){const t=this.rect;switch(e){case"n":return[null,t.y,t.x];case"s":return[null,t.y2,t.x2];case"e":return[t.x2,null,t.y2];case"w":return[t.x,null,t.y];case"se":return[t.x2,t.y2];case"sw":return[t.x,t.y2];case"ne":return[t.x2,t.y];case"nw":return[t.x,t.y]}}getOppositeCorner(e){switch(e){case"n":return"se";case"s":case"e":return"nw";case"w":return"se";case"se":return"nw";case"sw":return"ne";case"ne":return"sw";case"nw":return"se"}}}var He={animateEasingFunction:"swing",animateFrames:30,multi:!1,multiMax:null,multiMin:1,cropperClass:"vcrop-widget",disabledClass:"vcrop-disable",canDrag:!0,canResize:!0,canSelect:!0,canRemove:!0,multiple:!1,autoFront:!0,active:!0,handles:["n","s","e","w","sw","nw","ne","se"],shade:!0,shadeClass:"vcrop-shade",shadeColor:"black",shadeOpacity:.5,widgetConstructor:null,x:0,y:0,w:100,h:100};class Ke extends Pe{constructor(e,t){super(e),this.stage=void 0,this.pos=void 0,this.options=He,this.stage=t,this.pos=De.fork(this.el),this.createMover(),this.createHandles()}static create(e){const t=document.createElement("div");return t.setAttribute("tabindex","0"),t.className="vcrop-widget",new Ke(t,e)}createMover(){let e,t,s;Je(this.el,()=>!!this.stage.enabled&&(e=this.el.parentElement.offsetWidth,t=this.el.parentElement.offsetHeight,s=De.fork(this.el),this.el.focus(),this.stage.activate(this),!0),(n,i,r,o)=>{this.pos.x=s.x+r,this.pos.y=s.y+o,this.render(this.pos.rebound(e,t))},()=>{this.emit("crop.change")})}createHandles(){this.options.handles.forEach(e=>{const t=_e.create("vcrop-handle "+e);let s;t.appendTo(this.el),Je(t.el,()=>{if(!this.stage.enabled)return!1;const t=this.el.parentElement,n=t.offsetWidth,i=t.offsetHeight;return s=Be.create(De.fork(this.el),n,i,e),this.el.focus(),this.emit("crop.active"),!0},(e,t)=>this.render(s.move(e,t)),()=>{this.emit("crop.change")})})}render(e){e=e||this.pos,this.el.style.top=Math.round(e.y)+"px",this.el.style.left=Math.round(e.x)+"px",this.el.style.width=Math.round(e.w)+"px",this.el.style.height=Math.round(e.h)+"px",this.pos=e,this.stage.updateShades()}}class Oe{constructor(e){this.el=void 0,this.keys=["t","l","b","r"],this.shades=null,this.maskSahde=Qe.create("all"),this.el=e}static attach(e){const t=new Oe(e);return t.init(),t}init(){this.shades={},this.keys.forEach(e=>{this.shades[e]=Qe.create(e)})}enable(){this.keys.forEach(e=>this.shades[e].insert(this.el))}disable(){this.keys.forEach(e=>this.shades[e].remove())}adjust(e){const t=De.fork(this.el),s=this.shades;s.t.h=e.y,s.b.h=t.h-e.y2,s.t.w=s.b.w=Math.floor(e.w),s.l.w=s.t.x=s.b.x=Math.ceil(e.x),s.r.w=t.w-(Math.ceil(e.x)+Math.floor(e.w))}enableMask(){this.maskSahde.w=this.el.offsetWidth,this.maskSahde.h=this.el.offsetHeight,this.maskSahde.x=0,this.maskSahde.insert(this.el)}disableMask(){this.maskSahde.remove()}}class Qe{constructor(e){this.el=void 0,this.el=e}static create(e){const t=document.createElement("div");return t.className=`vcrop-shade ${e}`,new Qe(t).color("#000").opacity("0.6")}insert(e){e.appendChild(this.el)}remove(){this.el.remove()}set w(e){this.el.style.width=e+"px"}set h(e){this.el.style.height=e+"px"}set x(e){this.el.style.left=e+"px"}color(e){return e&&(this.el.style.backgroundColor=e),this}opacity(e){return e&&(this.el.style.opacity=e),this}}class je extends Pe{constructor(e,t){super(e),this.options=void 0,this.enabled=!0,this.shapesManager=void 0,this.widgets=new Set(),this.active=void 0,this.options={...He,...t},this.initDrag(),this.shapesManager=Oe.attach(this.el),this.shapesManager.enableMask()}canCreate(){return!!this.enabled&&(!!this.options.multi||!(this.widgets.size>=1))}initDrag(){let e,t,s;Je(this.el,(n,i,r)=>{if(!this.canCreate())return!1;e=Ke.create(this),t=e.pos,t.x=n,t.y=i;const{offsetWidth:o,offsetHeight:a}=this.el;return s=Be.create(t,o,a,"se"),this.addWidget(e),e.render(t),!0},(t,n,i,r)=>{e.render(s.move(i,r))},()=>{this.active.emit("crop.change")})}updateShades(){this.active&&this.shapesManager.adjust(this.active.pos)}refresh(){this.widgets.forEach(e=>{e.render()})}reorderWidgets(){var e=10;this.widgets.forEach(t=>{t.el.style.zIndex=`${e++}`,this.active===t?t.addClass("active"):t.removeClass("active")}),this.refresh()}activate(e){if(!this.enabled)return this;if(e=e||Array.from(this.widgets).pop()){if(this.active===e)return;this.active=e,this.widgets.delete(e),this.widgets.add(e),this.reorderWidgets(),this.active.el.focus(),this.shapesManager.enable(),this.shapesManager.disableMask(),e.emit("crop.activate")}else this.shapesManager.disable();return this}addWidget(e){return e.appendTo(this.el),this.activate(e),this.emit("new widget"),this}newWidget(e,t={}){const s=Ke.create(this);return s.render(e),this.addWidget(s),s.el.focus(),s}startDrag(){}}s(".vcrop-widget .vcrop-handle {\n  display: none;\n  position: absolute;\n  border: 1px rgba(127, 127, 127, 0.8) solid;\n  width: 10px;\n  height: 10px;\n  box-sizing: border-box;\n  background: rgba(255, 255, 255, 0.8);\n}\n.vcrop-widget .vcrop-handle.nw {\n  top: -3px;\n  left: -3px;\n  cursor: nwse-resize;\n}\n.vcrop-widget .vcrop-handle.w {\n  top: 50%;\n  transform: translateY(-50%);\n  left: -3px;\n  cursor: ew-resize;\n}\n.vcrop-widget .vcrop-handle.sw {\n  bottom: -3px;\n  left: -3px;\n  cursor: nesw-resize;\n}\n.vcrop-widget .vcrop-handle.ne {\n  top: -3px;\n  right: -3px;\n  cursor: nesw-resize;\n}\n.vcrop-widget .vcrop-handle.e {\n  top: 50%;\n  transform: translateY(-50%);\n  right: -3px;\n  cursor: ew-resize;\n}\n.vcrop-widget .vcrop-handle.se {\n  bottom: -3px;\n  right: -3px;\n  cursor: nwse-resize;\n}\n.vcrop-widget .vcrop-handle.n {\n  left: 50%;\n  transform: translateX(-50%);\n  top: -3px;\n  cursor: ns-resize;\n}\n.vcrop-widget .vcrop-handle.s {\n  left: 50%;\n  transform: translateX(-50%);\n  bottom: -3px;\n  cursor: ns-resize;\n}\n.vcrop-widget.active .vcrop-handle {\n  display: block;\n}\n.vcrop-widget {\n  position: absolute;\n  box-sizing: border-box;\n  border: 1px white dashed;\n  opacity: 0.7;\n  background: transparent;\n  transition: opacity 1s;\n  padding: 0;\n  margin: 0;\n  cursor: move;\n}\n.vcrop-widget:hover {\n  transition: opacity 0.8s;\n  opacity: 0.8;\n}\n.vcrop-widget:focus {\n  transition: opacity 0.5s;\n  opacity: 1;\n  outline-style: auto;\n  outline-width: 3px;\n  outline-color: rgba(0, 0, 0, 0.3);\n}\n.vcrop-shade {\n  background: rgba(0, 0, 0, 0.5);\n  transition: opacity 0.4s, background-color 0.7s;\n  position: absolute;\n}\n.vcrop-shade.l {\n  top: 0px;\n  left: 0px;\n  height: 100%;\n}\n.vcrop-shade.r {\n  top: 0px;\n  right: 0px;\n  height: 100%;\n}\n.vcrop-shade.t {\n  top: 0px;\n}\n.vcrop-shade.b {\n  bottom: 0px;\n}\n.vcrop-stage {\n  position: absolute;\n  width: 100%;\n}\n.vcrop-image-stage img {\n  position: absolute;\n  z-index: -1;\n}\n.vcrop-ux-inactive-handles .vcrop-widget .vcrop-handle {\n  display: block;\n}\n.vcrop-widget img {\n  width: 100%;\n  height: auto;\n}\n.vcrop-ux-fade-more .vcrop-widget {\n  opacity: 0.25;\n}\n.vcrop-ux-fade-more .vcrop-widget:hover {\n  transition: opacity 0.4s;\n  opacity: 0.8;\n}\n.vcrop-ux-fade-more .vcrop-widget:focus {\n  transition: opacity 0.5s;\n  opacity: 1;\n  outline-style: auto;\n  outline-width: 3px;\n  outline-color: rgba(0, 0, 0, 0.3);\n}\n.vcrop-ux-fade-more .vcrop-widget {\n  opacity: 0.25;\n}\n.vcrop-ux-fade-more .vcrop-widget:hover {\n  opacity: 0.65;\n}\n.vcrop-ux-keep-current .vcrop-widget.active {\n  opacity: 1;\n  outline-style: auto;\n  outline-width: 3px;\n  outline-color: rgba(0, 0, 0, 0.3);\n}\n.vcrop-ux-no-outline .vcrop-widget {\n  outline: none !important;\n}\n.vcrop-disable.vcrop-stage {\n  opacity: 0.8;\n}\n.vcrop-disable.vcrop-stage .vcrop-widget {\n  outline: none !important;\n}\n");var $e={attach:function(e,t){return new je(e,t)},Rect:De};class qe{constructor(e,t,s){this.canvas=void 0,this.ctx=void 0,this.video=void 0,this.parent=void 0,this.container=void 0,this.video=e,this.parent=t,this.container=s}getSize(e=this.video){let t=e.width,s=e.height;e instanceof HTMLVideoElement&&(t=e.videoWidth,s=e.videoHeight);const{width:n,height:i}=e.getBoundingClientRect();return{width:t,height:s,w:n,h:i}}initCanvas(){const e=document.createElement("canvas"),t=e.getContext("2d");e.className="player-center";const{width:s,height:n,w:i,h:r}=this.getSize(this.video);e.width=s,e.height=n,e.style.width=i+"px",e.style.height=r+"px",this.parent.appendChild(e),this.canvas=e,this.ctx=t}drawCanvas(e){const{width:t,height:s}=this.getSize(e);this.ctx.drawImage(e,0,0,t,s,0,0,t,s)}destory(){}capture(e,t=this.video,s=!0){let n,i,r,o,a=0,l=0;e?({x:a,y:l,width:r,height:o,w:n,h:i}=e):({width:r,height:o,w:n,h:i}=this.getSize(t));let c=r,h=o;s&&(c=n,h=i);const u=document.createElement("canvas"),d=u.getContext("2d");return u.width=c,u.height=h,d.drawImage(t,a,l,r,o,0,0,c,h),u.toDataURL()}screenshot(e){this.initCanvas(),this.drawCanvas(this.video);const{width:t,height:s,w:n,h:i}=this.getSize(this.video),r=document.createElement("div");r.className="player-center",r.style.width=n+"px",r.style.height=i+"px",this.parent.appendChild(r);const o=t/n,a=$e.attach(r,{multi:!1});a.listen("new widget",()=>{const t=Array.from(a.widgets)[0];t.listen("crop.change",()=>{const{x:s,y:n,w:i,h:r}=t.pos;e&&e(t.el,{x:s,y:n,w:i,h:r})})});const l=i,c=n;return{getScreenshot:e=>{const t=Array.from(a.widgets)[0];if(!t)return null;const{x:s,y:n,w:i,h:r}=t.pos,h={x:s*o,y:n*o,width:i*o,height:r*o,w:i,h:r},u=this.capture(h,this.canvas,e),d=this.container.getBoundingClientRect();return{dataUrl:u,pos:{x:(d.width-c)/2+s,y:(d.height-l)/2+n,w:i,h:r}}},remove:()=>{r.remove(),this.canvas.remove()}}}path(e,t,s,n){const i=this.ctx;i.beginPath(),i.moveTo(e,25)}stroke(){this.ctx.stroke()}fill(){this.ctx.fill()}}function et(e){const{type:t,roate:s,...i}=e;return n.createElement("i",i,n.createElement("svg",{className:`icon${s?" icon-roate":""}`,"aria-hidden":"true"},n.createElement("use",{xlinkHref:`#icon${t}`})))}s(".player {\n  display: inline-block;\n  height: 100%;\n  width: 100%;\n  min-width: 100px;\n  min-height: 100%;\n  color: #ddd;\n  position: relative;\n}\n.player * {\n  margin: 0;\n  padding: 0;\n  font-size: 16px;\n  box-sizing: border-box;\n  user-select: none;\n}\n.player .icon {\n  width: 1em;\n  height: 1em;\n  vertical-align: 0em;\n  fill: currentColor;\n  overflow: hidden;\n}\n.player .icon-roate {\n  animation: loadingCircle 1s infinite linear;\n}\n.player .info {\n  display: inline-block;\n  vertical-align: bottom;\n}\n.player-container {\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  height: 100%;\n  background: #000;\n}\n.player-video-warp {\n  position: relative;\n  flex: 1;\n  width: 100%;\n}\n.player-video-instance {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n}\n.player-video-state {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n}\n.player-video-state-loading {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  height: 2em;\n  width: 2em;\n  border-radius: 5%;\n  background-color: rgba(0, 0, 0, 0.5);\n}\n.player-video-state .icon {\n  height: 2em;\n  width: 2em;\n}\n.player-video-infos {\n  position: absolute;\n  padding-right: 20px;\n  bottom: 10px;\n  background-color: #ddd;\n  color: #000;\n  min-width: 100px;\n}\n.player-video-bottom {\n  width: 100%;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  transition: height 0.5s;\n  overflow: hidden;\n}\n.player-video-btnWrap {\n  position: absolute;\n  left: 0;\n  bottom: 4px;\n  display: flex;\n  z-index: 1;\n}\n.player-video-btnWrap-btn {\n  width: 20px;\n  height: 16px;\n  align-items: center;\n  cursor: pointer;\n}\n.player-video-progress {\n  position: relative;\n  overflow: hidden;\n  height: 6.5em;\n  background: rgba(0, 0, 0, 0.5);\n}\n.player-video-progress-speed {\n  height: 30px;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n}\n.player-video-progress-speed-wrap {\n  width: 100px;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n}\n.player-video-progress-speed-wrap span {\n  display: inline-block;\n  width: 30px;\n  color: #ffffff;\n  font-size: 12px;\n  line-height: 30px;\n  text-align: center;\n}\n.player-video-progress-bar-time {\n  position: relative;\n  height: 30px;\n  display: flex;\n  flex-direction: row;\n}\n.player-video-progress-bar-time-wrap {\n  position: relative;\n  top: 20px;\n  flex: 1;\n  height: 0.5em;\n  border-bottom: 1px solid #0a92e2;\n}\n.player-video-progress-icon {\n  display: inline-block;\n  width: 30px;\n  height: 20px;\n  color: #ffffff;\n  text-align: center;\n  cursor: pointer;\n}\n.player-video-progress .time-icon:first-of-type {\n  text-align: left;\n  padding-top: 5px;\n}\n.player-video-progress .time-icon:last-of-type {\n  padding-top: 5px;\n  text-align: right;\n}\n.player-video-progress-bar-timetext {\n  position: absolute;\n  left: 0px;\n  right: -1px;\n  top: 0px;\n  height: 30px;\n  overflow: hidden;\n}\n.player-video-progress-bar-timetext-div {\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n.player-video-progress-bar-timetext span {\n  position: absolute;\n  top: 0px;\n  color: #ffffff;\n  font-size: 12px;\n  text-indent: -15px;\n}\n.player-video-progress-bar-timetext span::before {\n  content: '';\n  position: absolute;\n  left: 0;\n  bottom: -11px;\n  width: 1px;\n  height: 5px;\n  background-color: #0a92e2;\n}\n.player-video-progress-bar-timetext span:first-of-type {\n  text-indent: -10px;\n}\n.player-video-progress-bar-timetext span:last-of-type {\n  text-indent: -20px;\n}\n.player-video-progress-bar-timetext span:last-of-type::before {\n  left: -1px;\n}\n.player-video-progress-video-track {\n  position: relative;\n  margin: 10px 0px;\n  height: 0.5em;\n}\n.player-video-progress-bar,\n.player-video-progress-bar-warp {\n  position: absolute;\n  left: 0px;\n  top: 0px;\n  right: 0px;\n  height: 0.5em;\n  overflow: hidden;\n}\n.player-video-progress-bar {\n  background-color: hsla(0, 0%, 100%, 0.2);\n  transform-origin: 0 0;\n  transition: transform 0.2s;\n}\n.player-video-progress-bar-normal {\n  background-color: red;\n}\n.player-video-progress-bar-files {\n  position: relative;\n  height: 10px;\n}\n.player-video-progress-bar-files p {\n  position: absolute;\n  top: 0;\n  height: 10px;\n  background-color: #0a92e2;\n}\n.player-video-progress-scroll {\n  margin: 10px 30px;\n  height: 0.5em;\n  background-color: hsla(0, 0%, 100%, 0.2);\n}\n.player-video-progress-scroll-bar {\n  position: relative;\n  left: 0;\n  height: 0.5em;\n  background-color: hsla(0, 0%, 100%, 0.5);\n  border-radius: 0.5em;\n  transform-origin: left;\n}\n.player-video-progress-title {\n  position: absolute;\n  background-color: #ffffff;\n  width: 140px;\n  line-height: 20px;\n  border-radius: 3px;\n  text-align: center;\n  z-index: 2;\n  font-size: 12px;\n  color: #333333;\n}\n.player-video-progress-pos {\n  display: inline-block;\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  width: 2px;\n  height: 15px;\n  background-color: red;\n}\n.player-video-controls {\n  position: absolute;\n  left: 0;\n  right: 0;\n}\n.player-video-controls-left,\n.player-video-controls-right {\n  flex: 1;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  height: 32px;\n}\n.player-video-controls-right {\n  place-content: flex-end;\n}\n.player-video-controls-btn {\n  display: inline-flex;\n  align-items: center;\n  margin: 0 5px;\n  height: 24px;\n  cursor: pointer;\n  z-index: 10;\n}\n.player-video-controls-volume {\n  z-index: 10;\n  transition: width 0.3s ease 0s, opacity 0.28s step-end 0s;\n  height: 4px;\n  cursor: pointer;\n  -webkit-tap-highlight-color: transparent;\n  box-sizing: unset !important;\n  margin: 0px;\n  padding: 22px 0px;\n  background: transparent;\n}\n.player-center {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n}\n@keyframes loadingCircle {\n  100% {\n    transform: rotate(360deg);\n  }\n}\n");const tt={rtsp:"ws",rtmp:"ws",default:"http"},st=Object.keys(tt);function nt(e,t){const s=st.find(t=>e.startsWith(t))||"default",n=tt[s];return"ws"===n&&(e=`ws://${t||"127.0.0.1:19060"}/URL/`+e),{url:e,type:n}}var it=n.forwardRef((function(e,s){const[i,r]=t.useState(!0),[o,a]=t.useState(null),l=t.useRef(!1),c=t.useRef(null),h=t.useRef(null),u=t.useRef(null),d=t.useRef(null),p=t.useRef(null),f=t.useRef(!1);function y(e,t=!0){if(s){const n=Object.create(e),i={play:g,pause:Z,seek:R,capture:x,screenshot:V,showMessage:G,fullScreen:L,exitFullScreen:S,resize:b,playTime:0};Object.keys(i).forEach(e=>{n[e]=i[e]}),s.current=new Proxy(n,{set:(t,s,n)=>(t.hasOwnProperty(s)?t[s]=n:e[s]=n,!0)}),t&&e.copyEvent(p.current)}}function b(){if(d.current===p.current)return;const{avParams:e}=d.current;if(!e)return;const{width:t,height:s}=e.video,{width:n,height:i}=h.current.getBoundingClientRect(),r=Math.floor(1e4*Math.min(n/t,i/s))/1e4;d.current.setSize(r*t,r*s,t,s)}function g(){l.current=!0,d.current&&d.current.play()}function Z(){l.current=!1,d.current&&d.current.pause()}function R(t){const s=d.current;s.seek(async()=>{const n=await t();s.url=nt(n,e.host).url})}t.useEffect(()=>()=>f.current=!0,[]),t.useEffect(()=>{if(!e.url)return;const{type:t,url:n}=nt(e.url,e.host);return r(!0),async function(e,t){ze.warn(!1,"当前总播放数0, 推荐播放数16");const s=v.create({url:e.url,type:e.type}),n={download:s,...e},[i,r]=m();let o=null;s.onDownBuffer=e=>{o=e,Ye.probe(e)?i[0](new Ye(n)):i[0](new te(n))};try{await s.open()}catch(e){t.onDownloadErr(s.error),i[1](e)}const a=await r;return a.onPreloadBuffer(o),a}({el:u.current,url:n,type:t,isLive:e.isLive},p.current).then(t=>{p.current.disable(),d.current=t,y(t),t.load().then(()=>{(e.autoplay||l.current)&&g(),b(),t.shouldRender=e.shouldRender})}).catch(e=>console.error(e)),()=>{if(d.current.destory(),f.current){if(p.current.destory(),!s)return;s.current!==p.current&&s.current!==d.current||(s.current=null)}else s&&(y(p.current,!1),p.current.disable(!1))}},[e.url]);const x=e=>{const t=d.current;return new qe(t.el,h.current,c.current).capture(e)},V=e=>{const t=d.current;return new qe(t.el,h.current,c.current).screenshot(e)},G=e=>{e||a(e),d.current.onerror(e)},L=e=>{c.current.requestFullscreen(),c.current.onfullscreenchange=t=>{document.fullscreenElement===t.target?(b(),removeEventListener("resize",b),addEventListener("resize",b)):(c.current.onfullscreenchange=null,removeEventListener("resize",b),e&&e())}},S=()=>{document.exitFullscreen()};if(!d.current){const e=new w({},"EmtpyPlayer");!function(e){e.on(["waiting","seeking"],(function(){r(!0)})),e.on(["loadedmetadata","playing","destory"],(function(){r(!1)})),e.on("error",e=>{r(!1),a(e),d.current!==p.current&&d.current.destory()}),e.on("timeupdate",e=>{R(e)})}(e),p.current=e,d.current=e,s&&y(e,!1)}return n.createElement("div",{className:"player",style:e.style,ref:c},n.createElement("div",{className:"player-container"},n.createElement("div",{className:"player-video-warp",ref:h},n.createElement("div",{className:"player-video-instance",ref:u}),n.createElement("div",{className:"player-center",style:{width:"100%",height:"100%"}}),o?n.createElement("span",{className:"player-center"},o):null,n.createElement("div",{className:"player-video-state"},i?n.createElement("div",{className:"player-video-state-loading"},n.createElement(et,{type:"loading",roate:!0})):null),n.createElement("div",{className:"player-video-infos",style:{zIndex:100,display:"block"}},null)),e.children))}));async function rt(e,t,s=6e4){return e="/api/vms/v1/webuas/device"+e,new Promise((s,n)=>{fetch(e,t).then(e=>{if(e.ok)return e.json()}).then(e=>{e.error_code?n({code:e.error_code,message:e.description||e.message}):s(e.data)}).catch(e=>e)})}rt.get=(e,t,...s)=>rt(function(e,t){if(!t)return"";const s=Object.keys(t).map((e,s)=>`${e}=${t[e]}`);return`${e}${s.length?`?${s.join("&")}`:""}`}(e,t),{headers:{Accept:"application/json"}},...s),["POST","PUT","DELETE"].forEach(e=>{rt[e.toLowerCase()]=(t,s,...n)=>rt(t,{method:e,headers:{Accept:"application/json","Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(s)},...n)});const ot=rt;function at(e,s,n){const i=t.useRef(!1),[r,o]=t.useState(!1),a=t.useRef(null),l=t.useRef(null);t.useEffect(()=>{const t=e.playerRef.current,i=t.on("play",()=>a.current()),r=t.on("pause",()=>{o(!1),l.current(),n()}),c=t.on("playing",e=>{"waiting"!==e&&(o(!0),s())});return()=>{n(),i(),c(),r()}},[]);const c=t.useCallback(()=>{o(!1);const t=e.playerRef.current,{download:s}=t;s.onpause=()=>l.current(),s.onresume=()=>a.current(),t.once("playing",e=>{"waiting"!==e&&(i.current=!1,s.onpause=null,s.onresume=null)}),t.once("pause",()=>{i.current=!1,s.onpause=null,s.onresume=null})},[]);return a.current=t.useCallback(()=>{const{camera_id:t,source_type:s,id:n}=e;var i;i={camera_id:t,source_type:s,id:n},ot.get("/video/record/replay-resume",i)},[e.camera_id,e.id]),l.current=t.useCallback(()=>{const{camera_id:t,source_type:s,id:n}=e;var i;i={camera_id:t,source_type:s,id:n},ot.get("/video/record/replay-pause",i)},[e.camera_id,e.id]),{isPlaying:r,framePlay:function(){const t=e.playerRef.current;i.current||(i.current=!0,c()),t.framePlay()}}}function lt(e){return new Date(e).getTime()/1e3}function ct(e){const t=parseInt(`${e}`),s=parseInt(`${t/3600}`),n=parseInt(`${(t-60*s*60)/60}`),i=t-60*s*60-60*n;return`${s<10?"0"+s:s}:${n<10?"0"+n:n}:${i<10?"0"+i:i}`}function ht(e){const t=new Date(e),s=t.getFullYear(),n=t.getMonth()+1,i=t.getDate();return`${s}-${n<10?"0"+n:n}-${i<10?"0"+i:i}`}function ut(e,s){const[n,i]=t.useState(0),r=t.useRef({interval:0}),o=t.useRef(null);function a(){if(!e.fileData.length)return;const t=e.playerRef.current,{start_time:n}=e,{startTime:r,playTime:o}=function(e,t){const s=e.fileData,n=e.playerRef.current;let i,r,o=Math.round(n.currentTime/1e3);t.current&&(i=lt(t.current));for(let e=0;e<s.length;e++){const t=e===s.length-1,a=s[e];if(r=lt(a.end_time),i>r)continue;i<lt(a.start_time)&&(i=lt(a.start_time));const l=r-i;if(o<=l&&!t)break;o>=l&&!t?o-=l:t&&l<=o+1&&(n.currentTime===n.endV||n.currentTime===n.endA)&&n.pause()}return{startTime:i,playTime:o}}(e,s),a=lt(new Date(n).setHours(0,0,0,0));i(r-a+o),t.playTime=1e3*r+1e3*o}function l(){clearInterval(r.current.interval)}return(t.useEffect(()=>{o.current=a},[e.fileData]),{realPlayTime:n,updateTime:function(){l(),r.current.interval=window.setInterval(()=>{o.current()},1e3)},cancelTime:l})}const dt=["1/16","1/8","1/4","1/2","1","2","4","8","16"],pt=[-4,-3,-2,-1,0,1,2,3,4];function mt(e){const[s,i]=t.useState(dt[4]),r=t.useRef(null);function o(t){let n=dt.findIndex(e=>e===s);if(t?n+=1:n-=1,n>=dt.length||n<0)return;i(dt[n]);const r=pt[n];e.playerRef.current.playbackRate=r<0?1/(1<<-r):1<<r}t.useEffect(()=>{const t=dt.findIndex(e=>e===s);return-1!==t&&(clearTimeout(r.current),r.current=self.setTimeout(()=>{!function(t){const{id:s,camera_id:n,source_type:i}=e;if(!s)return;r={camera_id:n,source_type:i,id:s,speed:t},ot.get("/video/record/replay-speed",r);var r}(pt[t])},300)),()=>clearTimeout(r.current)},[s]);const a=n.createElement(n.Fragment,null,n.createElement(et,{className:"player-video-progress-icon",type:"left",onClick:()=>o(!1)}),n.createElement("span",null,s,"x"),n.createElement(et,{className:"player-video-progress-icon",type:"right",onClick:()=>o(!0)}));return{setSpeed:i,speedJsx:a}}function ft(e,s,i,r){const[o,a]=t.useState(!1),l=t.useRef(null);return t.useEffect(()=>{const{start_time:t}=e;let n,o;function c(e,t,s){const n=l.current;n.style.left=`${e}px`,n.style.top=`${t+40}px`,n.innerHTML=s}function h(e){return`${ht(t)} ${ct(1e4*e/r)}`}const{remove:u}=function(e,t,s,n){let i,r;function o(s){const n=s.target.offsetLeft;i=s.offsetX,r=s.offsetY,s.preventDefault(),s.stopPropagation(),t(i,r,n)&&"mouseenter"===s.type&&(e.addEventListener("mousemove",a),e.addEventListener("mouseleave",l))}function a(e){e.preventDefault(),e.stopPropagation();const t=e.target.offsetLeft;let n=e.offsetX-i;const o=e.offsetY-r;t>0&&(n+=t),s(n,o,n+i)}function l(t){const o=t.target.offsetLeft;let c=t.offsetX-i;const h=t.offsetY-r;o>0&&(c+=o),c&h&&s(c,h,c+i),e.removeEventListener("mouseleave",l),e.removeEventListener("mousemove",a),n()}return"string"==typeof e&&(e=document.getElementById(e)),e.addEventListener("mouseenter",o),{remove:function(){e.removeEventListener("mousemove",o)}}}(s.current,(e,t,s)=>{a(!0),n=i.current.offsetWidth;let r=e;return s<0&&(r=e+s),n-r<140&&(r=n-140),c(r,t,h(e)),o=l.current.offsetLeft,!0},(e,t,s)=>{let i=o+e;n-i<140&&(i=n-140),c(i,t,h(s))},()=>{a(!1)});return()=>u()},[r]),n.createElement("div",{ref:l,style:{display:o?"block":"none"},className:"player-video-progress-title"})}function yt(e,s,i,r){const[o,a]=t.useState(!1),l=t.useRef(null),c=t.useRef(null),h=t.useRef(null),u=t.useRef(null),d=t.useRef(""),{totalLength:p}=i.current;return t.useEffect(()=>{e.playerRef.current.on("seeking",()=>{const{left:e,times:t}=u.current;h.current.style.left=e+"px",r(t)})},[]),t.useEffect(()=>{const{fileData:t,start_time:i}=e;0!==t.length&&(c.current=t.map(t=>{const r=lt(new Date(i).setHours(0,0,0,0)),o=lt(t.start_time),a=lt(t.end_time);let l=Math.round(s*(o-r)/1e4),c=Math.round((a-o)*s/1e4);return n.createElement("p",{style:{left:`${l}px`,width:`${c}px`},key:t.file_name,onDoubleClick:t=>function(t,n){const{start_time:i}=e,r=t.nativeEvent.layerX+n,o=`${ht(i)} ${ct(1e4*r/s)}`;u.current={left:r,times:o},e.seekCallback&&e.seekCallback(o)}(t,l)})}))},[e.fileData,s]),t.useEffect(()=>{!function(){const{fileData:t}=e;if(0===t.length)return void(d.current="");const n=t[0].start_time;d.current=n;const i=lt(new Date(n).setHours(0,0,0,0)),r=lt(n),o=parseInt(`${s/1e4*(r-i)}`);h.current.style.left=`${o}px`,a(!0)}()},[e.fileData]),{videoTrack:n.createElement("div",{className:"player-video-progress-video-track"},n.createElement("div",{className:"player-video-progress-bar-warp"},n.createElement("div",{className:"player-video-progress-bar player-video-progress-bar-buffer",style:{transform:"scaleX()"}},n.createElement("div",{className:"player-video-progress-bar-files",ref:l,style:{width:`${p}px`}},c.current,n.createElement("i",{style:{display:o?"block":"none"},className:"player-video-progress-pos",ref:h}))))),beginTime:d,filesRef:l,positionRef:h}}const bt=[1,2,3,4,5,6,8,10,12,15,20,24,30,40,60,120];function gt(e){const[s,n]=t.useState([]);return t.useEffect(()=>{const t=function(){let t=["0:00"];return t=function e(t,s,n){if(t<=0)return n;const i=t-s;let r=i/60+"";r=parseInt(r)<10?`0${parseInt(r)}`:parseInt(r)+"";const o=i%60<10?`0${i%60}`:i%60;return n.push(`${r}:${o}`),e(i,s,n)}(1440,e,t),t}();n([...t.reverse()])},[e]),s}function vt(e){const[s,n]=t.useState({counts:120,leftPos:0,initCount:120});return t.useEffect(()=>{const{remove:t}=function(e,t,s,n){function i(s){s.preventDefault(),s.stopPropagation(),t(s)&&"mouseenter"===s.type&&(e.addEventListener("mousewheel",r),e.addEventListener("mouseleave",o))}function r(e){e.stopPropagation(),e.preventDefault(),s(e.deltaY,e.clientX)}function o(t){e.removeEventListener("mouseleave",o),e.removeEventListener("mousewheel",r),n()}return"string"==typeof e&&(e=document.getElementById(e)),e.addEventListener("mouseenter",i),{remove:function(){e.removeEventListener("mousewheel",i)}}}(e.current,e=>!0,(t,s)=>{n(n=>{const{x:i}=e.current.getBoundingClientRect(),r=n.counts,o=bt.findIndex(e=>e===120/r);let a=n.counts;return t>0?o>0&&(a=120/bt[o-1]):o<bt.length-1&&(a=120/bt[o+1]),{...n,counts:a,leftPos:s-i,initCount:r}})},()=>{});return()=>t()},[]),s}function Zt(e){const s=t.useRef(null),i=t.useRef(null),r=t.useRef(null),o=t.useRef(12),a=t.useRef(0),l=t.useRef({leftPos:0,beforeCount:0}),c=function(e){const[s,n]=t.useState(null);function i(){const t=e.current.offsetWidth/12;n(t)}return t.useEffect(()=>(i(),window.addEventListener("resize",i),()=>removeEventListener("resize",i)),[]),s}(i),{counts:h,leftPos:u,initCount:d}=vt(e),p=gt(h);a.current=1e4*c/(60*h);const m=t.useRef({secondsWidth:a.current,counts:12,totalLength:12*c});return t.useEffect(()=>{o.current=1440/h,l.current={...l.current,leftPos:u,beforeCount:d}},[h]),t.useEffect(()=>{},[c]),t.useEffect(()=>{m.current={secondsWidth:a.current,counts:1440/h,totalLength:1440/h*c}},[h,c]),{ruleRef:r,rulejsx:n.createElement("div",{className:"player-video-progress-bar-time",ref:s},n.createElement("div",{className:"player-video-progress-bar-time-wrap",ref:i}),n.createElement("div",{className:"player-video-progress-bar-timetext"},n.createElement("div",{ref:r,className:"player-video-progress-bar-timetext-div",style:{width:`${c*(p.length-1)}px`}},p.map((e,t)=>n.createElement("span",{key:t,style:{left:`${t*c}px`}},e))))),ruleApiRef:m,baseWidth:c,secondsWidth:a.current,ruleLengthRef:o,ruleCount:h,leftRef:l}}function Rt(e){const s=t.useRef(null),i=t.useRef(null),r=t.useRef(null),o=t.useRef(null),{ruleRef:a,rulejsx:l,baseWidth:c,secondsWidth:h,ruleLengthRef:u,ruleCount:d,leftRef:p,ruleApiRef:m}=Zt(o),{filesRef:f,videoTrack:y,beginTime:b,positionRef:g}=yt(e,h,m,(function(t){1!==e.playerRef.current.playbackRate&&(w("1"),e.playerRef.current.playbackRate=1);b.current=t})),{realPlayTime:v,updateTime:Z,cancelTime:R}=ut(e,b),{setSpeed:w,speedJsx:x}=mt(e),V=ft(e,f,s,h),{isPlaying:G,framePlay:L}=at(e,Z,R);function S(){const e=r.current.offsetWidth,t=u.current,s=12/t;i.current.style.width=s&&`${s*e}px`;const{offsetWidth:n}=i.current,o=e-n;return o?(t*c-e)/o:1}function W(){const e=r.current.offsetWidth,{leftPos:t,beforeCount:s}=p.current,n=-a.current.offsetLeft,i=u.current;let o=1;if(!d||s===d)return;o=s/d;let l=(t+n)*o-t;return l<0&&(l=0),l>i*c-e&&(l=i*c-e),{eventLeft:l,scale:o}}function X(e){const t=g.current,s=t.offsetLeft;t.style.left=`${s*e}px`}return t.useEffect(()=>{const e=parseInt(`${h*v/1e4}`);g.current.style.left=`${e}px`},[v]),t.useEffect(()=>{let e,t,n,o,l,c;const{remove:h}=Je(i.current,(a,h,d)=>(n=r.current.offsetWidth,t=i.current.offsetLeft-30,e=i.current.offsetWidth,o=u.current,l=(s.current.offsetWidth-60)/12,c=(o*l-n)/(n-e),!0),(s,r,o,l)=>{if(o){let s=t+o;s>n-e&&(s=n-e),s<0&&(s=0),a.current.style.left=`${-s*c}px`,f.current.style.left=`${n/e*-s}px`,i.current.style.left=`${s}px`}},()=>{});return()=>h()},[]),t.useEffect(()=>{const e=S();if(W()){const{eventLeft:t,scale:s}=W();!function(e,t){a.current.style.left=`${-e}px`,i.current.style.left=1!==t?`${e/t}px`:"0px",f.current.style.left=`${-e}px`}(t,e),X(s)}},[d]),t.useEffect(()=>{const e=S();!function(e,t){i.current.style.left=`${e}px`,f.current.style.left=`${-e*t}px`,a.current.style.left=`${-e*t}px`}(function(){const e=r.current.offsetWidth,{offsetWidth:t,offsetLeft:s}=i.current,n=e-t;let o=1,a=s-30;o=document.fullscreenElement?e/t:t/e;return a*=o,a=Math.min(a,n),a=Math.max(a,0),a}(),e),X(e)},[c]),n.createElement("div",{className:"player-video-progress",ref:s},n.createElement("div",{className:"player-video-progress-speed"},n.createElement("div",{className:"player-video-progress-speed-wrap"},x),G?n.createElement(et,{className:"player-video-progress-icon",type:"pause",title:"播放",onClick:function(){e.playerRef.current.pause()}}):n.createElement(et,{className:"player-video-progress-icon",type:"play",title:"暂停",onClick:function(){e.playerRef.current.play()}}),n.createElement(et,{className:"player-video-progress-icon",type:"singleframe",title:"单帧播放",onClick:L})),n.createElement("div",{ref:o,style:{margin:"0 30px"}},l,y),n.createElement("div",{className:"player-video-progress-scroll",ref:r,style:{width:`${12*c}px`}},n.createElement("div",{ref:i,className:"player-video-progress-scroll-bar"})),V)}function wt(e){const[s,i]=t.useState(!1),r=function(e){const[s,i]=t.useState(!0),[r,o]=t.useState(0),[a,l]=t.useState(s),c=t.useRef(0),h=t.useRef(0),u=t.useRef(0),d=t.useRef(0);function p(){i(e=>{const t=!e;return t&&0!==h.current?o(0):t||o(c.current||1),t})}return t.useEffect(()=>{c.current=h.current,h.current!==r&&(h.current=r,0!==r||s?0!==r&&s&&i(!1):i(!0),clearTimeout(d.current),d.current=window.setTimeout(()=>e.playerRef.current.volume=r,200))},[r]),n.createElement("div",{className:"player-video-controls-btn",onMouseOver:function(){clearTimeout(u.current),l(!1)},onMouseLeave:function(){clearTimeout(u.current),u.current=window.setTimeout(()=>l(!0),500)}},n.createElement("input",{style:{display:a?"none":"block"},type:"range",step:"any",max:"1",className:"player-video-controls-volume","aria-valuemax":100,"aria-valuemin":0,"aria-label":"volume","aria-valuenow":100,value:r,onChange:function(e){o(Number(e.target.value))}}),s?n.createElement(et,{className:"player-video-controls-btn",type:"mute",title:"静音",onClick:p}):n.createElement(et,{className:"player-video-controls-btn",type:"volume",title:"音量",onClick:p}))}(e);return n.createElement("div",{className:"player-video-controls"},n.createElement("div",{className:"player-video-controls-right"},r,s?n.createElement(et,{className:"player-video-controls-btn",type:"exitfullscreen",title:"退出全屏",onClick:function(){e.playerRef.current.exitFullScreen()}}):n.createElement(et,{className:"player-video-controls-btn",type:"fullscreen",title:"全屏",onClick:function(){i(!0),e.playerRef.current.fullScreen(()=>{i(!1)})}})))}function xt(e,s){const[n,i]=t.useState(!0);return t.useEffect(()=>{const t=e.current;t._controls!==n&&i(t._controls),t.on("controls",e=>{i(e)})},[]),t.useEffect(()=>{i(e.current._controls&&s)},[s]),n}const Vt=!function(){if(localStorage.getItem("browserval"))return!0;const e=navigator.userAgent.toLocaleLowerCase(),t=/(chrome)\/([\w.]+)/.exec(e);return(t&&parseInt(t[2]))>=74&&(localStorage.setItem("browserval","1"),!0)}()&&"请下载新版chrome",Gt=n.createElement("div",null,"请下载插件",n.createElement("a",{href:"/bclient/commonresource/chromeocx.exe"},"点击下载")),Lt=()=>n.createElement(n.Fragment,null,n.createElement("div",null,"有可更新插件",n.createElement("a",{href:"/bclient/commonresource/chromeocx.exe"},"点击下载")),n.createElement("div",null,"当前版本",Wt,", 服务器版本",St));let St="",Wt="";function Xt(e){const[s,n]=t.useState(Vt);function i(t,s){e.current.error||function(e,t){const s=e.split(".").map(e=>Number(e)),n=t.split(".").map(e=>Number(e));for(let e=0;e<s.length;e++)if(n[e]=n[e]||0,s[e]!==n[e])return s[e]>n[e];return s.length===n.length}(t,s)||(e.current.showMessage(Lt),n(Gt))}return t.useEffect(()=>{s&&e.current.showMessage(s),e.current.on("downerror",t=>{"network error 22"===t&&(e.current.showMessage(Gt),n(Gt))}),e.current.on("downmsg",e=>{Wt=e.server_version,St&&i(Wt,St)}),async function(){if(St)return St;const e=await fetch("/bclient/commonresource/config.json"),t=(await e.json()).chromeocxVersion;return St=t.split(" ")[0].substr(2),St}().then(e=>{Wt&&i(Wt,e)})},[]),s}function Tt(e){const s=Xt(e),[n,i]=t.useState(s);return t.useEffect(()=>{e.current.on("error",e=>i(e))},[]),{broken:s,error:n,setErrorStatus:function(t){e.current.showMessage(t),i(t)}}}function Ut(e,s){s||(s=t.useRef(null));const[r,o]=t.useState(null),{camera_id:a,stream_mode:l,stream_type:c,is_local:h}=e,{broken:u,error:d,setErrorStatus:p}=Tt(s),m=xt(s,!d);return t.useEffect(()=>{var e;(e={camera_id:a,stream_mode:l,stream_type:c,is_local:h},ot.get("/video/preview",e)).then(e=>{u||(o(e),p(!1))}).catch(e=>{s.current.showMessage(`${e.code} ${e.message}`)})},[e.camera_id]),n.createElement(it,i({ref:s},e,{url:r,autoplay:!0,shouldRender:!0,isLive:!0}),n.createElement("div",{className:"player-video-bottom",style:{height:32,visibility:m?"visible":"hidden"}},n.createElement(wt,{playerRef:s})))}function kt(e,s){s||(s=t.useRef(null));const[r,o]=t.useState(null),[a,l]=t.useState(null),[c,h]=t.useState([]),[u,d]=t.useState(!1!==e.progress),{broken:p,error:m,setErrorStatus:f}=Tt(s),y=xt(s,!m),b=t.useRef(null);function g(t,n){const{camera_id:i,source_type:r,stream_mode:o,is_local:a,rate:c}=e;return(h={camera_id:i,stream_mode:o,source_type:r,start_time:t,end_time:n,is_local:a,rate:c},ot.get("/video/record/replay-url",h)).then(({url:e,id:t})=>{if(!p)return l(t),b.current=t,e}).catch(e=>{s.current.showMessage(`${e.code} ${e.message}`)});var h}function v(){s.current.pause()}function Z(t){s.current.seek(()=>g(t,e.end_time))}return t.useEffect(()=>{const{start_time:t,end_time:n}=e;!function(t,n){const{camera_id:i,source_type:r}=e;(o={camera_id:i,source_type:r,start_time:t,end_time:n},ot.get("/video/files",o)).then(e=>{!function(e,t,s){let n=[];e.forEach(e=>{e.start_time<t&&(e.start_time=t),e.end_time>s&&(e.end_time=s);let i=n[n.length-1];i&&e.start_time===i.end_time?(i.end_time=e.end_time,n[n.length-1]={...i}):n.push({...e})}),h(n)}(e,t,n)}).catch(e=>{s.current.showMessage(`${e.error} ${e.message}`)});var o}(t,n),g(t,n).then(e=>{o(e),e&&f(!1)})},[e.camera_id,e.start_time,e.end_time]),n.createElement(n.Fragment,null,n.createElement(it,i({ref:s},e,{url:r,autoplay:!0,shouldRender:!0,pauseCallback:v,seekCallback:Z}),n.createElement("div",{className:"player-video-bottom",style:{height:u?"120px":"25px",visibility:y?"visible":"hidden"}},n.createElement("div",{className:"player-video-btnWrap"},u?n.createElement(et,{type:"close",className:"player-video-btnWrap-btn",onClick:function(){d(!1)}}):n.createElement(et,{type:"open",className:"player-video-btnWrap-btn",onClick:function(){d(!0)}})),n.createElement(wt,{playerRef:s}),n.createElement(Rt,i({playerRef:s},e,{id:a,fileData:c,pauseCallback:v,seekCallback:Z})))))}function Et(e,s){s||(s=t.useRef(null));const{broken:r,error:o,setErrorStatus:a}=Tt(s),l=xt(s,!o);return t.useEffect(()=>{e.url&&!r&&a(!1)},[e.url]),n.createElement(it,i({ref:s,autoplay:!0,shouldRender:!0,isLive:!0},e),n.createElement("div",{className:"player-video-bottom",style:{height:32,visibility:l?"visible":"hidden"}},n.createElement(wt,{playerRef:s})))}Ut=n.forwardRef(Ut),kt=n.forwardRef(kt),Et=n.forwardRef(Et),function(e){var t,s='<svg><symbol id="iconopen" viewBox="0 0 1024 1024"><path d="M894.31191406 389.28183594L552.5 763.06044922a53.79082031 53.79082031 0 0 1-40.40507813 18.28212891 53.79082031 53.79082031 0 0 1-40.40859375-18.28212891L129.87441406 389.28183594c-16.68603516-17.62382812-21.84257812-43.31162109-13.21875-65.99970703s29.43720703-38.53125 53.62558594-40.68632813h683.34433594c24.28154297 2.06279297 45.18632812 17.81103516 53.81191406 40.59404297 8.71875 22.78125 3.56308594 48.37324219-13.12558594 66.09199219z"  ></path></symbol><symbol id="iconclose" viewBox="0 0 1024 1024"><path d="M129.68808594 634.71816406L471.5 260.93955078a53.79082031 53.79082031 0 0 1 40.40507813-18.28212891 53.79082031 53.79082031 0 0 1 40.40859375 18.28212891L894.12558594 634.71816406c16.68603516 17.62382812 21.84257812 43.31162109 13.21875 65.99970703s-29.43720703 38.53125-53.62558595 40.68632813l-683.34433593 1e-8c-24.28154297-2.06279297-45.18632812-17.81103516-53.81191406-40.59404297-8.71875-22.78125-3.56308594-48.37324219 13.12558594-66.0919922z"  ></path></symbol><symbol id="iconsingleframe" viewBox="0 0 1024 1024"><path d="M144.39853408 916.80564219c15.27794121 7.37679815 33.44832247 5.36756045 46.75030313-5.21106681l459.21065537-364.9653536c10.55614307-8.39220996 16.71336826-21.14196592 16.71336826-34.63102002 0-13.48905411-6.15722519-26.23881006-16.71336826-34.63102002l-459.21065537-364.96535361c-7.98208857-6.34519776-17.71349063-9.6063873-27.53033468-9.6063873-6.5340703 0-13.11131074 1.44621915-19.21906933 4.39531962-15.29323154 7.38219463-25.01384063 22.86429785-25.01384062 39.84208682L119.38559258 876.96355449C119.38469346 893.94134346 129.10530255 909.42344668 144.39853408 916.80564219zM207.86130635 238.70139629L551.73505976 511.99820088l-343.87375341 273.29680459L207.86130635 238.70139629zM805.07979161 858.98654317L805.07979161 156.27857891c0-27.48716367 22.28059335-49.76775703 49.76775702-49.76775704 27.48806279 0 49.76775703 22.28059335 49.76775703 49.76775703L904.61530654 858.98654317c0 27.48626455-22.28059335 49.76775703-49.76775703 49.76775703C827.36038584 908.7543002 805.07979161 886.47280771 805.07979161 858.98654317z"  ></path></symbol><symbol id="iconsync" viewBox="0 0 1024 1024"><path d="M417.32703828 417.31849443l488.15573027 0 0 488.15483115-488.15573027 0 0-488.15483115Z"  ></path><path d="M362.61173516 362.60319131L606.6720626 362.60319131 606.6720626 118.52577529 118.51633232 118.52577529 118.51633232 606.68150557 362.61173516 606.68150557Z"  ></path></symbol><symbol id="iconiconstop" viewBox="0 0 1024 1024"><path d="M276.11153281 117.01749834l470.5690544 0c86.63016445 0 156.85365323 70.54546992 156.85365321 157.57316543l0 472.71949629c0 87.01960078-70.22348877 157.57316542-156.85365321 157.57316543L276.11153281 904.88332549c-86.6220706 0-156.84555849-70.55356464-156.8455585-157.57316543l2e-8-472.71949629C119.26597344 187.56296826 189.48946221 117.01749834 276.11153281 117.01749834z"  ></path></symbol><symbol id="iconright" viewBox="0 0 1024 1024"><path d="M118.25 118.25h787.5v787.5H118.25V118.25z m723.95507813 63.54492188H181.79492187v660.49804687h660.49804688V181.79492187zM372.25390625 664.40234375L581.87304688 512 372.25390625 359.59765625l38.14453125-50.80078125L683.47460938 512 410.3984375 715.203125 372.25390625 664.40234375z"  ></path></symbol><symbol id="iconleft" viewBox="0 0 1024 1024"><path d="M905.75 118.25H118.25v787.5h787.5V118.25z m-723.95507813 63.54492188h660.49804688v660.49804687H181.79492187V181.79492187zM651.74609375 664.40234375L442.12695312 512 651.74609375 359.59765625l-38.14453125-50.80078125L340.52539062 512l273.07617188 203.203125 38.14453125-50.80078125z"  ></path></symbol><symbol id="iconcut" viewBox="0 0 1024 1024"><path d="M814.81066895 165.93066406c23.86951447 0 43.258667 19.38915253 43.25866699 43.258667v605.62133789c0 23.86951447-19.38915253 43.258667-43.258667 43.25866699H209.18933105c-23.86951447 0-43.258667-19.38915253-43.25866699-43.25866699V209.18933105c0-23.86951447 19.38915253-43.258667 43.258667-43.25866699h605.62133789m0-49.43847656H209.18933105C157.97415924 116.4921875 116.4921875 157.97415924 116.4921875 209.18933105v605.62133789c0 51.21517182 41.48197175 92.69714356 92.69714356 92.69714356h605.62133789c51.21517182 0 92.69714356-41.48197175 92.69714355-92.69714356V209.18933105c0-51.21517182-41.48197175-92.69714356-92.69714355-92.69714355z" fill="" ></path><path d="M685.03466797 487.28076172H338.96533203c-13.67282868 0-24.71923828 11.04640961-24.71923828 24.71923828s11.04640961 24.71923828 24.71923828 24.71923828h346.06933594c13.67282868 0 24.71923828-11.04640961 24.71923828-24.71923828s-11.04640961-24.71923828-24.71923828-24.71923828z" fill="" ></path></symbol><symbol id="iconadd" viewBox="0 0 1024 1024"><path d="M862.29546875 826.3559375c-2.295 45.48234375-58.22296875 35.70328125-89.319375 35.70328125H239.36328125c-29.4553125 0-68.90484375 3.57328125-68.90484375-38.70703125v-106.04671875-392.293125-113.805c0-40.48734375 33.12984375-40.9978125 63.061875-40.9978125H765.2684375c28.31203125 0 75.8615625-9.01546875 93.05296875 19.2796875 5.61515625 9.24328125 3.9740625 23.135625 3.9740625 33.64875V826.3559375c0 27.2025 42.1875 27.2025 42.1875 0V221.66140625c0-13.095 0.02109375-25.29984375-3.3075-38.23875-8.6821875-33.76265625-42.90046875-55.39640625-76.41-55.39640625H213.32515625c-50.304375 0-85.05 34.745625-85.05 85.05v611.45296875c0 36.13359375 22.15265625 64.24734375 55.39640625 76.41 11.8209375 4.3284375 25.74703125 3.3075 38.23875 3.3075H826.5921875c43.925625 0 75.75609375-35.63578125 77.89078125-77.89078125 1.37109375-27.20671875-40.820625-27.07171875-42.1875 0z"  ></path><path d="M495.2853125 279.88015625v472.5c0 27.2025 42.18328125 27.2025 42.18328125 0v-472.5c0-27.2025-42.18328125-27.2025-42.18328125 0z"  ></path><path d="M280.1290625 537.22390625h472.49578125c27.2025 0 27.2025-42.1875 0-42.1875H280.1290625c-27.20671875 0-27.20671875 42.1875 0 42.1875z"  ></path></symbol><symbol id="iconfullscreen" viewBox="0 0 1024 1024"><path d="M148.86663321 643.52658191h0.10791492a32.37444571 32.37444571 0 0 1 32.37444573 32.37444571V869.73762596a32.37444571 32.37444571 0 0 1-32.37444573 32.37444571H148.86663321a32.37444571 32.37444571 0 0 1-32.37444571-32.37444571V675.90102762a32.37444571 32.37444571 0 0 1 32.37444571-32.37444572z"  ></path><path d="M149.9457817 837.46030367h194.73229143a32.37444571 32.37444571 0 0 1 32.37444573 32.37444572 32.37444571 32.37444571 0 0 1-32.37444573 32.37444572H149.9457817a32.37444571 32.37444571 0 0 1-32.37444573-32.37444572 32.37444571 32.37444571 0 0 1 32.37444572-32.37444572z"  ></path><path d="M126.91675917 891.21267511a32.2449478 32.2449478 0 0 1 0.74461221-45.70192656l264.06756255-254.77609678a32.37444571 32.37444571 0 1 1 45.10839445 46.40337277L172.76976583 891.95728731a32.50394362 32.50394362 0 0 1-45.85300665-0.7446122zM875.03624335 120.80878063h0.09712344a32.37444571 32.37444571 0 0 1 32.37444571 32.3744457v193.84738984a32.37444571 32.37444571 0 0 1-32.37444571 32.37444573h-0.09712344a32.37444571 32.37444571 0 0 1-32.37444571-32.37444573V153.18322633a32.37444571 32.37444571 0 0 1 32.37444571-32.3744457z"  ></path><path d="M679.32192687 120.80878063H874.0542183a32.37444571 32.37444571 0 0 1 32.37444573 32.3744457 32.37444571 32.37444571 0 0 1-32.37444572 32.37444572H679.32192687a32.37444571 32.37444571 0 0 1-32.37444573-32.37444572 32.37444571 32.37444571 0 0 1 32.37444572-32.3744457z"  ></path><path d="M897.08324083 131.70817721a32.2449478 32.2449478 0 0 1-0.74461221 45.70192576l-264.06756255 254.78688829a32.37444571 32.37444571 0 1 1-45.10839445-46.40337201l264.06756255-254.7760968a32.50394362 32.50394362 0 0 1 45.85300666 0.69065474zM154.26237404 116.4921875h193.83659834a32.37444571 32.37444571 0 0 1 32.37444572 32.37444571v0.09712344a32.37444571 32.37444571 0 0 1-32.37444571 32.37444571H154.26237404a32.37444571 32.37444571 0 0 1-32.37444571-32.37444571V148.86663321A32.37444571 32.37444571 0 0 1 154.26237404 116.4921875z"  ></path><path d="M154.26237404 117.57133597a32.37444571 32.37444571 0 0 1 32.37444571 32.37444573v194.78624812a32.37444571 32.37444571 0 0 1-32.37444571 32.37444649 32.37444571 32.37444571 0 0 1-32.37444571-32.37444649V149.9457817A32.37444571 32.37444571 0 0 1 154.26237404 117.57133597z"  ></path><path d="M132.78732489 126.91675917a32.2449478 32.2449478 0 0 1 45.70192656 0.74461221l254.77609678 264.06756255a32.37444571 32.37444571 0 1 1-46.40337277 45.10839445L132.04271269 172.76976583a32.50394362 32.50394362 0 0 1 0.7446122-45.85300665zM676.96938383 842.66179764H870.81677367a32.37444571 32.37444571 0 0 1 32.3744457 32.37444571v0.09712344a32.37444571 32.37444571 0 0 1-32.3744457 32.37444571H676.96938383a32.37444571 32.37444571 0 0 1-32.37444573-32.37444571v-0.09712344a32.37444571 32.37444571 0 0 1 32.37444573-32.37444571z"  ></path><path d="M870.81677367 646.99064711a32.37444571 32.37444571 0 0 1 32.3744457 32.37444572V874.0542183a32.37444571 32.37444571 0 0 1-32.3744457 32.37444573 32.37444571 32.37444571 0 0 1-32.37444572-32.37444572V679.32192687a32.37444571 32.37444571 0 0 1 32.37444572-32.33127976z"  ></path><path d="M892.29182279 897.08324083a32.2449478 32.2449478 0 0 1-45.70192576-0.74461221l-254.78688829-264.06756255a32.37444571 32.37444571 0 1 1 46.40337201-45.10839445l254.7760968 264.06756255a32.50394362 32.50394362 0 0 1-0.69065474 45.85300666z"  ></path></symbol><symbol id="iconloading" viewBox="0 0 1024 1024"><path d="M873.29375001 569.0375c-15.1875-3.6-30.20625001 5.79375001-33.86250002 20.86875001C803.31875001 742.7375 668.375 849.5 511.38124999 849.5c-94.78125001 0-181.06875001-39.375-242.83124999-103.89375001-7.70625001-7.93125001-14.34375001-16.425-21.09375001-24.91874999-5.4-6.80625001-10.9125-13.3875-15.74999998-20.64374999-4.44375001-6.525-8.04374999-13.44375001-11.92500002-20.19375001-5.85-10.18125001-11.64375001-20.30625001-16.48124999-31.1625-2.025-4.6125-3.4875-9.3375-5.2875-14.00624999C192.78124999 621.29375001 188 607.68125001 184.4 593.39375001c-14.11875001-56.75625001-12.9375-116.325 3.4875-173.58750002C191.4875 407.375 195.14374999 395 199.98124999 383.24374999c5.34375001-12.88125001 11.98125001-25.25625001 19.01250002-37.63124999C277.60624999 241.94375001 387.125 174.5 511.38124999 174.5c157.05 0 291.9375 106.7625 328.10625001 259.59375001C842.525 447.0875 854.05625001 455.75 866.825 455.75c2.19375001 0 4.275-0.225 6.46875001-0.7875 15.1875-3.54375001 24.525-18.73125001 20.86874999-33.8625C851.975 242.84374999 694.53125001 118.25 511.38124999 118.25 371.54374999 118.25 247.175 191.15 177.0875 304.83124999 176.91874999 305.1125 176.6375 305.28124999 176.46874999 305.5625 173.76874999 309.89374999 172.1375 314.61874999 169.6625 319.00624999 161.84374999 332.84374999 154.19374999 346.7375 148.11874999 361.64374999c-5.90625001 14.175-10.06875001 28.6875-14.23124999 43.25625001C132.3125 410.35624999 129.89374999 415.475 128.54374999 421.15624999 128.43124999 421.55 128.6 421.8875 128.4875 422.28124999 114.5375 481.0625 115.15624999 541.53125001 128.43124999 599.69375001c0.1125 1.125-0.1125 2.08124999 0.11250002 3.20624999 0.3375 1.40625001 1.0125 2.75625001 1.35 4.1625 4.05 16.36874999 9.5625 32.23125001 15.75 48.0375 2.08124999 5.45625001 3.825 11.025 6.24374999 16.36874999 5.5125 12.54375001 12.31875001 24.525 19.2375 36.39375001 4.5 7.9875 8.775 15.975 13.78125001 23.5125 5.7375 8.38125001 12.2625 16.3125 18.61874999 24.4125 7.81875001 9.9 15.58125001 19.6875 24.3 28.74374999 1.8 1.9125 3.20625001 4.10625001 5.0625 5.9625l0.675-0.675C305.3375 861.7625 403.55 905.75 511.38124999 905.75c183.15 0 340.59375001-124.59375001 382.78125001-302.90625001C897.7625 587.76875001 888.425 572.58125001 873.29375001 569.0375z"  ></path></symbol><symbol id="iconplay" viewBox="0 0 1024 1024"><path d="M859.97188741 465.05141158L219.26174595 67.36925455c-35.90186097-22.0934536-82.85044939 5.52336372-82.85044938 46.94858842v795.36431406c0 41.42522469 46.94858842 69.04204071 82.85044938 46.94858842l637.94846025-397.68215703c38.66354348-19.33177108 38.66354348-74.56540445 2.76168121-93.89717684z"  ></path></symbol><symbol id="iconpause" viewBox="0 0 1024 1024"><path d="M349.866667 149.333333h-14.933334c-21.333333 0-36.266667 14.933333-36.266666 34.133334v654.933333c0 19.2 14.933333 34.133333 34.133333 34.133333h14.933333c19.2 0 34.133333-14.933333 34.133334-34.133333V183.466667c2.133333-19.2-12.8-34.133333-32-34.133334z m341.333333 0h-14.933333c-21.333333 0-36.266667 14.933333-36.266667 34.133334v654.933333c0 19.2 14.933333 34.133333 34.133333 34.133333h14.933334c19.2 0 34.133333-14.933333 34.133333-34.133333V183.466667c2.133333-19.2-12.8-34.133333-32-34.133334z"  ></path></symbol><symbol id="iconmute" viewBox="0 0 1024 1024"><path d="M525.65333333 125.1555552h-2.2755552c-9.10222187 0-18.2044448 2.2755552-27.30666666 9.10222293-134.25777813 116.05333333-204.8 177.49333333-211.62666667 184.32H175.21777813c-13.65333333 0-25.03111147 4.55111147-34.13333333 13.65333334-11.37777813 11.37777813-15.92888853 22.7555552-15.9288896 34.13333333v295.82222187c0 13.65333333 4.55111147 25.03111147 13.65333333 34.13333333 9.10222187 9.10222187 20.48 13.65333333 34.13333334 13.65333333H284.4444448c2.2755552 2.2755552 22.7555552 20.48 56.88888853 50.06222187 34.13333333 29.58222187 70.54222187 59.1644448 102.4 86.47111147 34.13333333 27.30666667 50.06222187 43.2355552 52.33777814 43.2355552 9.10222187 6.82666667 18.2044448 9.10222187 27.30666666 9.10222293h2.2755552c18.2044448-2.2755552 29.58222187-13.65333333 34.13333334-34.13333333v-705.42222294c-4.55111147-20.48-15.92888853-31.85777813-34.13333334-34.13333333z m-9.10222186 721.35111147c-6.82666667-4.55111147-211.62666667-182.0444448-211.62666667-182.0444448H172.94222187V361.81333333h131.98222293s50.06222187-45.51111147 211.62666667-186.5955552v671.28888854zM794.16888853 512l95.57333334-95.57333333c9.10222187-9.10222187 9.10222187-22.7555552 0-31.85777814s-22.7555552-9.10222187-31.85777707 0L762.31111147 480.14222187l-95.57333334-95.57333334c-9.10222187-9.10222187-22.7555552-9.10222187-31.85777813 0s-9.10222187 22.7555552 0 31.85777814l95.57333333 95.57333333-95.57333333 95.57333333c-9.10222187 9.10222187-9.10222187 22.7555552 0 31.85777814s22.7555552 9.10222187 31.85777813 0l95.57333334-95.57333334 95.57333333 95.57333334c9.10222187 9.10222187 22.7555552 9.10222187 31.85777707 0s9.10222187-22.7555552 0-31.85777814L794.16888853 512z"  ></path></symbol><symbol id="iconvolume" viewBox="0 0 1024 1024"><path d="M535.466667 149.333333H533.333333c-8.533333 0-17.066667 2.133333-25.6 8.533334-125.866667 108.8-192 166.4-198.4 172.8H204.8c-12.8 0-23.466667 4.266667-32 12.8-8.533333 8.533333-12.8 19.2-12.8 32v277.333333c0 12.8 4.266667 23.466667 12.8 32 8.533333 8.533333 19.2 12.8 32 12.8h102.4c2.133333 2.133333 21.333333 19.2 53.333333 46.933333 32 27.733333 66.133333 55.466667 96 81.066667 32 25.6 46.933333 40.533333 49.066667 40.533333 8.533333 6.4 17.066667 8.533333 25.6 8.533334h2.133333c17.066667-2.133333 27.733333-12.8 32-32v-661.333334c-2.133333-19.2-12.8-29.866667-29.866666-32z m-10.666667 676.266667c-6.4-4.266667-198.4-170.666667-198.4-170.666667H202.666667V371.2h123.733333s46.933333-42.666667 198.4-174.933333v629.333333z m262.4-535.466667c-8.533333-10.666667-21.333333-10.666667-32-2.133333-8.533333 8.533333-8.533333 19.2-2.133333 27.733333 42.666667 53.333333 68.266667 121.6 68.266666 196.266667 0 74.666667-25.6 142.933333-68.266666 196.266667-6.4 8.533333-6.4 19.2 2.133333 27.733333s23.466667 8.533333 32-2.133333c49.066667-61.866667 76.8-138.666667 76.8-224s-29.866667-157.866667-76.8-219.733334z m-123.733333 89.6c-8.533333 8.533333-8.533333 19.2-4.266667 25.6 21.333333 29.866667 32 68.266667 32 106.666667 0 40.533333-12.8 76.8-32 106.666667-6.4 8.533333-4.266667 19.2 2.133333 25.6 8.533333 8.533333 23.466667 8.533333 32-2.133334 25.6-38.4 40.533333-83.2 40.533334-130.133333 0-49.066667-14.933333-93.866667-40.533334-130.133333-4.266667-10.666667-19.2-12.8-29.866666-2.133334z"  ></path></symbol><symbol id="iconexitfullscreen" viewBox="0 0 1024 1024"><path d="M692 842v-90c0-51 39-90 90-90h90c18 0 30-12 30-30s-12-30-30-30h-90c-84 0-150 66-150 150v90c0 18 12 30 30 30s30-12 30-30z m-60-660v90c0 84 66 150 150 150h90c18 0 30-12 30-30s-12-30-30-30h-90c-51 0-90-39-90-90v-90c0-18-12-30-30-30s-30 12-30 30z m-240 660v-90c0-84-66-150-150-150h-90c-18 0-30 12-30 30s12 30 30 30h90c51 0 90 39 90 90v90c0 18 12 30 30 30s30-12 30-30z m-60-660v90c0 51-39 90-90 90h-90c-18 0-30 12-30 30s12 30 30 30h90c84 0 150-66 150-150v-90c0-18-12-30-30-30s-30 12-30 30z"  ></path></symbol></svg>';if((t=document.getElementsByTagName("script"))[t.length-1].getAttribute("data-injectcss")&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(t){console&&console.log(t)}}!function(t){if(document.addEventListener)if(~["complete","loaded","interactive"].indexOf(document.readyState))setTimeout(t,0);else{var s=function(){document.removeEventListener("DOMContentLoaded",s,!1),t()};document.addEventListener("DOMContentLoaded",s,!1)}else document.attachEvent&&(i=t,r=e.document,o=!1,(a=function(){try{r.documentElement.doScroll("left")}catch(e){return void setTimeout(a,50)}n()})(),r.onreadystatechange=function(){"complete"==r.readyState&&(r.onreadystatechange=null,n())});function n(){o||(o=!0,i())}var i,r,o,a}((function(){var e,t,n,i,r,o;(e=document.createElement("div")).innerHTML=s,s=null,(t=e.getElementsByTagName("svg")[0])&&(t.setAttribute("aria-hidden","true"),t.style.position="absolute",t.style.width=0,t.style.height=0,t.style.overflow="hidden",n=t,(i=document.body).firstChild?(r=n,(o=i.firstChild).parentNode.insertBefore(r,o)):i.appendChild(n))}))}(window),e.PreviewPlayer=Ut,e.ReplayPlayer=kt,e.UrlPlayer=Et,Object.defineProperty(e,"__esModule",{value:!0})}));
