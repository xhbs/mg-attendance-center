!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],t):t((e=e||self).vplay={},e.React)}(this,(function(e,t){"use strict";function s(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("media","screen"),t.innerHTML=e,document.head.appendChild(t),e}}var n="default"in t?t.default:t;function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e}).apply(this,arguments)}class r{constructor(){this.eventMap=new Map(),this.allEventMap=new Set(),this.singleEventMap=new Map()}static transferEvent(e,t){e.onevery((e,...s)=>t.emit(e,...s))}copyEvent(e){e.eventMap.forEach((e,t)=>this.eventMap.set(t,e)),e.allEventMap.forEach(e=>this.allEventMap.add(e)),e.singleEventMap.forEach((e,t)=>this.singleEventMap.set(t,e))}getEventMap(e,t){return e.get(t)||e.set(t,new Set()),e.get(t)}on(e,t){const s=this.getEventMap(this.eventMap,e);return s.add(t),()=>s.delete(t)}once(e,t){this.getEventMap(this.singleEventMap,e).add(t)}onevery(e){this.allEventMap.add(e)}emit(e,...t){this.getEventMap(this.eventMap,e).forEach(e=>e(...t));const s=this.getEventMap(this.singleEventMap,e);s.forEach(e=>{e(...t),s.delete(e)}),this.allEventMap.forEach(s=>s(e,...t))}unEvent(e){this.eventMap.delete(e),this.singleEventMap.delete(e)}destory(){this.eventMap.clear(),this.allEventMap.clear(),this.singleEventMap.clear()}}function o(e){return{setStatus:t=>function(e,t){e.status=t}(e,t),hasStatus:t=>function(e,t){return e.status&t}(e,t),contactStatus:t=>function(e,t){e.status|=t}(e,t),removeStatus:t=>function(e,t){e.status&=~t}(e,t),replaceStatus:(t,s)=>function(e,t,s){e.status&=~t,e.status|=s}(e,t,s)}}let a=0;const l=["#d64e4e","#bada55","#7ec699"];class c{constructor(e){this.name=void 0,this.color=void 0,this.name=e,this.color=`\n    color: ${l[a]};\n    font-style: italic;\n    padding: 2px;\n    width: 100px;\n  `,a++}log(e,...t){console[e](`%c${this.name}:`,this.color,...t)}info(e,...t){e&&this.log("log",...t)}group(...e){}groupEnd(...e){}debug(...e){}warn(e,t,...s){return e&&console.log(`%c${this.name}:`,this.color,t,...s),e}error(e,...t){return e&&this.log("error",...t),e}}c.level=1;class u{constructor(){this.log=new c("basic-download"),this.status=0,this._onerror=null,this._onDownBuffer=null,this._onDownMessage=null,this._onpause=null,this._onresume=null,this._contentLength=0,this._receivedLength=0}set onerror(e){this._onerror=e}set onpause(e){this._onpause=e}set onresume(e){this._onresume=e}set contentLength(e){this._contentLength=e}set onDownBuffer(e){this._onDownBuffer=e}set onDownMessage(e){this._onDownMessage=e}open(){return this.log.debug('it\'s virutal function "open", please implements it'),Promise.resolve()}pause(){this.log.debug('it\'s virutal function "pause", please implements it')}resume(){this.log.debug('it\'s virutal function "resume", please implements it')}destory(){this.log.debug('it\'s virutal function "destory", please implements it')}isDone(){return this.log.debug('it\'s virutal function "isDone", please implements it'),!1}}function h(){}function d(){let e=[h,h];const t=new Promise((t,s)=>{e=[t,s]});return[e,t]}const p=new c("downloader");class m extends u{constructor(e){super(),this.url="",this.socket=void 0,this.onmessage=e=>{const t=e.data;if(t instanceof ArrayBuffer)this._onDownBuffer&&this._onDownBuffer(t,this.isDone());else if(t instanceof Blob){const e=new FileReader();e.onload=()=>{this._onDownBuffer&&this._onDownBuffer(e.result,this.isDone())},e.readAsArrayBuffer(t)}else"string"==typeof t&&this._onDownMessage&&this._onDownMessage(JSON.parse(t))},this.onclose=e=>{p.warn(!0,"socket connect closed")},this.url=e}open(){const e=new WebSocket(this.url);e.binaryType="arraybuffer";const[t,s]=d();e.onmessage=this.onmessage;let n=!1;return e.onopen=()=>{p.debug(`${this.url} opened`),n=!0,t[0]()},e.onerror=e=>{p.error(!0,e);const s=n?e.type:"network error 22";this._onerror&&this._onerror(s),t[1](e)},e.onclose=this.onclose,this.socket=e,s}pause(){this._onpause&&this._onpause()}seek(){p.debug("download pause")}resume(){this._onresume&&this._onresume()}destory(){this.socket.close()}isDone(){return!1}}let f;!function(e){e[e.OPEN=1]="OPEN",e[e.PAUSE=2]="PAUSE",e[e.RESUME=4]="RESUME",e[e.DONE=8]="DONE"}(f||(f={}));class y extends u{constructor(e){super(),this.url="",this.url=e}open(){this.status=f.OPEN;let e=new Headers(),t={method:"GET",headers:e,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};return e.set("Range",`bytes=${this._receivedLength}-`),fetch(this.url,t).then(e=>{if(!e.ok||!(e.status>=200&&e.status<=299))return;const t=e.headers.get("Content-Length");null!=t&&(this._contentLength=this._contentLength||parseInt(t),this.pump(e.body.getReader()))})}async pump(e){if(this.status&f.PAUSE)return void e.cancel();const t=await e.read();if(t.done)null!==this._contentLength&&this._receivedLength<this._contentLength||(this.status=f.DONE);else{const s=t.value.buffer;this._receivedLength+=s.byteLength,this._receivedLength===this._contentLength&&(this.status=f.DONE),this._onDownBuffer(s,this.isDone()),this.pump(e)}}pause(){this.status=f.PAUSE}resume(){this.status&f.OPEN||(this._receivedLength>=this._contentLength?console.log("已经缓冲完成"):(this.status=f.OPEN,this.open()))}isDone(){return!!(this.status&f.DONE)}}const b={create:function(e){const{url:t,type:s}=e;switch(s){case"http":return new y(t);case"ws":return new m(t);default:return new y(t)}},destory:function(e){e.destory(),e.onDownBuffer=null,e=null}};let g;!function(e){e[e.LOAD=1]="LOAD",e[e.LOADDATA=2]="LOADDATA",e[e.PLAYING=4]="PLAYING",e[e.PAUSE=8]="PAUSE",e[e.DISCARD=16]="DISCARD",e[e.FPLAY=32]="FPLAY"}(g||(g={}));class Z extends r{constructor(e,t){super(),this.el=void 0,this.parent=void 0,this.url=void 0,this.urltype=void 0,this.isLive=!1,this.error=null,this.status=0,this.statusUtil=o(this),this.log=void 0,this.download=null,this.downBufctl=null,this.avParams=null,this.playParams=void 0,this.now=0,this.lastV=0,this.lastA=0,this.endV=0,this.endA=0,this._actualTime=0,this._currentTime=0,this._playbackRate=1,this.shouldRender=void 0,this.onerror=e=>{e?(this.emit("error",e),this.error=e,this.destory()):this.error=null},this.onDownload=null,this.onDownloadMsg=e=>{this.emit("downmsg",e)},this.onDownloadErr=e=>{this.emit("downerror",e)},this._resetAnimate=()=>{this.now=Date.now()},this._animate=()=>{if(!this.statusUtil.hasStatus(g.PLAYING))return;requestAnimationFrame(this._animate);const e=Date.now(),t=(e-this.now)*this._playbackRate;this.now=e,this._actualTime+=t,this._currentTime+=t;const s=Math.max(this.endA,this.endV);this._currentTime>s&&(this._currentTime=s),this.onLoop(this._currentTime,t)},this.log=new c(t),this.setOptions(e)}bindElement(e){this.parent.appendChild(e),this.el=e}setOptions(e){this.url=e.url,this.urltype=e.type,this.parent=e.el,this.isLive=e.isLive||!1}async load(){if(this.log.warn(this.statusUtil.hasStatus(g.LOAD),"请勿重复加载视频"))throw 1;this.emit("loadstart"),this.emit("waiting")}async reload(){this._currentTime=0,this._actualTime=0,this.statusUtil.removeStatus(g.LOADDATA),this.pause(!1),this.destoryDownload(),await this.loadDownload(),this.play(!1)}loadDownload(){return this.download=b.create({url:this.url,type:this.urltype}),this.download.onDownBuffer=this.onDownload,this.download.onDownMessage=this.onDownloadMsg,this.download.onerror=this.onDownloadErr,this.download.open()}destoryDownload(){this.download&&b.destory(this.download),this.download=null,this.downBufctl&&this.downBufctl.cancelCheck(),this.downBufctl=null}framePlay(){}play(e){return this.log.warn(!this.statusUtil.hasStatus(g.LOAD),"视频还未加载成功")?(this.emit("waiting"),!1):!this.log.warn(this.statusUtil.hasStatus(g.PLAYING),"请勿重复调用")&&(this.statusUtil.replaceStatus(g.PAUSE,g.PLAYING),this.emit("playing"),!0)}pause(e){return this.log.warn(!this.statusUtil.hasStatus(g.LOAD),"视频还未加载")?(this.emit("waiting"),!1):(e&&this.emit("pause"),this.statusUtil.replaceStatus(g.PLAYING,g.PAUSE),this.downBufctl.pause(),this.downBufctl.cancelCheck(),!0)}async seek(e){this.log.warn(!this.statusUtil.hasStatus(g.LOAD),"视频还未加载")?this.emit("waiting"):(this.emit("seeking"),e&&await e(),await this.reload(),this.emit("seeked"))}destory(){this.status=g.DISCARD,this.destoryDownload(),this.emit("destory"),super.destory(),this.parent&&(this.parent.removeChild(this.el),this.parent=null),this.el=null}syncAudio(e,t){return e+t<=this._currentTime?-1:e>this._currentTime+t?1:0}syncContorl(e,t){const s=Math.abs(e-t);return s<200||(t>e?(this.log.debug(`视频超前 ${s}ms, 暂停视频`),t):(this.log.debug(`视频落后 ${s}ms, 调整时间至${e}, 总时长${this.endV}`),e))}onLoop(e,t){}set currentTime(e){}get currentTime(){return null}set playbackRate(e){this._playbackRate=e,this.emit("ratechange",e)}get playbackRate(){return this._playbackRate}get debugInfo(){return null}setSize(e,t){this.el instanceof HTMLCanvasElement&&(this.el.width=e,this.el.height=t),this.parent.style.width=e+"px",this.parent.style.height=t+"px"}}var v,V,R;!function(e){e[e.NAL_UNKNOWN=100]="NAL_UNKNOWN",e[e.NAL_SLICE=1]="NAL_SLICE",e[e.NAL_SLICE_DPA=2]="NAL_SLICE_DPA",e[e.NAL_SLICE_DPB=3]="NAL_SLICE_DPB",e[e.NAL_SLICE_DPC=4]="NAL_SLICE_DPC",e[e.NAL_SLICE_IDR=5]="NAL_SLICE_IDR",e[e.NAL_SEI=6]="NAL_SEI",e[e.NAL_SPS=7]="NAL_SPS",e[e.NAL_PPS=8]="NAL_PPS"}(v||(v={})),function(e){e[e.NAL_UNKNOWN=100]="NAL_UNKNOWN",e[e.NAL_SLICE=1]="NAL_SLICE",e[e.NAL_SLICE_DPA=2]="NAL_SLICE_DPA",e[e.NAL_SLICE_DPB=3]="NAL_SLICE_DPB",e[e.NAL_SLICE_DPC=4]="NAL_SLICE_DPC",e[e.NAL_SLICE_IDR=5]="NAL_SLICE_IDR",e[e.NAL_SEI=39]="NAL_SEI",e[e.NAL_SPS=33]="NAL_SPS",e[e.NAL_PPS=34]="NAL_PPS",e[e.NAL_VPS=32]="NAL_VPS"}(V||(V={})),function(e){e[e.VIDEO=224]="VIDEO",e[e.AUDIO=192]="AUDIO"}(R||(R={}));new c("decoderWorker");var S;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.LOAD=1]="LOAD",e[e.RECEIVESPS=2]="RECEIVESPS",e[e.PREPARE=4]="PREPARE",e[e.DECODE=8]="DECODE",e[e.DECODING=16]="DECODING",e[e.PAUSE=32]="PAUSE",e[e.WASMBUFFERFULL=64]="WASMBUFFERFULL",e[e.DOWNLBUFFER=128]="DOWNLBUFFER",e[e.BUFFERFULL=256]="BUFFERFULL",e[e.DOWNLOADDOWN=512]="DOWNLOADDOWN",e[e.DONE=1024]="DONE"}(S||(S={}));new c("decoder");let L;!function(e){e.LOAD="0x00000001",e.MODULE="MODULE",e.INIT="0x00000010",e.DESTORY="DESTORY",e.OPEN="0x00000100",e.FLUSH="FLUSH",e.RECEIVE="0x00001000",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.START="0x00010000",e.STOP="0x00100000",e.DECODE="0x01000000",e.FAILED="0x10000000"}(L||(L={}));const x=L;let G,U;!function(e){e.ERROR="error",e.LOADING_COMPLETE="loading_complete",e.RECOVERED_EARLY_EOF="recovered_early_eof",e.MEDIA_INFO="media_info",e.METADATA_ARRIVED="metadata_arrived",e.SCRIPTDATA_ARRIVED="scriptdata_arrived",e.STATISTICS_INFO="statistics_info"}(G||(G={})),function(e){e[e.UNKNOWN=1]="UNKNOWN",e[e.LOAD=4]="LOAD",e[e.OPEN=8]="OPEN"}(U||(U={}));const w=new c("decoder");class W extends r{constructor(e,t){super(),this.props=void 0,this.status=0,this.statusUtil=o(this),this.decodeWorker=void 0,this.getWorker=void 0,this.downloadBytes=0,this._onerror=null,this.onAVFrame=void 0,this.pendingFrames=0,this.lossFrames=0,this.onmessage=e=>{const{type:t,pending:s}=e.data;switch(t){case L.OPEN:this.statusUtil.contactStatus(U.OPEN),this.emit(t,e.data);break;case L.AUDIO:case L.VIDEO:this.onAVFrame(e.data);case x.FAILED:this.pendingFrames=s;break;default:w.debug(`not valid type [${t}]`)}},this.onDownloadBuffer=(e,t)=>{this.pendingFrames++,this.downloadBytes+=e.byteLength,this.sendBuffer(e),t&&(this.pendingFrames=NaN)},this.props=e,this.getWorker=t,this.statusUtil.setStatus(U.UNKNOWN)}async load(){w.debug("prepare for load decoder"),this.decodeWorker=await this.getWorker(),this.decodeWorker.onmessage=this.onmessage,this.statusUtil.setStatus(U.LOAD)}postMessage(e,t){t instanceof ArrayBuffer?this.decodeWorker.postMessage(t,[t]):this.decodeWorker.postMessage({type:e,data:t})}getVideoParams(){const[e,t]=d();return this.once(L.OPEN,t=>{e[0](t)}),t}startDecoding(){this.postMessage(x.START)}stopDecoding(){this.postMessage(x.STOP)}seekDecoding(){}flushBuffers(){this.postMessage(L.FLUSH)}sendBuffer(e){this.postMessage(x.RECEIVE,e)}destory(){this.pendingFrames=0,this.downloadBytes=0}isDone(){return NaN===this.pendingFrames}set onerror(e){this._onerror=e}}const T="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0),E=T&&"function"==typeof module.require?module.require:null;const X=function(e,t=null,s=!1){const n=T?function(e,t){return Buffer.from(e,"base64").toString(t?"utf16":"utf8")}(e,s):function(e,t){const s=atob(e);if(t){const e=new Uint8Array(s.length);return Array.prototype.forEach.call(e,(e,t,n)=>{n[t]=s.charCodeAt(t)}),String.fromCharCode.apply(null,new Uint16Array(e.buffer))}return s}(e,s),i=n.indexOf("\n",10)+1,r=n.substring(i)+(t?`//# sourceMappingURL=${t}`:"");if(E){const e=E("worker_threads").Worker;return function(t){return new e(r,Object.assign({},t,{eval:!0}))}}const o=new Blob([r],{type:"application/javascript"}),a=URL.createObjectURL(o);return function(e){return new Worker(a,e)}}("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwpsZXQgZT0wO2NvbnN0IHQ9WyIjZDY0ZTRlIiwiI2JhZGE1NSIsIiM3ZWM2OTkiXTtjbGFzcyBze2NvbnN0cnVjdG9yKHMpe3RoaXMubmFtZT12b2lkIDAsdGhpcy5jb2xvcj12b2lkIDAsdGhpcy5uYW1lPXMsdGhpcy5jb2xvcj1gXG4gICAgY29sb3I6ICR7dFtlXX07XG4gICAgZm9udC1zdHlsZTogaXRhbGljO1xuICAgIHBhZGRpbmc6IDJweDtcbiAgICB3aWR0aDogMTAwcHg7XG4gIGAsZSsrfWxvZyhlLC4uLnQpe2NvbnNvbGVbZV0oYCVjJHt0aGlzLm5hbWV9OmAsdGhpcy5jb2xvciwuLi50KX1pbmZvKGUsLi4udCl7ZSYmdGhpcy5sb2coImxvZyIsLi4udCl9Z3JvdXAoLi4uZSl7fWdyb3VwRW5kKC4uLmUpe31kZWJ1ZyguLi5lKXt9d2FybihlLHQsLi4ucyl7cmV0dXJuIGUmJmNvbnNvbGUubG9nKGAlYyR7dGhpcy5uYW1lfTpgLHRoaXMuY29sb3IsdCwuLi5zKSxlfWVycm9yKGUsLi4udCl7cmV0dXJuIGUmJnRoaXMubG9nKCJlcnJvciIsLi4udCksZX19cy5sZXZlbD0xO2NsYXNzIGl7Y29uc3RydWN0b3IoKXt0aGlzLmJ1ZmZlcj1bXSx0aGlzLmNvbXBsZXRlPSExLHRoaXMubmV4dD1udWxsLHRoaXMudG90YWxMZW5ndGg9MH1hZGRCdWZmZXIoZSl7dGhpcy5idWZmZXIucHVzaChlKSx0aGlzLnRvdGFsTGVuZ3RoKz1lLmJ5dGVMZW5ndGh9aXNFbmQoKXtyZXR1cm4gdGhpcy5jb21wbGV0ZX1lbmRPZkJ1ZmZlcigpe3RoaXMuY29tcGxldGU9ITB9Z2V0QnVmZmVyKCl7aWYoMD09PXRoaXMudG90YWxMZW5ndGgpcmV0dXJuIG5ldyBBcnJheUJ1ZmZlcigwKTtpZigxPT09dGhpcy5idWZmZXIubGVuZ3RoKXJldHVybiB0aGlzLmJ1ZmZlclswXTtjb25zdCBlPW5ldyBVaW50OEFycmF5KHRoaXMudG90YWxMZW5ndGgpO2xldCB0PTA7Zm9yKGxldCBzPTA7czx0aGlzLmJ1ZmZlci5sZW5ndGg7cysrKXtjb25zdCBpPW5ldyBVaW50OEFycmF5KHRoaXMuYnVmZmVyW3NdKTtlLnNldChpLHQpLHQrPWkuYnl0ZUxlbmd0aH1yZXR1cm4gZS5idWZmZXJ9fWNsYXNzIG97Y29uc3RydWN0b3IoZSx0KXt0aGlzLmxpbWl0PXZvaWQgMCx0aGlzLmxvZz12b2lkIDAsdGhpcy5jb3VudD0wLHRoaXMuZmlyc3RGcmFtZT1udWxsLHRoaXMuY3VycmVudEZyYW1lPW51bGwsdGhpcy5saW1pdD1lLHRoaXMubG9nPW5ldyBzKHQpfWdldCBsZW5ndGgoKXtyZXR1cm4gdGhpcy5jb3VudH1jcmVhdGVGcmFtZSgpe2NvbnN0IGU9bmV3IGk7cmV0dXJuIHRoaXMuZW5xdWV1ZShlKSxlfWVucXVldWUoZSl7dGhpcy5jb3VudD50aGlzLmxpbWl0P3RoaXMubG9nLmVycm9yKCEwLGBtYXggTGltaXQgJHt0aGlzLmxpbWl0fWApOih0aGlzLmN1cnJlbnRGcmFtZT8odGhpcy5jdXJyZW50RnJhbWUubmV4dD1lLHRoaXMuY3VycmVudEZyYW1lPWUpOih0aGlzLmN1cnJlbnRGcmFtZT1lLHRoaXMuZmlyc3RGcmFtZT1uZXcgaSx0aGlzLmZpcnN0RnJhbWUubmV4dD1lKSx0aGlzLmNvdW50KyspfWRlcXVldWUoKXtpZigwPT09dGhpcy5jb3VudClyZXR1cm4gbnVsbDt0aGlzLmNvdW50LS07Y29uc3QgZT10aGlzLmZpcnN0RnJhbWUubmV4dDtyZXR1cm4gdGhpcy5maXJzdEZyYW1lPWUsZX19dmFyIHIsbixhO2Z1bmN0aW9uIGQoZSl7Y29uc3QgdD0zMSZlO3N3aXRjaCh0KXtjYXNlIHIuTkFMX1NMSUNFOmNhc2Ugci5OQUxfU0xJQ0VfSURSOnJldHVybiB0O2Nhc2Ugci5OQUxfU0xJQ0VfRFBBOmNhc2Ugci5OQUxfU0xJQ0VfRFBCOmNhc2Ugci5OQUxfU0xJQ0VfRFBDOnJldHVybiB0O2Nhc2Ugci5OQUxfU0VJOmNhc2Ugci5OQUxfU1BTOmNhc2Ugci5OQUxfUFBTOnJldHVybiB0O2Nhc2Ugci5OQUxfVU5LTk9XTjpkZWZhdWx0OnJldHVybiByLk5BTF9VTktOT1dOfX0hZnVuY3Rpb24oZSl7ZVtlLk5BTF9VTktOT1dOPTEwMF09Ik5BTF9VTktOT1dOIixlW2UuTkFMX1NMSUNFPTFdPSJOQUxfU0xJQ0UiLGVbZS5OQUxfU0xJQ0VfRFBBPTJdPSJOQUxfU0xJQ0VfRFBBIixlW2UuTkFMX1NMSUNFX0RQQj0zXT0iTkFMX1NMSUNFX0RQQiIsZVtlLk5BTF9TTElDRV9EUEM9NF09Ik5BTF9TTElDRV9EUEMiLGVbZS5OQUxfU0xJQ0VfSURSPTVdPSJOQUxfU0xJQ0VfSURSIixlW2UuTkFMX1NFST02XT0iTkFMX1NFSSIsZVtlLk5BTF9TUFM9N109Ik5BTF9TUFMiLGVbZS5OQUxfUFBTPThdPSJOQUxfUFBTIn0ocnx8KHI9e30pKTtjbGFzcyBje2NvbnN0cnVjdG9yKGUpe3RoaXMubmFtZT0iaDI2NCIsdGhpcy5kZWNvZGVyPXZvaWQgMCx0aGlzLmJ1ZmZlclF1ZXVlPW5ldyBvKDEsInBhcnNlciBkb3dubG9hZCBidWZmZXIgcXVldWUiKSx0aGlzLmRlY29kZXI9ZX1wYXJzZShlLHQpe2NvbnN0IHM9dGhpcy5idWZmZXJRdWV1ZS5kZXF1ZXVlKCk7cyYmKHMuYWRkQnVmZmVyKGUpLGU9cy5nZXRCdWZmZXIoKSk7Y29uc3QgaT1uZXcgRGF0YVZpZXcoZSksbz1pLmJ5dGVMZW5ndGg7bGV0IHI9LTE7Zm9yKGxldCB0PTA7dDxvLTQ7dCsrKTA9PT1pLmdldFVpbnQ4KHQpJiYwPT09aS5nZXRVaW50OCh0KzEpJiYwPT09aS5nZXRVaW50OCh0KzIpJiYxPT09aS5nZXRVaW50OCh0KzMpJiYoLTEhPT1yJiZ0aGlzLmZyYW1lUmVjZWl2ZShlLnNsaWNlKHIsdCksZChpLmdldFVpbnQ4KHIrNCkpKSxyPXQsdCs9NCk7dGhpcy5mcmFtZVJlY2VpdmUoZS5zbGljZShyLG8pLGQoaS5nZXRVaW50OChyKzQpKSk7Y29uc3Qgbj1lLnNsaWNlKHIsbyk7aWYobi5ieXRlTGVuZ3RoKXt0aGlzLmJ1ZmZlclF1ZXVlLmNyZWF0ZUZyYW1lKCkuYWRkQnVmZmVyKG4pfX1mcmFtZVJlY2VpdmUoZSx0KXtzd2l0Y2godCl7Y2FzZSByLk5BTF9TRUk6Y2FzZSByLk5BTF9TUFM6Y2FzZSByLk5BTF9QUFM6YnJlYWs7Y2FzZSByLk5BTF9TTElDRTpjYXNlIHIuTkFMX1NMSUNFX0lEUjp0aGlzLmRlY29kZXIuYWRkUGVuZGluZ0ZyYW1lcygpO2JyZWFrO2Nhc2Ugci5OQUxfVU5LTk9XTjp9dGhpcy5kZWNvZGVyLnNlbmRCdWZmZXIoZSl9fWZ1bmN0aW9uIGgoZSl7Y29uc3QgdD0oMTI2JmUpPj4xO3N3aXRjaCh0KXtjYXNlIG4uTkFMX1NMSUNFOmNhc2Ugbi5OQUxfU0xJQ0VfSURSOnJldHVybiB0O2Nhc2Ugbi5OQUxfU0xJQ0VfRFBBOmNhc2Ugbi5OQUxfU0xJQ0VfRFBCOmNhc2Ugbi5OQUxfU0xJQ0VfRFBDOnJldHVybiB0O2Nhc2Ugbi5OQUxfU0VJOmNhc2Ugbi5OQUxfU1BTOmNhc2Ugbi5OQUxfUFBTOmNhc2Ugbi5OQUxfVlBTOnJldHVybiB0O2Nhc2Ugbi5OQUxfVU5LTk9XTjpkZWZhdWx0OnJldHVybiBuLk5BTF9VTktOT1dOfX0hZnVuY3Rpb24oZSl7ZVtlLk5BTF9VTktOT1dOPTEwMF09Ik5BTF9VTktOT1dOIixlW2UuTkFMX1NMSUNFPTFdPSJOQUxfU0xJQ0UiLGVbZS5OQUxfU0xJQ0VfRFBBPTJdPSJOQUxfU0xJQ0VfRFBBIixlW2UuTkFMX1NMSUNFX0RQQj0zXT0iTkFMX1NMSUNFX0RQQiIsZVtlLk5BTF9TTElDRV9EUEM9NF09Ik5BTF9TTElDRV9EUEMiLGVbZS5OQUxfU0xJQ0VfSURSPTVdPSJOQUxfU0xJQ0VfSURSIixlW2UuTkFMX1NFST0zOV09Ik5BTF9TRUkiLGVbZS5OQUxfU1BTPTMzXT0iTkFMX1NQUyIsZVtlLk5BTF9QUFM9MzRdPSJOQUxfUFBTIixlW2UuTkFMX1ZQUz0zMl09Ik5BTF9WUFMifShufHwobj17fSkpO2NsYXNzIHV7Y29uc3RydWN0b3IoZSl7dGhpcy5uYW1lPSJoMjY1Iix0aGlzLmRlY29kZXI9dm9pZCAwLHRoaXMuYnVmZmVyUXVldWU9bmV3IG8oMSwicGFyc2VyIGRvd25sb2FkIGJ1ZmZlciBxdWV1ZSIpLHRoaXMuZGVjb2Rlcj1lfXBhcnNlKGUsdCl7Y29uc3Qgcz10aGlzLmJ1ZmZlclF1ZXVlLmRlcXVldWUoKTtzJiYocy5hZGRCdWZmZXIoZSksZT1zLmdldEJ1ZmZlcigpKTtjb25zdCBpPW5ldyBEYXRhVmlldyhlKSxvPWkuYnl0ZUxlbmd0aDtsZXQgcj0tMTtmb3IobGV0IHQ9MDt0PG8tNDt0KyspMD09PWkuZ2V0VWludDgodCkmJjA9PT1pLmdldFVpbnQ4KHQrMSkmJjA9PT1pLmdldFVpbnQ4KHQrMikmJjE9PT1pLmdldFVpbnQ4KHQrMykmJigtMSE9PXImJnRoaXMuZnJhbWVSZWNlaXZlKGUuc2xpY2Uocix0KSxoKGkuZ2V0VWludDgocis0KSkpLHI9dCx0Kz00KTt0JiZ0aGlzLmZyYW1lUmVjZWl2ZShlLnNsaWNlKHIsbyksaChpLmdldFVpbnQ4KHIrNCkpKTtjb25zdCBuPWUuc2xpY2UocixvKTtpZihuLmJ5dGVMZW5ndGgpe3RoaXMuYnVmZmVyUXVldWUuY3JlYXRlRnJhbWUoKS5hZGRCdWZmZXIobil9fWZyYW1lUmVjZWl2ZShlLHQpe3N3aXRjaCh0KXtjYXNlIG4uTkFMX1NFSTpjYXNlIG4uTkFMX1NQUzpjYXNlIG4uTkFMX1BQUzpicmVhaztjYXNlIG4uTkFMX1NMSUNFOmNhc2Ugbi5OQUxfU0xJQ0VfSURSOnRoaXMuZGVjb2Rlci5hZGRQZW5kaW5nRnJhbWVzKCk7YnJlYWs7Y2FzZSBuLk5BTF9VTktOT1dOOn10aGlzLmRlY29kZXIuc2VuZEJ1ZmZlcihlKX19ZnVuY3Rpb24gZihlLHQpe2NvbnN0IHM9KDE0JmUuZ2V0VWludDgodCkpPDwyOSxpPSg2NTUzNCZlLmdldFVpbnQxNih0KzEpKTw8MTQsbz0oNjU1MzQmZS5nZXRVaW50MTYodCszKSk+PjE7cmV0dXJuIE1hdGgucm91bmQoKChzPj4+MCkraStvKS85MCl9ZnVuY3Rpb24gbChlLHQpe2lmKDA9PT1lLmdldFVpbnQ4KHQpJiYwPT09ZS5nZXRVaW50OCh0KzEpJiYxPT09ZS5nZXRVaW50OCh0KzIpKXtzd2l0Y2goZS5nZXRVaW50OCh0KzMpKXtjYXNlIGEuVklERU86cmV0dXJue3R5cGU6InZpZGVvIixwdHM6ZihlLHQrOSksbGVuZ3RoOmUuZ2V0VWludDE2KHQrNCl9O2Nhc2UgYS5BVURJTzpyZXR1cm57dHlwZToiYXVkaW8iLHB0czpmKGUsdCs5KSxsZW5ndGg6ZS5nZXRVaW50MTYodCs0KX07ZGVmYXVsdDpyZXR1cm4hMX19fSFmdW5jdGlvbihlKXtlW2UuVklERU89MjI0XT0iVklERU8iLGVbZS5BVURJTz0xOTJdPSJBVURJTyJ9KGF8fChhPXt9KSk7Y2xhc3MgTHtjb25zdHJ1Y3RvcihlKXt0aGlzLm5hbWU9InBzIHN0cmVhbSIsdGhpcy5kZWNvZGVyPXZvaWQgMCx0aGlzLmRlY29kZXI9ZX1wYXJzZShlKXtjb25zdCB0PW5ldyBEYXRhVmlldyhlKSxzPXQuYnl0ZUxlbmd0aDtmb3IobGV0IGU9MDtlPHMtNDtlKyspe2NvbnN0IHM9bCh0LGUpO3MmJih0aGlzLmRlY29kZXIuYWRkUGVuZGluZ0ZyYW1lcyhzLnB0cyxzLnR5cGUpLGUrPXMubGVuZ3RoLTEpfXRoaXMuZGVjb2Rlci5zZW5kQnVmZmVyKGUpfX1sZXQgRTshZnVuY3Rpb24oZSl7ZS5MT0FEPSIweDAwMDAwMDAxIixlLk1PRFVMRT0iTU9EVUxFIixlLklOSVQ9IjB4MDAwMDAwMTAiLGUuREVTVE9SWT0iREVTVE9SWSIsZS5PUEVOPSIweDAwMDAwMTAwIixlLkZMVVNIPSJGTFVTSCIsZS5SRUNFSVZFPSIweDAwMDAxMDAwIixlLlZJREVPPSJWSURFTyIsZS5BVURJTz0iQVVESU8iLGUuU1RBUlQ9IjB4MDAwMTAwMDAiLGUuU1RPUD0iMHgwMDEwMDAwMCIsZS5ERUNPREU9IjB4MDEwMDAwMDAiLGUuRkFJTEVEPSIweDEwMDAwMDAwIn0oRXx8KEU9e30pKTtjb25zdCBtPUU7bGV0IEE7IWZ1bmN0aW9uKGUpe2UuRVJST1I9ImVycm9yIixlLkxPQURJTkdfQ09NUExFVEU9ImxvYWRpbmdfY29tcGxldGUiLGUuUkVDT1ZFUkVEX0VBUkxZX0VPRj0icmVjb3ZlcmVkX2Vhcmx5X2VvZiIsZS5NRURJQV9JTkZPPSJtZWRpYV9pbmZvIixlLk1FVEFEQVRBX0FSUklWRUQ9Im1ldGFkYXRhX2Fycml2ZWQiLGUuU0NSSVBUREFUQV9BUlJJVkVEPSJzY3JpcHRkYXRhX2Fycml2ZWQiLGUuU1RBVElTVElDU19JTkZPPSJzdGF0aXN0aWNzX2luZm8ifShBfHwoQT17fSkpO2NvbnN0IE49bmV3IHMoImRlY29kZXJXb3JrZXIiKTtjbGFzcyBne2NvbnN0cnVjdG9yKCl7dGhpcy5Nb2R1bGU9dm9pZCAwLHRoaXMudmlkZW9QYXJhbXM9dm9pZCAwLHRoaXMuYXVkaW9QYXJhbXM9dm9pZCAwLHRoaXMuZGVjb2RlRnJhbWU9dm9pZCAwLHRoaXMuaW50ZXJ2YWw9dm9pZCAwLHRoaXMuaW50ZXJ2YWxUaW1lPTEwLHRoaXMuZGVjb2RlVGltZT0wLHRoaXMubG9hZENhbGxiYWNrPShlLHQscyxpKT0+e3RoaXMudmlkZW9QYXJhbXM9e2hlaWdodDplLHdpZHRoOnQscmF0ZTpzfSxOLmRlYnVnKCJ2aWRlbyBwYXJhbXMiLHRoaXMudmlkZW9QYXJhbXMpLGkvPTQ7Y29uc3Qgbz10aGlzLk1vZHVsZS5IRUFQVTMyLnN1YmFycmF5KGksaSszKTswPT09b1swXT9OLmRlYnVnKCJubyBhdWRpbyBzdHJlYW0iKToodGhpcy5hdWRpb1BhcmFtcz17c2FtcGxlRm10Om9bMF0sY2hhbm5lbHM6b1sxXSxzYW1wbGVSYXRlOm9bMl19LE4uZGVidWcoImF1ZGlvIHN0cmVhbSIsdGhpcy5hdWRpb1BhcmFtcykpfSx0aGlzLnZpZGVvQ2FsbGJhY2s9KGUsdCxzKT0+e2NvbnN0IGk9dGhpcy5Nb2R1bGUuSEVBUFU4LnN1YmFycmF5KGUsZSt0KSxvPW5ldyBVaW50OEFycmF5KGkpO3RoaXMuZGVjb2RlVGltZT1EYXRlLm5vdygpLXRoaXMuZGVjb2RlVGltZSx0aGlzLmRlY29kZUZyYW1lPXt0eXBlOiJ2aWRlbyIsdGltZTpzLGRlY29kZVRpbWU6dGhpcy5kZWNvZGVUaW1lLGJ1ZmZlcjpvfX0sdGhpcy5hdWRpb0NhbGxiYWNrPShlLHQscyk9Pntjb25zdCBpPXRoaXMuTW9kdWxlLkhFQVBVOC5zdWJhcnJheShlLGUrdCksbz1uZXcgVWludDhBcnJheShpKTt0aGlzLmRlY29kZVRpbWU9RGF0ZS5ub3coKS10aGlzLmRlY29kZVRpbWUsdGhpcy5kZWNvZGVGcmFtZT17dHlwZToiYXVkaW8iLHRpbWU6cyxkZWNvZGVUaW1lOnRoaXMuZGVjb2RlVGltZSxidWZmZXI6b319LHRoaXMuTW9kdWxlPU1vZHVsZSx0aGlzLnZpZGVvUGFyYW1zPXt3aWR0aDowLGhlaWdodDowLHJhdGU6MH0sdGhpcy5Nb2R1bGUuX3NldExvZ0xldmVsKDApfWluaXREZWNvZGVyKCl7Y29uc3QgZT10aGlzLk1vZHVsZS5hZGRGdW5jdGlvbih0aGlzLmxvYWRDYWxsYmFjayksdD10aGlzLk1vZHVsZS5hZGRGdW5jdGlvbih0aGlzLnZpZGVvQ2FsbGJhY2spLHM9dGhpcy5Nb2R1bGUuYWRkRnVuY3Rpb24odGhpcy5hdWRpb0NhbGxiYWNrKTt0aGlzLk1vZHVsZS5faW5pdERlY29kZXIoZSx0LHMpLE4uZGVidWcoImluaXQgZGVjb2RlcldvcmtlciBzdWNjZXNzIil9ZGVzdG9yeURlY29kZXIoKXt0aGlzLk1vZHVsZS5fZGVzdG9yeURlY29kZXIoKX1vcGVuRGVjb2RlcihlKXt0aGlzLk1vZHVsZS5fb3BlbkRlY29kZXIoZSk7cmV0dXJuIE4uZGVidWcoIm9wZW4gZGVjb2RlcldvcmtlciBzdWNjZXNzIikse3ZpZGVvOnRoaXMudmlkZW9QYXJhbXMsYXVkaW86dGhpcy5hdWRpb1BhcmFtc319Zmx1c2hCdWZmZXJzKCl7dGhpcy5Nb2R1bGUuX2ZsdXNoQnVmZmVycygpfWRlb2NkZSgpe3JldHVybiB0aGlzLmRlY29kZVRpbWU9RGF0ZS5ub3coKSwwIT09dGhpcy5Nb2R1bGUuX2RlY29kaW5nKCk/bnVsbDp0aGlzLmRlY29kZUZyYW1lfXNlbmRQYWNrZXQoZSl7Y29uc3QgdD1uZXcgVWludDhBcnJheShlKSxzPU1vZHVsZS5fbWFsbG9jKHQuYnl0ZUxlbmd0aCk7TW9kdWxlLkhFQVBVOC5zZXQodCxzKSxNb2R1bGUuX3NlbmRQYWNrZXQocyx0LmJ5dGVMZW5ndGgpfX12YXIgRDshZnVuY3Rpb24oZSl7ZVtlLlVOS05PV049MF09IlVOS05PV04iLGVbZS5MT0FEPTFdPSJMT0FEIixlW2UuUkVDRUlWRVNQUz0yXT0iUkVDRUlWRVNQUyIsZVtlLlBSRVBBUkU9NF09IlBSRVBBUkUiLGVbZS5ERUNPREU9OF09IkRFQ09ERSIsZVtlLkRFQ09ESU5HPTE2XT0iREVDT0RJTkciLGVbZS5QQVVTRT0zMl09IlBBVVNFIixlW2UuV0FTTUJVRkZFUkZVTEw9NjRdPSJXQVNNQlVGRkVSRlVMTCIsZVtlLkRPV05MQlVGRkVSPTEyOF09IkRPV05MQlVGRkVSIixlW2UuQlVGRkVSRlVMTD0yNTZdPSJCVUZGRVJGVUxMIixlW2UuRE9XTkxPQURET1dOPTUxMl09IkRPV05MT0FERE9XTiIsZVtlLkRPTkU9MTAyNF09IkRPTkUifShEfHwoRD17fSkpO2NvbnN0IF89bmV3IHMoImRlY29kZXIiKTtjbGFzcyBwe2NvbnN0cnVjdG9yKGUpe3RoaXMucHJvcHM9dm9pZCAwLHRoaXMuZGVjb2RlckhlbHBlcj12b2lkIDAsdGhpcy5tb2R1bGU9dm9pZCAwLHRoaXMubG9hZGVkPXZvaWQgMCx0aGlzLmVmZmVjdFRhZz1ELlVOS05PV04sdGhpcy53YXRjaGVkVHlwZT17fSx0aGlzLmRvd25sb2FkQnl0ZXM9MCx0aGlzLmZyYW1lc0J1ZmZlckxJTVQ9MCx0aGlzLl9vbmVycm9yPW51bGwsdGhpcy5vblZpZGVvRnJhbWVEZWNvZGU9dm9pZCAwLHRoaXMuZG93bmxvYWRRdWV1ZT1uZXcgbygxMDAsImRlY29kZSBkb3dubG9hZCBxdWV1ZSIpLHRoaXMucGVuZGluZ0ZyYW1lcz0wLHRoaXMudmlkZW9RdWV1ZT1bXSx0aGlzLmF1ZGlvUXVldWU9W10sdGhpcy5jb21taXRGcmFtZXM9MCx0aGlzLkxJTUlURlJBTUVTPTE1ZTMsdGhpcy5XQVNNTElNSVQ9NmUzLHRoaXMucHJvYnNpemU9NTI0Mjg4LHRoaXMubG9zc0ZyYW1lcz0wLHRoaXMub25Eb3dubG9hZEJ1ZmZlcj1lPT57dGhpcy5kb3dubG9hZEJ5dGVzKz1lLmJ5dGVMZW5ndGgsdGhpcy5kZWNvZGVySGVscGVyLnBhcnNlKGUsITEpLHRoaXMub25GcmFtZVJlY2VpdmUoKX0sdGhpcy5vbkZyYW1lUmVjZWl2ZT0oKT0+e350aGlzLmVmZmVjdFRhZyZELlBSRVBBUkUmJnRoaXMuZG93bmxvYWRCeXRlcz49dGhpcy5wcm9ic2l6ZSYmKHRoaXMuZWZmZWN0VGFnJj1+RC5SRUNFSVZFU1BTLHRoaXMuZWZmZWN0VGFnfD1ELlBSRVBBUkUsdGhpcy5vcGVuRGVjb2RlcigpLHRoaXMuZWZmZWN0VGFnfD1ELkRFQ09ERSl9LHRoaXMuZGVjb2RlTG9vcD0oKT0+e3RoaXMuZWZmZWN0VGFnJkQuUEFVU0V8fCh0aGlzLnBlbmRpbmdGcmFtZXM+MD90aGlzLmRlY29kZU9uY2UoKTp0aGlzLmVmZmVjdFRhZyZELkRPV05MQlVGRkVSfHx0aGlzLmVmZmVjdFRhZyZELkRPV05MT0FERE9XTiYmKHRoaXMuZWZmZWN0VGFnfD1ELkRPTkUpLHNldFRpbWVvdXQodGhpcy5kZWNvZGVMb29wLDUpKX0sdGhpcy53YWl0QnVmZmVyRGVjb2RlPSgpPT57aWYoKHRoaXMuZWZmZWN0VGFnJkQuRE9XTkxCVUZGRVIpIT09RC5ET1dOTEJVRkZFUilyZXR1cm47Y29uc3QgZT10aGlzLmRvd25sb2FkUXVldWUuZGVxdWV1ZSgpO3JlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLndhaXRCdWZmZXJEZWNvZGUpLGUmJih0aGlzLnBlbmRpbmdGcmFtZXM+MTB8fCh0aGlzLm1vZHVsZS5zZW5kUGFja2V0KGUuZ2V0QnVmZmVyKCkpLHRoaXMuZGVjb2RlT25jZSgpKSl9LHRoaXMucHJvcHM9ZSx0aGlzLmxvYWQoKX1sb2FkKCl7Xy53YXJuKHRoaXMuZWZmZWN0VGFnJkQuTE9BRCwiZGVjb2RlciBoYXMgYmUgbG9hZGVkIil8fChfLmRlYnVnKCJzdGFydCB0byBpbml0IGRlY29kZXIiKSx0aGlzLm1vZHVsZT1uZXcgZyx0aGlzLmRlY29kZXJIZWxwZXI9ZnVuY3Rpb24oZSx0KXtzd2l0Y2goZSl7Y2FzZSJoMjY0IjpyZXR1cm4gbmV3IGModCk7Y2FzZSJoMjY1IjpyZXR1cm4gbmV3IHUodCk7Y2FzZSJwcyI6cmV0dXJuIG5ldyBMKHQpO2RlZmF1bHQ6cmV0dXJuIG5ldyBjKHQpfX0oInBzIix0aGlzKSxfLmRlYnVnKCJnZXQgZGVvY2RlIHR5cGUgcyUiLHRoaXMuZGVjb2RlckhlbHBlci5uYW1lKSx0aGlzLm1vZHVsZS5pbml0RGVjb2RlcigpKX1vcGVuRGVjb2Rlcigpe2NvbnN0IGU9dGhpcy5tb2R1bGUub3BlbkRlY29kZXIodGhpcy5wcm9ic2l6ZSk7cmV0dXJuIHRoaXMucHJvcHMuc2VuZE1lc3NhZ2UoRS5PUEVOLGUpLGV9c3RhcnREZWNvZGluZygpe3RoaXMuZWZmZWN0VGFnJkQuREVDT0RJTkd8fHRoaXMuZWZmZWN0VGFnJkQuREVDT0RFJiYoXy5kZWJ1Zygic3RhcnQgbG9vcCBkZWNvZGUiKSx0aGlzLmVmZmVjdFRhZ3w9RC5ERUNPRElORyx0aGlzLmVmZmVjdFRhZyY9fkQuUEFVU0UsdGhpcy5kZWNvZGVMb29wKCkpfWRlY29kZU9uY2UoKXtpZih0aGlzLmVmZmVjdFRhZyZELkRFQ09ERSl7Y29uc3QgZT10aGlzLm1vZHVsZS5kZW9jZGUoKTtpZih0aGlzLnNldFBlbmRpbmdGcmFtZXMoITEpLCFlKXJldHVybiB2b2lkIHRoaXMucHJvcHMuc2VuZE1lc3NhZ2UoRS5GQUlMRUQse3BlbmRpbmc6dGhpcy5wZW5kaW5nRnJhbWVzfSk7Y29uc3R7dHlwZTp0LGJ1ZmZlcjpzLHRpbWU6aSxkZWNvZGVUaW1lOm99PWU7aWYoInZpZGVvIj09PXQpe2NvbnN0IGU9dGhpcy52aWRlb1F1ZXVlLnNoaWZ0KCk7dGhpcy5wcm9wcy5zZW5kTWVzc2FnZShFLlZJREVPLHtwZW5kaW5nOnRoaXMucGVuZGluZ0ZyYW1lcyx0aW1lOmksZGVjb2RlVGltZTpvLHRpbWVzdGFtcDplLnB0cyxzdHJlYW06dH0scyl9ZWxzZXtjb25zdCBlPXRoaXMuYXVkaW9RdWV1ZS5zaGlmdCgpO3RoaXMucHJvcHMuc2VuZE1lc3NhZ2UoRS5BVURJTyx7cGVuZGluZzp0aGlzLnBlbmRpbmdGcmFtZXMsdGltZTppLGRlY29kZVRpbWU6byx0aW1lc3RhbXA6ZS5wdHMsc3RyZWFtOnR9LHMpfX19c3RvcERlY29kaW5nKCl7Xy5kZWJ1Zygic3RvcCBsb29wIGRlY29kZSIpLHRoaXMuZWZmZWN0VGFnfD1ELlBBVVNFLHRoaXMuZWZmZWN0VGFnJj1+RC5ERUNPRElOR31zZWVrRGVjb2RpbmcoKXt9Zmx1c2hCdWZmZXJzKCl7dGhpcy5wZW5kaW5nRnJhbWVzPTAsdGhpcy52aWRlb1F1ZXVlPVtdLHRoaXMuYXVkaW9RdWV1ZT1bXSx0aGlzLm1vZHVsZS5mbHVzaEJ1ZmZlcnMoKX1zZXRQZW5kaW5nRnJhbWVzKGUpe2U/dGhpcy5wZW5kaW5nRnJhbWVzKys6dGhpcy5wZW5kaW5nRnJhbWVzLS0sdGhpcy5wZW5kaW5nRnJhbWVzPj10aGlzLkxJTUlURlJBTUVTP3RoaXMuZWZmZWN0VGFnfD1ELkJVRkZFUkZVTEw6dGhpcy5wZW5kaW5nRnJhbWVzPj10aGlzLldBU01MSU1JVD9ELkRPV05MQlVGRkVSJn50aGlzLmVmZmVjdFRhZyYmKHRoaXMuZWZmZWN0VGFnfD1ELkRPV05MQlVGRkVSfEQuV0FTTUJVRkZFUkZVTEwsdGhpcy53YWl0QnVmZmVyRGVjb2RlKCkpOih0aGlzLmVmZmVjdFRhZyZELkJVRkZFUkZVTEx8fHRoaXMuZWZmZWN0VGFnJkQuV0FTTUJVRkZFUkZVTEwpJiYodGhpcy5lZmZlY3RUYWcmPX4oRC5XQVNNQlVGRkVSRlVMTHxELkJVRkZFUkZVTEwpKSx0aGlzLnBlbmRpbmdGcmFtZXM+NTAwJiZ0aGlzLmZsdXNoQnVmZmVycygpfWFkZFBlbmRpbmdGcmFtZXMoZSx0KXtlJiYoImF1ZGlvIj09PXQ/dGhpcy5hdWRpb1F1ZXVlLnB1c2goe3B0czplfSk6dGhpcy52aWRlb1F1ZXVlLnB1c2goe3B0czplfSkpLHRoaXMuc2V0UGVuZGluZ0ZyYW1lcyghMCl9c2VuZEJ1ZmZlcihlKXt0aGlzLm1vZHVsZS5zZW5kUGFja2V0KGUpfWRlc3RvcnkoKXt0aGlzLnN0b3BEZWNvZGluZygpLHRoaXMubW9kdWxlLmRlc3RvcnlEZWNvZGVyKCl9aXNEb25lKCl7cmV0dXJuISEodGhpcy5lZmZlY3RUYWcmRC5ET05FKX19Y29uc3QgUz1uZXcgcygid2Vid29ya2VyIik7bGV0IEY7Y29uc3R7b3JpZ2luOkl9PWdsb2JhbFRoaXMubG9jYXRpb24sUD1gJHtJfS9iY2xpZW50L2NvbW1vbnJlc291cmNlL29jeC5qc2AsVT1gJHtJfS9iY2xpZW50L2NvbW1vbnJlc291cmNlL29jeC53YXNtYDtsZXQgTztvbm1lc3NhZ2U9ZnVuY3Rpb24oZSl7bGV0IHQ9bnVsbCxzPW51bGw7c3dpdGNoKGUuZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyPyh0PW0uUkVDRUlWRSxzPWUuZGF0YSk6KHQ9ZS5kYXRhLnR5cGUscz1lLmRhdGEpLHQpe2Nhc2UgbS5JTklUOnNlbGYuTW9kdWxlPXtub0luaXRpYWxSdW46ITAsb25SdW50aW1lSW5pdGlhbGl6ZWQoKXtPPW5ldyBwKHtzZW5kTWVzc2FnZTpifSksYihFLkxPQUQpfSxsb2NhdGVGaWxlOihlLHQpPT5gJHtJfS9iY2xpZW50L2NvbW1vbnJlc291cmNlLyR7ZX1gLG1haW5TY3JpcHRVcmxPckJsb2I6UCxhc3luYyBpbnN0YW50aWF0ZVdhc20oZSx0KXtpZihGKXtyZXR1cm4gdm9pZCB0KGF3YWl0IFdlYkFzc2VtYmx5Lmluc3RhbnRpYXRlKEYsZSksRil9bGV0IHM7e2NvbnN0IHQ9bmV3IFhNTEh0dHBSZXF1ZXN0O3Qub3BlbigiR0VUIixVLCExKSx0LnJlc3BvbnNlVHlwZT0iYXJyYXlidWZmZXIiLHQuc2VuZChudWxsKTtjb25zdCBpPW5ldyBVaW50OEFycmF5KHQucmVzcG9uc2UpO3M9YXdhaXQgV2ViQXNzZW1ibHkuaW5zdGFudGlhdGUoaSxlKX1iKEUuTU9EVUxFLHttb2R1bGU6Rn0pLHQocy5pbnN0YW5jZSxzLm1vZHVsZSl9fSxpbXBvcnRTY3JpcHRzKFApO2JyZWFrO2Nhc2UgbS5NT0RVTEU6Rj1zLm1vZHVsZTticmVhaztjYXNlIG0uU1RBUlQ6Ty5zdGFydERlY29kaW5nKCk7YnJlYWs7Y2FzZSBtLlNUT1A6Ty5zdG9wRGVjb2RpbmcoKTticmVhaztjYXNlIG0uREVDT0RFOmJyZWFrO2Nhc2UgbS5SRUNFSVZFOk8ub25Eb3dubG9hZEJ1ZmZlcihzKTticmVhaztjYXNlIG0uRkxVU0g6Ty5mbHVzaEJ1ZmZlcnMoKTticmVhaztjYXNlIG0uREVTVE9SWTpzZWxmLk1vZHVsZS5kZXN0b3J5KCksTz1udWxsO2JyZWFrO2RlZmF1bHQ6Uy5lcnJvcighMCxgbm8gdHlwZSAke3R9YCl9fTtjb25zdCBiPShlLHQscyk9PntzP3Bvc3RNZXNzYWdlKHt0eXBlOmUsLi4udCxidWZmZXI6c30sW3MuYnVmZmVyXSk6cG9zdE1lc3NhZ2Uoe3R5cGU6ZSwuLi50fSl9OwoK",null,!1),k=new c("DecoderManager"),M=window.navigator.hardwareConcurrency;let N,I=0,C=!0;const F=[];function A(e){if("status"in e)return e;const[t,s]=d();return N&&e.postMessage(N),e.postMessage({type:x.INIT}),e.onmessage=s=>{const{type:n}=s.data;n===L.LOAD?t[0](e):n===L.MODULE&&(N=s.data)},s}async function B(){if(!C&&!N)for(;await new Promise(e=>setTimeout(e,1e3)),!N;);return C=!1,F.length>0?A(F.pop()):A(new X())}const Y={create:function(e){return k.warn(I>=M,`当前总播放数${I}, 推荐播放数${M}`),new W(e,B)},destory:function e(t){if(!t)return;I--;const s=t.decodeWorker;if(t.statusUtil.hasStatus(U.OPEN))s.postMessage({type:x.DESTORY}),s.terminate();else{if(!t.statusUtil.hasStatus(U.LOAD))return void setTimeout(()=>{e(t)},1e3);s.status="load",F.push(s)}t=null}};var D;!function(e){e[e.INIT=1]="INIT",e[e.START=2]="START",e[e.PAUSE=4]="PAUSE",e[e.RESUME=8]="RESUME",e[e.COMPLETE=16]="COMPLETE"}(D||(D={}));class z{constructor(e){this.options=void 0,this.log=void 0,this.currentTime=void 0,this.currentCacheDuration=void 0,this.status=void 0,this.statusUtil=o(this),this.checktime=void 0,this.options=e,this.log=new c(e.unit)}checkstatus(){const{minimum:e,maximum:t,getValue:s,isDone:n}=this.options;if(n())return void this.complete();const i=s();i>t?this.pause():i<e&&this.resume()}checkloop(){this.checktime=window.setTimeout(()=>{this.checkloop(),this.checkstatus()},1e3)}startCheck(){this.statusUtil.hasStatus(D.START)||(this.statusUtil.setStatus(D.START),this.checkstatus(),this.checkloop())}cancelCheck(){this.statusUtil.setStatus(D.INIT),clearTimeout(this.checktime)}pause(){this.statusUtil.hasStatus(D.PAUSE)||(this.statusUtil.replaceStatus(D.RESUME,D.PAUSE),this.options.pause())}resume(){this.statusUtil.hasStatus(D.RESUME)||(this.statusUtil.replaceStatus(D.PAUSE,D.RESUME),this.options.resume())}complete(){this.statusUtil.contactStatus(D.PAUSE),this.statusUtil.contactStatus(D.RESUME),this.statusUtil.contactStatus(D.COMPLETE),this.cancelCheck()}}const P="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0),_=P&&"function"==typeof module.require?module.require:null;const J=function(e,t=null,s=!1){const n=P?function(e,t){return Buffer.from(e,"base64").toString(t?"utf16":"utf8")}(e,s):function(e,t){const s=atob(e);if(t){const e=new Uint8Array(s.length);return Array.prototype.forEach.call(e,(e,t,n)=>{n[t]=s.charCodeAt(t)}),String.fromCharCode.apply(null,new Uint16Array(e.buffer))}return s}(e,s),i=n.indexOf("\n",10)+1,r=n.substring(i)+(t?`//# sourceMappingURL=${t}`:"");if(_){const e=_("worker_threads").Worker;return function(t){return new e(r,Object.assign({},t,{eval:!0}))}}const o=new Blob([r],{type:"application/javascript"}),a=URL.createObjectURL(o);return function(e){return new Worker(a,e)}}("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwpsZXQgZT0wO2NvbnN0IHQ9WyIjZDY0ZTRlIiwiI2JhZGE1NSIsIiM3ZWM2OTkiXTtjbGFzcyBye2NvbnN0cnVjdG9yKHIpe3RoaXMubmFtZT12b2lkIDAsdGhpcy5jb2xvcj12b2lkIDAsdGhpcy5uYW1lPXIsdGhpcy5jb2xvcj1gXG4gICAgY29sb3I6ICR7dFtlXX07XG4gICAgZm9udC1zdHlsZTogaXRhbGljO1xuICAgIHBhZGRpbmc6IDJweDtcbiAgICB3aWR0aDogMTAwcHg7XG4gIGAsZSsrfWxvZyhlLC4uLnQpe2NvbnNvbGVbZV0oYCVjJHt0aGlzLm5hbWV9OmAsdGhpcy5jb2xvciwuLi50KX1pbmZvKGUsLi4udCl7ZSYmdGhpcy5sb2coImxvZyIsLi4udCl9Z3JvdXAoLi4uZSl7fWdyb3VwRW5kKC4uLmUpe31kZWJ1ZyguLi5lKXt9d2FybihlLHQsLi4ucil7cmV0dXJuIGUmJmNvbnNvbGUubG9nKGAlYyR7dGhpcy5uYW1lfTpgLHRoaXMuY29sb3IsdCwuLi5yKSxlfWVycm9yKGUsLi4udCl7cmV0dXJuIGUmJnRoaXMubG9nKCJlcnJvciIsLi4udCksZX19ci5sZXZlbD0xO2NvbnN0IGk9bmV3IHIoIndlYmdsIik7Y2xhc3Mgc3tjb25zdHJ1Y3RvcihlLHQscixpKXt0aGlzLmdsPXZvaWQgMCx0aGlzLnRleHR1cmU9dm9pZCAwLHRoaXMuZmlsbD0oZSx0LHIpPT57Y29uc3QgaT10aGlzLmdsO2kuYmluZFRleHR1cmUoaS5URVhUVVJFXzJELHRoaXMudGV4dHVyZSksaS50ZXhJbWFnZTJEKGkuVEVYVFVSRV8yRCwwLGkuTFVNSU5BTkNFLGUsdCwwLGkuTFVNSU5BTkNFLGkuVU5TSUdORURfQllURSxyKX0sdGhpcy5nbD1lLGUuYWN0aXZlVGV4dHVyZShbZS5URVhUVVJFMCxlLlRFWFRVUkUxLGUuVEVYVFVSRTJdW2ldKSx0aGlzLnRleHR1cmU9ZS5jcmVhdGVUZXh0dXJlKCksZS5iaW5kVGV4dHVyZShlLlRFWFRVUkVfMkQsdGhpcy50ZXh0dXJlKSxlLnRleFBhcmFtZXRlcmkoZS5URVhUVVJFXzJELGUuVEVYVFVSRV9XUkFQX1MsZS5DTEFNUF9UT19FREdFKSxlLnRleFBhcmFtZXRlcmkoZS5URVhUVVJFXzJELGUuVEVYVFVSRV9XUkFQX1QsZS5DTEFNUF9UT19FREdFKSxlLnRleFBhcmFtZXRlcmkoZS5URVhUVVJFXzJELGUuVEVYVFVSRV9NSU5fRklMVEVSLGUuTElORUFSKSxlLnRleFBhcmFtZXRlcmkoZS5URVhUVVJFXzJELGUuVEVYVFVSRV9NQUdfRklMVEVSLGUuTElORUFSKSxlLnVuaWZvcm0xaShlLmdldFVuaWZvcm1Mb2NhdGlvbih0LHIpLGkpfX1jbGFzcyBhe2NvbnN0cnVjdG9yKGUpe3RoaXMuY2FudmFzPXZvaWQgMCx0aGlzLmdsPXZvaWQgMCx0aGlzLnk9dm9pZCAwLHRoaXMudT12b2lkIDAsdGhpcy52PXZvaWQgMCx0aGlzLnN0b3BSZW5kZXI9ITEsdGhpcy5jYW52YXM9ZSx0aGlzLmdsPWUuZ2V0Q29udGV4dCgid2ViZ2wyIix7cHJlc2VydmVEcmF3aW5nQnVmZmVyOiEwfSksdGhpcy5pbml0KCl9aW5pdCgpe2NvbnN0IGU9dGhpcy5nbDtpZihpLndhcm4oIWUsImdsIG5vdCBzdXBwb3J077yBIikpcmV0dXJuO2UucGl4ZWxTdG9yZWkoZS5VTlBBQ0tfQUxJR05NRU5ULDQpO2NvbnN0IHQ9dGhpcy5jb21waWxlU2hhZGVyKCJcbiAgICAgIGF0dHJpYnV0ZSBsb3dwIHZlYzQgYV92ZXJ0ZXhQb3NpdGlvbjtcbiAgICAgIGF0dHJpYnV0ZSB2ZWMyIGFfdGV4dHVyZVBvc2l0aW9uO1xuICAgICAgdmFyeWluZyB2ZWMyIHZfdGV4Q29vcmQ7XG4gICAgICB2b2lkIG1haW4oKSB7XG4gICAgICAgIGdsX1Bvc2l0aW9uID0gYV92ZXJ0ZXhQb3NpdGlvbjtcbiAgICAgICAgdl90ZXhDb29yZCA9IGFfdGV4dHVyZVBvc2l0aW9uO1xuICAgICAgfVxuICAgICIsZS5WRVJURVhfU0hBREVSKSxyPXRoaXMuY29tcGlsZVNoYWRlcigiXG4gICAgICBwcmVjaXNpb24gbG93cCBmbG9hdDtcbiAgICAgIHVuaWZvcm0gc2FtcGxlcjJEIHNhbXBsZXJZO1xuICAgICAgdW5pZm9ybSBzYW1wbGVyMkQgc2FtcGxlclU7XG4gICAgICB1bmlmb3JtIHNhbXBsZXIyRCBzYW1wbGVyVjtcbiAgICAgIHZhcnlpbmcgdmVjMiB2X3RleENvb3JkO1xuICAgICAgdm9pZCBtYWluKCkge1xuICAgICAgICBmbG9hdCByLGcsYix5LHUsdixmWW11bDtcbiAgICAgICAgeSA9IHRleHR1cmUyRChzYW1wbGVyWSwgdl90ZXhDb29yZCkucjtcbiAgICAgICAgdSA9IHRleHR1cmUyRChzYW1wbGVyVSwgdl90ZXhDb29yZCkucjtcbiAgICAgICAgdiA9IHRleHR1cmUyRChzYW1wbGVyViwgdl90ZXhDb29yZCkucjtcblxuICAgICAgICBmWW11bCA9IHkgKiAxLjE2NDM4MjgxMjU7XG4gICAgICAgIHIgPSBmWW11bCArIDEuNTk2MDI3MzQzNzUgKiB2IC0gMC44NzA3ODc1OTg7XG4gICAgICAgIGcgPSBmWW11bCAtIDAuMzkxNzYxNzE4NzUgKiB1IC0gMC44MTI5Njg3NSAqIHYgKyAwLjUyOTU5Mzc1O1xuICAgICAgICBiID0gZlltdWwgKyAyLjAxNzIzMDQ2ODc1ICogdSAtIDEuMDgxMzg5MTYwMzc1O1xuICAgICAgICBnbF9GcmFnQ29sb3IgPSB2ZWM0KHIsIGcsIGIsIDEuMCk7XG4gICAgICB9IixlLkZSQUdNRU5UX1NIQURFUiksYT10aGlzLmNyZWF0ZVByb2dyYW0odCxyKTt0aGlzLmluaXRWZXJ0ZXhCdWZmZXJzKGEpLHRoaXMueT1uZXcgcyhlLGEsInNhbXBsZXJZIiwwKSx0aGlzLnU9bmV3IHMoZSxhLCJzYW1wbGVyVSIsMSksdGhpcy52PW5ldyBzKGUsYSwic2FtcGxlclYiLDIpfWNvbXBpbGVTaGFkZXIoZSx0KXtjb25zdCByPXRoaXMuZ2wuY3JlYXRlU2hhZGVyKHQpO2lmKHRoaXMuZ2wuc2hhZGVyU291cmNlKHIsZSksdGhpcy5nbC5jb21waWxlU2hhZGVyKHIpLCF0aGlzLmdsLmdldFNoYWRlclBhcmFtZXRlcihyLHRoaXMuZ2wuQ09NUElMRV9TVEFUVVMpKXtjb25zdCBlPXRoaXMuZ2wuZ2V0U2hhZGVySW5mb0xvZyhyKTt0aGlzLmdsLmRlbGV0ZVNoYWRlcihyKSxpLmVycm9yKCEwLCJjb3VsZCBub3QgY29tcGlsZSBzaGFkZXIiLGUpfXJldHVybiByfWNyZWF0ZVByb2dyYW0oZSx0KXtjb25zdCByPXRoaXMuZ2wscz1yLmNyZWF0ZVByb2dyYW0oKTtyLmF0dGFjaFNoYWRlcihzLGUpLHIuYXR0YWNoU2hhZGVyKHMsdCksci5saW5rUHJvZ3JhbShzKSxyLnVzZVByb2dyYW0ocyk7Y29uc3QgYT1yLmdldFByb2dyYW1QYXJhbWV0ZXIocyx0aGlzLmdsLkxJTktfU1RBVFVTKTtyZXR1cm4gaS5lcnJvcighYSwicHJvZ3JhbSBmYWlsIHRvIGxpbmsiK3IuZ2V0U2hhZGVySW5mb0xvZyh0KSksc31pbml0VmVydGV4QnVmZmVycyhlKXtjb25zdCB0PXRoaXMuZ2wscj10LmNyZWF0ZUJ1ZmZlcigpLGk9bmV3IEZsb2F0MzJBcnJheShbMSwxLDAsLTEsMSwwLDEsLTEsMCwtMSwtMSwwXSk7dC5iaW5kQnVmZmVyKHQuQVJSQVlfQlVGRkVSLHIpLHQuYnVmZmVyRGF0YSh0LkFSUkFZX0JVRkZFUixpLHQuU1RBVElDX0RSQVcpO2NvbnN0IHM9dC5nZXRBdHRyaWJMb2NhdGlvbihlLCJhX3ZlcnRleFBvc2l0aW9uIik7dC52ZXJ0ZXhBdHRyaWJQb2ludGVyKHMsMyx0LkZMT0FULCExLDAsMCksdC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheShzKTtjb25zdCBhPW5ldyBGbG9hdDMyQXJyYXkoWzEsMCwwLDAsMSwxLDAsMV0pLG89dC5jcmVhdGVCdWZmZXIoKTt0LmJpbmRCdWZmZXIodC5BUlJBWV9CVUZGRVIsbyksdC5idWZmZXJEYXRhKHQuQVJSQVlfQlVGRkVSLGEsdC5TVEFUSUNfRFJBVyk7Y29uc3Qgbj10LmdldEF0dHJpYkxvY2F0aW9uKGUsImFfdGV4dHVyZVBvc2l0aW9uIik7dC52ZXJ0ZXhBdHRyaWJQb2ludGVyKG4sMix0LkZMT0FULCExLDAsMCksdC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheShuKX1yZW5kZXJGcmFtZShlLHQscil7aWYodGhpcy5zdG9wUmVuZGVyKXJldHVybjtjb25zdCBpPXRoaXMuZ2w7aS52aWV3cG9ydCgwLDAsaS5jYW52YXMud2lkdGgsaS5jYW52YXMuaGVpZ2h0KSxpLmNsZWFyQ29sb3IoMCwwLDAsMCksaS5jbGVhcihpLkNPTE9SX0JVRkZFUl9CSVQpO2NvbnN0IHM9ZSp0LGE9ZT4+MSxvPXQ+PjEsbj1hKm87dGhpcy55LmZpbGwoZSx0LHIuc3ViYXJyYXkoMCxzKSksdGhpcy51LmZpbGwoYSxvLHIuc3ViYXJyYXkocyxzK24pKSx0aGlzLnYuZmlsbChhLG8sci5zdWJhcnJheShzK24sci5sZW5ndGgpKSxpLmRyYXdBcnJheXMoaS5UUklBTkdMRV9TVFJJUCwwLDQpfXJlc2l6ZShlLHQpe3RoaXMuc3RvcFJlbmRlcj0hMCxlJiYodGhpcy5jYW52YXMud2lkdGg9ZSksdCYmKHRoaXMuY2FudmFzLmhlaWdodD10KSxzZXRUaW1lb3V0KCgpPT57dGhpcy5zdG9wUmVuZGVyPSExfSwxMDApfWRlc3Ryb3koKXtjb25zdCBlPXRoaXMuZ2w7dGhpcy5nbC5jbGVhcihlLkNPTE9SX0JVRkZFUl9CSVR8ZS5ERVBUSF9CVUZGRVJfQklUfGUuU1RFTkNJTF9CVUZGRVJfQklUKX19bGV0IG87IWZ1bmN0aW9uKGUpe2VbZS5DQU5WQVM9MF09IkNBTlZBUyIsZVtlLklOSVQ9MV09IklOSVQiLGVbZS5QTEFZPTJdPSJQTEFZIixlW2UuREVTVE9SWT0zXT0iREVTVE9SWSIsZVtlLlNJWkU9NF09IlNJWkUiLGVbZS5TVEFSVD01XT0iU1RBUlQiLGVbZS5QQVVTRT02XT0iUEFVU0UifShvfHwobz17fSkpO2xldCBuPW51bGwsaD1udWxsO2NvbnN0IGw9bmV3IGNsYXNze2NvbnN0cnVjdG9yKGUpe3RoaXMubGFzdD0wLHRoaXMuZnJhbWU9dm9pZCAwLHRoaXMudGltZT0wLHRoaXMucXVldWU9W10sdGhpcy5mcmFtZVRpbWU9dm9pZCAwLHRoaXMuY3VycmVudD0wLHRoaXMubWF4TnVtPTAsdGhpcy5sb2c9dm9pZCAwLHRoaXMuY2FsY3VsYXRlPSgpPT57Y29uc3QgZT1EYXRlLm5vdygpLHQ9TWF0aC5yb3VuZCgxZTMqdGhpcy5mcmFtZS8oZS10aGlzLmxhc3QpKTt0aGlzLmxhc3Q9ZSx0aGlzLmZyYW1lPTAsdGhpcy5jdXJyZW50PXQsdGhpcy5sb2cuZGVidWcodCl9LHRoaXMucmVuZGVyTG9vcD0oKT0+e3RoaXMucXVldWUubGVuZ3RoJiZ0aGlzLnJlbmRlckZyYW1lKHRoaXMucXVldWUuc2hpZnQoKSksdGhpcy5mcmFtZVRpbWU9cmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMucmVuZGVyTG9vcCl9LHRoaXMuc3RhcnQ9KCk9Pnt0aGlzLmZyYW1lPTAsY2xlYXJUaW1lb3V0KHRoaXMudGltZSksdGhpcy5tYXhOdW0mJnRoaXMucmVuZGVyTG9vcCgpLHRoaXMudGltZT1zZWxmLnNldEludGVydmFsKHRoaXMuY2FsY3VsYXRlLDFlMyl9LHRoaXMucGFzdWU9KCk9PntjbGVhclRpbWVvdXQodGhpcy50aW1lKSx0aGlzLm1heE51bSYmY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5mcmFtZVRpbWUpfSx0aGlzLnJlcXVlc3RGcmFtZT1lPT57dGhpcy5tYXhOdW0/KHRoaXMucXVldWUubGVuZ3RoPnRoaXMubWF4TnVtJiYodGhpcy5xdWV1ZT1bXSksdGhpcy5xdWV1ZS5wdXNoKGUpKToodGhpcy5mcmFtZSsrLHJlcXVlc3RBbmltYXRpb25GcmFtZShlKSl9LHRoaXMucmVuZGVyRnJhbWU9ZT0+e3RoaXMuZnJhbWUrKyxlKCl9LHRoaXMubG9nPW5ldyByKGUpfX0oIndlYmdsIGNvbW1pdCBmcHMiKTtsLm1heE51bT0xLG9ubWVzc2FnZT1mdW5jdGlvbihlKXtjb25zdCB0PWUuZGF0YTtzd2l0Y2godC50eXBlKXtjYXNlIG8uQ0FOVkFTOmg9dC5jYW52YXM7Y2FzZSBvLklOSVQ6bj1uZXcgYShoKTticmVhaztjYXNlIG8uUExBWTpsLnJlcXVlc3RGcmFtZSgoKT0+e2NvbnN0e3dpZHRoOmUsaGVpZ2h0OnIsYnVmZmVyOml9PXQ7bi5yZW5kZXJGcmFtZShlLHIsaSl9KTticmVhaztjYXNlIG8uU1RBUlQ6bC5zdGFydCgpO2JyZWFrO2Nhc2Ugby5QQVVTRTpsLnBhc3VlKCk7YnJlYWs7Y2FzZSBvLlNJWkU6bi5yZXNpemUodC53aWR0aCx0LmhlaWdodCk7YnJlYWs7Y2FzZSBvLkRFU1RPUlk6bi5kZXN0cm95KCksbj1udWxsfX07Cgo=",null,!1);let H;!function(e){e[e.CANVAS=0]="CANVAS",e[e.INIT=1]="INIT",e[e.PLAY=2]="PLAY",e[e.DESTORY=3]="DESTORY",e[e.SIZE=4]="SIZE",e[e.START=5]="START",e[e.PAUSE=6]="PAUSE"}(H||(H={}));const O=[];const Q=new WeakMap();class K{constructor(e){if(this.canvas=void 0,this.webglWorker=void 0,this.current=void 0,this.sendMessage=(e,t,s)=>{s?this.webglWorker.postMessage({type:e,...t},[s]):this.webglWorker.postMessage({type:e,...t})},this.fullscreen=()=>{const e=this.canvas;e.requestFullscreen&&e.requestFullscreen()},this.exitfullscreen=()=>{document.exitFullscreen&&document.exitFullscreen()},this.canvas=e,this.webglWorker=O.length?O.pop():new J(),Q.has(e))this.sendMessage(H.INIT);else{!function(e,t){let s=0,n=t.width,i=t.height;const r=()=>e.postMessage({type:H.SIZE,width:n,height:i});Object.defineProperties(t,{width:{get:()=>n,set:e=>{n=e,clearTimeout(s),s=window.setTimeout(r,100)}},height:{get:()=>i,set:e=>{i=e,clearTimeout(s),s=window.setTimeout(r,100)}}})}(this.webglWorker,e);const t=e.transferControlToOffscreen();this.sendMessage(H.CANVAS,{canvas:t},t),Q.set(e,!0)}}renderFrame(e,t,s){this.sendMessage(H.PLAY,{width:e,height:t,buffer:s},s.buffer)}start(){this.sendMessage(H.START)}pause(){this.sendMessage(H.PAUSE)}destory(){this.sendMessage(H.DESTORY),O.push(this.webglWorker),this.pause()}}class j{constructor(e){this.props=void 0,this.audioCtx=void 0,this.props=e,this.audioCtx=new(window.AudioContext||window.webkitAudioContext)(),this.audioCtx.resume()}duration(e){const{channels:t,sampleRate:s,sampleFmt:n}=this.props,i=n<<1;return 1e3*(e.length/i/t/s)}getTypeArray(e){switch(this.props.sampleFmt){case 1:const t=new Int16Array(e),s=32768;return e=>t[e]/s;case 2:const n=new Float32Array(e);return e=>n[e]}}play(e){const t=this.audioCtx,{channels:s,sampleRate:n,sampleFmt:i}=this.props,r=i<<1,o=e.length/r/s,a=t.createBuffer(s,o,n);this.adjustBuffer(a,o,this.getTypeArray(e.buffer));const l=t.createBufferSource();l.buffer=a,l.connect(this.audioCtx.destination),l.start()}adjustBuffer(e,t,s){const{channels:n}=this.props;for(let i=0;i<n;i++){const r=e.getChannelData(i);let o=i;for(let e=0;e<t;e++)r[e]=s(o),o+=n}}}class ${constructor(e){this.last=0,this.frame=void 0,this.time=0,this.queue=[],this.frameTime=void 0,this.current=0,this.maxNum=0,this.log=void 0,this.calculate=()=>{const e=Date.now(),t=Math.round(1e3*this.frame/(e-this.last));this.last=e,this.frame=0,this.current=t,this.log.debug(t)},this.renderLoop=()=>{this.queue.length&&this.renderFrame(this.queue.shift()),this.frameTime=requestAnimationFrame(this.renderLoop)},this.start=()=>{this.frame=0,clearTimeout(this.time),this.maxNum&&this.renderLoop(),this.time=self.setInterval(this.calculate,1e3)},this.pasue=()=>{clearTimeout(this.time),this.maxNum&&cancelAnimationFrame(this.frameTime)},this.requestFrame=e=>{this.maxNum?(this.queue.length>this.maxNum&&(this.queue=[]),this.queue.push(e)):(this.frame++,requestAnimationFrame(e))},this.renderFrame=e=>{this.frame++,e()},this.log=new c(e)}}var q;!function(e){e[e.PROBESIZE=2048]="PROBESIZE",e[e.MAXDOWNLOADBUFFER=1e3]="MAXDOWNLOADBUFFER",e[e.MINDOWNLOADBUFFER=1e3]="MINDOWNLOADBUFFER"}(q||(q={}));class ee extends Z{static probe(){return!0}constructor(e){super(e,"WasmPlayer"),this.decodeBufctl=void 0,this.totalLength=0,this.bufferLimit=100,this.bufferNumber=0,this.webgl=void 0,this.pcm=void 0,this.fps=new $("webgl pending fps"),this.decoder=void 0,this.avParams=void 0,this.baseVideoTime=0,this.baseAudioTime=0,this.fpsInterval=0,this.videoQueue=[],this.audioQueue=[],this.commonFrames=0,this.lastFramesTime=[],this.avFrame=void 0,this.avDecodeTime=void 0,this.decodeTotalTime=0,this.decodeTotalFrame=0,this.onDownload=(e,t)=>this.decoder.onDownloadBuffer(e,t),this.onAVBuffer=e=>{"video"===e.stream?(this.videoQueue.push(e),e.timestamp=e.timestamp-this.baseVideoTime,this.endV=e.timestamp):(this.audioQueue.push(e),e.timestamp=e.timestamp-this.baseAudioTime,this.endA=e.timestamp),this.lastFramesTime.push(e.decodeTime),this.lastFramesTime.length>30&&this.lastFramesTime.shift(),this.decodeTotalTime+=e.decodeTime,this.decodeTotalFrame+=1},this.renderFrame=e=>{const{width:t,height:s}=this.playParams;this.fps.renderFrame(()=>this.shouldRender&&this.webgl.renderFrame(t,s,e.buffer))},this.onLoop=(e,t)=>{for(this.videoQueue.length>100&&this.videoQueue.splice(0,50),this.audioQueue.length>100&&this.videoQueue.splice(0,50);this.audioQueue.length;){const{buffer:e,timestamp:t}=this.audioQueue[0],s=this.pcm.duration(e),n=super.syncAudio(t,s);if(n<0)this.audioQueue.shift();else{if(n>0)break;this.audioQueue.shift(),this.lastA=t,this.pcm.play(e)}}for(;this.videoQueue.length;){if(!(this.videoQueue[0].timestamp<=this._currentTime))break;this.renderFrame(this.videoQueue.shift())}},this.createMediaElement()}createMediaElement(){const e=document.createElement("canvas");e.style.width="100%",e.style.height="100%",super.bindElement(e),this.webgl=new K(e)}async load(){try{if(super.load(),this.decoder=Y.create({}),await this.decoder.load(),this.status===g.DISCARD)return;if(this.loadDownload(),this.decoder.onerror=this.onerror,this.decodeBufctl=new z({unit:"decode video number",minimum:25,maximum:75,getValue:()=>this.videoQueue.length,pause:()=>this.decoder.stopDecoding(),resume:()=>this.decoder.startDecoding(),isDone:()=>this.decoder.isDone(),destory:()=>this.decoder.destory()}),this.downBufctl.startCheck(),this.avParams=await this.decoder.getVideoParams(),this.status===g.DISCARD)return;const{width:e,height:t,rate:s}=this.avParams.video;this.playParams={width:e,height:t},this.fpsInterval=1e3/s,this.statusUtil.setStatus(g.LOAD),this.emit("loadedmetadata")}catch(e){}}async reload(){await super.reload(),this.baseVideoTime=null,this.baseAudioTime=null,this.decoder.flushBuffers(),this.videoQueue=[]}loadDownload(){const e=super.loadDownload();return this.downBufctl=new z({unit:"pending frame",minimum:100,maximum:200,getValue:()=>this.decoder.pendingFrames,pause:()=>this.download.pause(),resume:()=>this.download.resume(),isDone:()=>this.download.isDone(),destory:()=>this.download.destory()}),e}play(e=!0){return!!super.play(e)&&(this.statusUtil.hasStatus(g.LOADDATA)?(e&&this.emit("play"),this.downBufctl.startCheck(),this.normalPlay()):this.firstPlay(),this.pcm=new j(this.avParams.audio),this.decodeBufctl.startCheck(),this.decoder.startDecoding(),!0)}firstPlay(){this.decoder.onAVFrame=e=>{this.baseVideoTime||"video"!==e.stream||(this.baseVideoTime=e.timestamp),this.baseAudioTime||"audio"!==e.stream||(this.baseAudioTime=e.timestamp),this.onAVBuffer(e),this.videoQueue.length<10||(this.emit("loadeddata"),this.statusUtil.contactStatus(g.LOADDATA),this.decoder.onAVFrame=this.onAVBuffer,this.normalPlay())}}normalPlay(){this.commonFrames=0,this.fps.start(),this.webgl.start(),this._resetAnimate(),this._animate()}framePlay(){if(this.statusUtil.hasStatus(g.FPLAY)||(this.statusUtil.replaceStatus(g.PLAYING,g.PAUSE),this.decodeBufctl.startCheck(),this.downBufctl.startCheck()),this.videoQueue.length){const e=this.videoQueue.shift();super._currentTime=e.timestamp,this.renderFrame(e)}}pause(e=!0){return!!super.pause(e)&&(this.decodeBufctl.pause(),this.decodeBufctl.cancelCheck(),this.fps.pasue(),this.webgl.pause(),!0)}destory(){super.destory(),this.decodeBufctl&&this.decodeBufctl.cancelCheck(),this.webgl&&this.webgl.destory(),this.fps.pasue()}set currentTime(e){this._currentTime=e,this.seek(),this.emit("timeupdate",e)}get currentTime(){return this._currentTime}get debugInfo(){const{decodeTotalFrame:e,decodeTotalTime:t,lastFramesTime:s}=this;let n=0;return s.forEach(e=>n+=e),{"平均解码时间":`${(t/e).toFixed(2)}ms`,"近30帧平均时间":`${(n/s.length).toFixed(2)}ms`}}}class te{constructor(){this.current=0}}function se(e,t=0,s){(s||0!==t)&&(s=s||e.byteLength+1,e=e.slice(t,s));const n=new DataView(e);return{buffer:n,current:0,value:n.getUint32(0),bits:0,avaliabe:32,index:0}}function ne(e,t){if(0===t)return 0;let s;if(e.avaliabe>=t)e.bits+=t,e.avaliabe=32-e.bits,s=e.value>>>e.avaliabe;else{e.current+=4,e.bits=t-e.avaliabe,e.avaliabe=32-e.bits;const n=e.buffer.getUint32(e.current);s=e.value<<e.bits|n>>>e.avaliabe,e.value=n}return 0===e.avaliabe?(e.current+=4,e.bits=0,e.avaliabe=32,e.value=e.buffer.getUint32(e.current)):e.value&=(1<<e.avaliabe)-1>>>0,e.index+=t,s}function ie(e){const t=e.buffer.getUint8(e.current);return e.current+=1,t}function re(e){const t=e.buffer.getUint16(e.current);return e.current+=2,t}function oe(e){const t=e.value;if(e.current+=4,e.value=e.buffer.getUint32(e.current),32===e.avaliabe)return t;return t*2**e.bits+(t>>>e.avaliabe)}function ae(e,t){const s=e.byteLength-4;for(;t.current<s;t.current++)if(1===e.getUint32(t.current))return t.current+=le,t.current}const le=4;class ce{static getStream(e,t){const s=Object.create(new ce(e));return t&&Object.keys(t).forEach(e=>{s[e]=t[e]}),s}constructor(e){this.start=0,this.end=0,this.extraRange=null,this._buffer=void 0,this._buffer=e}buffer(){if(this.extraRange){const e=this.end-this.start;let t=e;this.extraRange.forEach(e=>t+=e[2]);const s=new Uint8Array(t),n=[[this.start,this.end,e],...this.extraRange];let i=0;return n.forEach(e=>{const t=this._buffer.slice(e[0],e[1]);s.set(new Uint8Array(t),i),i+=e[2]}),s.buffer}return this._buffer.slice(this.start,this.end)}merge(e){this.extraRange||(this.extraRange=[]),this.extraRange.push([e.start,e.end,e.end-e.start])}}const ue={id:null,pid:null,container:void 0,inputTimeScale:0,sequenceNumber:0,timescale:null,duration:null,pixelRatio:null,samples:[]},he={id:null,units:null,pts:null,dts:null,duration:0};function de(e){const t=(14&ie(e))<<29,s=(65534&re(e))<<14,n=(65534&re(e))>>1;return Math.round((t>>>0)+s+n)}function pe(e){let t=e.buffer.byteLength-e.current,s=0;for(;t>0;){t--;const n=s;if(s=16777215&(s<<8|ie(e)),1===n)return s}return-1}class me extends te{constructor(...e){super(...e),this.name="ps stream",this.videoType=void 0,this.audioType=void 0,this.streams=[]}probe(e){return this.parse(e),this.videoType}parsePSMH(e){const t=re(e);ie(e),ie(e),re(e),re(e);let s=t-0-10;for(;s>=4;){const t=ie(e);ie(e),re(e),this.videoType?this.audioType=t:this.videoType=t,s-=4}}parsePES(e,t){const s=re(e),n=e.current-1+s;ie(e);const i=ie(e),r=ie(e),o=e.current+r;128&i&&(t.pts=de(e),64&i&&de(e)),t.start=o,t.end=n+1,e.current=n}parse(e){this.clear();const t=se(e);let s=!1,n={},i=null;for(;i=pe(t);){if(-1===i)return;switch(i){case 442:s=!0;break;case 443:break;case 444:this.parsePSMH(t);break;case 480:case 448:const r=255&i,o=ce.getStream(e);o.id=r,this.parsePES(t,o),!s&&n[r]?n[r].pts===o.pts&&n[r].merge(o):(this.streams.push(o),n[r]=o,s=!1)}}}clear(){this.streams=[]}}function fe(e){const{current:t,bits:s}=e;for(;0===ne(e,1););const n=8*(e.current-t)+(e.bits-s)-1;return(1<<n|ne(e,n))-1}function ye(e){const t=fe(e);return 1&t?1+t>>>1:-1*(t>>>1)}const be=[[0,1],[1,1],[12,11],[10,11],[16,11],[40,33],[24,11],[20,11],[32,11],[80,33],[18,11],[15,11],[64,33],[160,99],[4,3],[3,2],[2,1]];function ge(e,t){if(!ne(e,1))return 0;let s=8,n=8;for(let i=0;i<t;i++){if(n){const t=ye(e);if(t<-128||t>128)return 0;n=s+t&255}if(!i&&!n)break;s=n||s}return 0}function Ze(e){const t=ne(e,8),s=ne(e,6);!function(e,t){const s=e.bits+t;if(e.bits>32){const t=Math.floor(s/8);e.current+=t,e.bits=s-8*t}else e.bits=s;e.avaliabe=32-e.bits,e.value&=(1<<e.avaliabe)-1,e.index+=t}(e,2);const n=ne(e,8),i={sps_id:fe(e),time_offset_length:24,profile_idc:t,constraint_set_flags:s,level_idc:n,full_range:-1,scaling_matrix_present:0,color_primaries:0,color_trc:null,colorspace:2,colour_description_present_flag:0,offset_for_ref_frame:[],mb_width:0,mb_height:0,sar:{num:0,den:0}};if(100===t||110===t||122===t||244===t||44===t||83===t||86===t||118===t||128===t||138===t||144===t){const t=fe(e);if(i.chroma_format_idc=t,t>3);else if(3===t){ne(e,1)}fe(e),fe(e),ne(e,1);!function(e,t){let s=0;ne(e,1)&&(s|=ge(e,16),s|=ge(e,16),s|=ge(e,16),s|=ge(e,16),s|=ge(e,16),s|=ge(e,16),s|=ge(e,64),s|=ge(e,64),3===t.chroma_format_idc&&(s|=ge(e,64),s|=ge(e,64),s|=ge(e,64),s|=ge(e,64)))}(e,i)}fe(e);const r=fe(e);if(0===r){fe(e)}else if(1===r){ne(e,1),fe(e),fe(e);const t=fe(e);for(let s=0;s<t;s++)i.offset_for_ref_frame[s]=fe(e)}fe(e),ne(e,1);if(i.mb_width=fe(e)+1,i.mb_height=fe(e)+1,i.frame_mbs_only_flag=ne(e,1),0===i.frame_mbs_only_flag){ne(e,1)}i.mb_height*=2-i.frame_mbs_only_flag;ne(e,1);if(ne(e,1)){i.crop_left=fe(e),i.crop_right=fe(e),i.crop_top=fe(e),i.crop_bottom=fe(e);const t=1===i.chroma_format_idc?1:0,s=1<<(1===i.chroma_format_idc||2===i.chroma_format_idc?1:0),n=2-i.frame_mbs_only_flag<<t;i.crop_left=i.crop_left*s,i.crop_right=i.crop_right*s,i.crop_top=i.crop_top*n,i.crop_bottom=i.crop_bottom*n}else i.crop_left=0,i.crop_right=0,i.crop_top=0,i.crop_bottom=0;ne(e,1)&&function(e,t){if(ne(t,1)){const s=ne(t,8);if(255===s)e.sar.num=ne(t,16),e.sar.den=ne(t,16);else if(s<be.length){const t=be[s];e.sar={num:t[0],den:t[1]}}}else e.sar.num=0,e.sar.den=0;if(ne(t,1)&&ne(t,1),ne(t,1)&&(ne(t,3),e.full_range=ne(t,1),e.colour_description_present_flag=ne(t,1),e.colour_description_present_flag&&(e.color_primaries=ne(t,8),e.color_trc=ne(t,8),e.colorspace=ne(t,8))),ne(t,1)){fe(t);fe(t)}if(e.timing_info_present_flag=ne(t,1),e.timing_info_present_flag){const s=oe(t),n=oe(t);s&&n?(e.num_units_in_tick=s,e.time_scale=n):e.timing_info_present_flag=0,e.fixed_frame_rate_flag=ne(t,1)}}(i,e),(0===i.sar.den||i.sar.num)&&(i.sar={den:1,num:1});let o=0;return i.time_scale&&(o=i.time_scale/i.num_units_in_tick,o=1===i.fixed_frame_rate_flag?o/2:o),{width:16*i.mb_width-(i.crop_right+i.crop_left),height:16*i.mb_height-(i.crop_top+i.crop_bottom),pixelRatio:i.sar,fps:o}}var ve;function Ve(e){let t="avc1.";return e.subarray(1,4).forEach(e=>{let s=e.toString(16);s.length<2&&(s=`0${s}`),t+=s}),t}!function(e){e[e.NAL_UNKNOWN=100]="NAL_UNKNOWN",e[e.NAL_SLICE=1]="NAL_SLICE",e[e.NAL_SLICE_DPA=2]="NAL_SLICE_DPA",e[e.NAL_SLICE_DPB=3]="NAL_SLICE_DPB",e[e.NAL_SLICE_DPC=4]="NAL_SLICE_DPC",e[e.NAL_SLICE_IDR=5]="NAL_SLICE_IDR",e[e.NAL_SEI=6]="NAL_SEI",e[e.NAL_SPS=7]="NAL_SPS",e[e.NAL_PPS=8]="NAL_PPS"}(ve||(ve={}));class Re extends te{constructor(...e){super(...e),this.spsInfo=void 0,this.ppsInfo=void 0}probe(e){const t=this.parse(e,ve.NAL_SPS);return this.spsInfo?Ve(new Uint8Array(t[0].buffer())):""}parse(e,t){const s=new DataView(e);this.current=0;const n=[];let i=!1;for(;ae(s,this);){const r=n.length,o=31&s.getUint8(this.current);switch(i=!0,o){case ve.NAL_SLICE:case ve.NAL_SLICE_IDR:case ve.NAL_SLICE_DPA:case ve.NAL_SLICE_DPB:case ve.NAL_SLICE_DPC:case ve.NAL_SEI:break;case ve.NAL_SPS:const t=Ze(se(e,this.current+1));0===t.fps&&(t.fps=25),this.spsInfo=t;break;case ve.NAL_PPS:break;case ve.NAL_UNKNOWN:default:i=!1}if(i&&(r&&(n[r-1].end=this.current-le),n[r]=ce.getStream(e,{type:o,start:this.current})),o===t)break}return n.length&&(n[n.length-1].end=e.byteLength),n}createTrack(e,t){const s={...ue,id:1,type:"video",container:"video/mp2t",codec:null,timescale:9e4,inputTimeScale:9e4,sps:null,pps:null,width:null,height:null,fps:null},{height:n,width:i,fps:r,pixelRatio:o}=this.spsInfo;return s.width=i,s.height=n,s.fps=r,s.pixelRatio=[o.den,o.num],s.sps=[new Uint8Array(e.buffer())],s.pps=[new Uint8Array(t.buffer())],s.codec=Ve(s.sps[0]),s}}const Se=Math.pow(2,32)-1,Le=new Uint8Array([0,0,0,0,0,0,0,0]),xe=new Uint8Array([105,115,111,109]),Ge=new Uint8Array([97,118,99,49]),Ue=new Uint8Array([0,0,0,1]),we=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),We={avc1:null,avcC:null,btrt:null,dinf:null,dref:null,esds:null,ftyp:null,hdlr:null,mdat:null,mdhd:null,mdia:null,mfhd:null,minf:null,moof:null,moov:null,mp4a:null,".mp3":null,mvex:null,mvhd:null,pasp:null,sdtp:null,stbl:null,stco:null,stsc:null,stsd:null,stsz:null,stts:null,tfdt:null,tfhd:null,traf:null,trak:null,trun:null,trex:null,tkhd:null,vmhd:null,smhd:null};Object.keys(We).forEach(e=>{We[e]=new Uint8Array([e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)])});class Te{static box(e,...t){let s=8,n=t.length;for(;n--;)s+=t[n].byteLength;const i=new Uint8Array(s);i[0]=s>>24&255,i[1]=s>>16&255,i[2]=s>>8&255,i[3]=255&s,i.set(e,4);const r=t.length;for(n=0,s=8;n<r;n++)i.set(t[n],s),s+=t[n].byteLength;return i}static mdat(e){return Te.box(Te.types.mdat,e)}static trun(e,t){const s=e.samples||[],n=s.length,i=12+16*n,r=new Uint8Array(i);t+=8+i,r.set([0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,255&n,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0);for(let e=0;e<n;e++){const{duration:t,size:n,flags:i,cts:o}=s[e];r.set([t>>>24&255,t>>>16&255,t>>>8&255,255&t,n>>>24&255,n>>>16&255,n>>>8&255,255&n,i.isLeading<<2|i.dependsOn,i.isDependedOn<<6|i.hasRedundancy<<4|i.paddingValue<<1|i.isNonSync,61440&i.degradPrio,15&i.degradPrio,o>>>24&255,o>>>16&255,o>>>8&255,255&o],12+16*e)}return Te.box(Te.types.trun,r)}static sdtp(e){const t=e.samples||[],s=new Uint8Array(4+t.length);for(let e=0;e<t.length;e++){const n=t[e].flags;s[e+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy}return Te.box(Te.types.sdtp,s)}static traf(e,t){let s=Te.sdtp(e),n=e.id,i=Math.floor(t/(Se+1)),r=Math.floor(t%(Se+1));return Te.box(Te.types.traf,Te.box(Te.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),Te.box(Te.types.tfdt,new Uint8Array([1,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,r>>24,r>>16&255,r>>8&255,255&r])),Te.trun(e,s.length+16+20+8+16+8+8),s)}static mfhd(e){return Te.box(Te.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}static moof(e,t,s){return Te.box(Te.types.moof,Te.mfhd(e),Te.traf(s,t))}static avc1(e){let t=[],s=[];for(let s=0;s<e.sps.length;s++){const n=e.sps[s],i=n.byteLength;t.push(i>>>8&255),t.push(255&i),t=t.concat(Array.prototype.slice.call(n))}for(let t=0;t<e.pps.length;t++){const n=e.pps[t],i=n.byteLength;s.push(i>>>8&255),s.push(255&i),s=s.concat(Array.prototype.slice.call(n))}const n=Te.box(Te.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(s))),i=e.width,r=e.height,o=e.pixelRatio[0],a=e.pixelRatio[1];return Te.box(Te.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,i>>8&255,255&i,r>>8&255,255&r,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),n,Te.box(Te.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Te.box(Te.types.pasp,new Uint8Array([o>>24,o>>16&255,o>>8&255,255&o,a>>24,a>>16&255,a>>8&255,255&a])))}static esds(e){let t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static mp4a(e){let t=e.samplerate;return Te.box(Te.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]),Te.box(Te.types.esds,Te.esds(e)))}static mp3(e){let t=e.samplerate;return Te.box(Te.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]))}static stsd(e){return"audio"===e.type?e.isAAC||"mp3"!==e.codec?Te.box(Te.types.stsd,Te.STSD,Te.mp4a(e)):Te.box(Te.types.stsd,Te.STSD,Te.mp3(e)):Te.box(Te.types.stsd,Te.STSD,Te.avc1(e))}static stbl(e){return Te.box(Te.types.stbl,Te.stsd(e),Te.box(Te.types.stts,Te.STTS),Te.box(Te.types.stsc,Te.STSC),Te.box(Te.types.stsz,Te.STSZ),Te.box(Te.types.stco,Te.STCO))}static minf(e){return"audio"===e.type?Te.box(Te.types.minf,Te.box(Te.types.smhd,Te.SMHD),Te.DINF,Te.stbl(e)):Te.box(Te.types.minf,Te.box(Te.types.vmhd,Te.VMHD),Te.DINF,Te.stbl(e))}static hdlr(e){return Te.box(Te.types.hdlr,Te.HDLR_TYPES[e])}static mdhd(e,t){t*=e;const s=Math.floor(t/(Se+1)),n=Math.floor(t%(Se+1));return Te.box(Te.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,s>>24,s>>16&255,s>>8&255,255&s,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))}static mdia(e){const{type:t,timescale:s,duration:n}=e;return Te.box(Te.types.mdia,Te.mdhd(s,n),Te.hdlr(t),Te.minf(e))}static tkhd(e){const{id:t,width:s=0,height:n=0,timescale:i}=e,r=e.duration*e.timescale,o=Math.floor(r/(Se+1)),a=Math.floor(r%(Se+1));return Te.box(Te.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,a>>24,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,255&s,0,0,n>>8&255,255&n,0,0]))}static trak(e){return e.duration=e.duration||4294967295,Te.box(Te.types.trak,Te.tkhd(e),Te.mdia(e))}static trex(e){let t=e.id;return Te.box(Te.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static mvex(e){return Te.box(Te.types.mvex,...e.map(e=>Te.trex(e)))}static mvhd(e){const t=e.timescale,s=t*e.duration,n=Math.floor(s/(Se+1)),i=Math.floor(s%(Se+1)),r=e.isLive?[255,255,255,255,255,255,255,255]:[n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i],o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,...r,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Te.box(Te.types.mvhd,o)}static moov(e){return Te.box(Te.types.moov,Te.mvhd(e[0]),...e.map(e=>Te.trak(e)),Te.mvex(e))}static initSegment(e){const t=Te.moov(e),s=new Uint8Array(Te.FTYP.byteLength+t.byteLength);return s.set(Te.FTYP),s.set(t,Te.FTYP.byteLength),s}}function Ee(e,t){if(void 0===t)return e;let s=null;for(s=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=s;return e}let Xe,ke;Te.types=We,Te.HDLR_TYPES={video:new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),audio:new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0])},Te.STTS=Le,Te.STSC=Le,Te.STCO=Le,Te.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Te.STSD=new Uint8Array([0,0,0,0,0,0,0,1]),Te.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Te.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Te.FTYP=Te.box(Te.types.ftyp,xe,Ue,xe,Ge),Te.DINF=Te.box(Te.types.dinf,Te.box(Te.types.dref,we)),function(e){e.INIT_SEGMENT="INIT_SEGMENT",e.PARSING_DATA="PARSING_DATA"}(Xe||(Xe={}));class Me extends r{constructor(){super(),this.log=new c("mp4 remux"),this.init=!1,this.initPTS=void 0,this.initDTS=void 0,this.nextAvcDts=void 0}resetSegment(){this.init=!1}generateIS(e,t,s){const n=void 0===this.initPTS,i={};let r,o;if(n&&(r=o=1/0),t.sps&&t.pps&&t.samples.length){const{inputTimeScale:e,codec:a,width:l,height:c,fps:u,samples:h}=t;t.timescale=e,i.video={container:"video/mp4",codec:a,initSegment:Te.initSegment([t]),metadata:{width:l,height:c,rate:u}},n&&(this.initPTS=Math.min(r,h[0].pts-e*s),this.initDTS=Math.min(o,h[0].dts-e*s))}Object.keys(i).length,this.init=!0,this.emit(Xe.INIT_SEGMENT,i)}remuxAudio(e,t,s){}remuxEmptyAudio(e){const t=e.inputTimeScale;e.samplerate&&e.samplerate}remuxVideo(e,t,s){let n=0;const i=e.timescale,r=e.samples;let o=0;s||(o=t*i);r.forEach(e=>{e.pts=Ee(e.pts-0,o),e.dts=Ee(e.dts-0,o)}),r.sort((e,t)=>{const s=e.dts-t.dts,n=e.pts-t.pts;return s||n||e.id-t.id});const a=r[0],l=Math.max(a.pts,0),c=Math.max(a.dts,0),u=r[r.length-1],h=Math.max(u.pts,0),d=Math.max(u.dts,0);let p=0,m=0;r.forEach((e,t)=>{let s=0;e.units.forEach(e=>s+=e.data.byteLength),p+=s,m+=e.units.length,e.length=s,e.dts=Math.max(e.dts,c),e.pts=Math.max(e.pts,e.dts)});let f=p+4*m+8;const y=new Uint8Array(f),b=new DataView(y.buffer);b.setUint32(0,f),y.set(Te.types.mdat,4);let g=8;const Z=[];r.forEach((e,t)=>{let s=0;if(e.units.forEach(e=>{const t=e.data;b.setUint32(g,t.byteLength),g+=4,y.set(new Uint8Array(t),g),g+=t.byteLength,s+=4+t.byteLength}),t<r.length-1)n=r[t+1].dts-e.dts;else{const s=e.dts-r[t>0?t-1:t].dts;n=s}Z.push({size:s,duration:n,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e.key?2:1,isNonSync:e.key?0:1}})}),this.nextAvcDts=d+n,e.samples=Z;const v=Te.moof(e.sequenceNumber++,c,e);e.samples=[];const V=new Uint8Array(v.byteLength+y.byteLength);V.set(v,0),V.set(y,v.byteLength);const R={segment:V,startPTS:l/i,endPTS:(h+n)/i,startDTS:c/i,endDTS:this.nextAvcDts/i,type:"video",hasAudio:!1,hasVideo:!0,nb:Z.length,dropped:0};this.emit(Xe.PARSING_DATA,R)}remux(e,t,s){this.init||this.generateIS(e,t,s);const n=t.samples.length;if(e&&n){e.samples[0].pts,t.samples[0].pts,t.inputTimeScale}this.remuxVideo(t,s,!1)}}function Ne(e){let t=(112&(e^=85))>>4,s=15&e;return s<<=4,0!=t&&(s|=264,s<<=t-1),0===(128&e)?-s:s}!function(e){e.PCM_INIT="PCM_INIT",e.PCM_DATA="PCM_DATA"}(ke||(ke={}));class Ie extends r{constructor(...e){super(...e),this.params={sampleFmt:1,channels:1,sampleRate:8e3},this.init=!1}parse(e,t){this.init||(this.emit(ke.PCM_INIT,this.params),this.init=!0);const s=function(e){const t=e.length;for(let s=0;s<t;s++)e[s]=Ne(e[s]);return e}(new Uint8Array(e));this.emit(ke.PCM_DATA,{pts:t,buffer:s})}}class Ce extends r{constructor(e){super(),this.isLive=!1,this.psdemux=new me(),this.avcDemux=new Re(),this.mp4Remux=new Me(),this.audioDecode=new Ie(),this.probed=!1,this.tracks={video:null,audio:null},this.firstAPTS=null,this.firstVPTS=null,this.append=e=>{const t=this.psdemux;if(t.parse(e),27===this.psdemux.videoType)return this.psdemux.audioType,t.streams.forEach(e=>{224===e.id?this.demuxVideo(e):this.demuxAudio(e)}),this.remux()},r.transferEvent(this.mp4Remux,this),r.transferEvent(this.audioDecode,this),e&&(this.isLive=e.isLive||!1)}demuxVideo(e){null===this.firstVPTS&&(this.firstVPTS=e.pts);const t=e.buffer(),s=this.avcDemux.parse(t),{spsInfo:n}=this.avcDemux,{tracks:i}=this;if(!i.video){if(!n||s.length<=1)return;const[e,t]=s,r=this.avcDemux.createTrack(e,t);i.video=r,r.isLive=this.isLive,this.mp4Remux.resetSegment()}const r={...he,units:[]};r.pts=r.dts=e.pts-this.firstVPTS,r.units=s.map(e=>({...e,data:e.buffer()})),i.video.samples.push(r)}demuxAudio(e){null===this.firstAPTS&&(this.firstAPTS=e.pts),e.pts-=this.firstAPTS,this.audioDecode&&this.audioDecode.parse(e.buffer(),e.pts/90)}remux(){const{video:e,audio:t}=this.tracks;if(!e||e.samples.length<2)return!1;const{samples:s}=e,n=s[s.length-1].pts-s[0].dts;e.duration=n/e.inputTimeScale,this.mp4Remux.remux(t,e,0),e.samples=[]}}const Fe=new Re();class Ae extends Z{static probe(e){const t=Fe.probe(e);return MediaSource.isTypeSupported(`video/mp4;codecs="${t}"`)}constructor(e){super(e,"MSEPlayer"),this.ms=void 0,this.sourceBuffer={},this.objectUrl=void 0,this.buffered=0,this.trackList=[],this.pendingSemgemt=[],this.contorller=null,this.pcm=void 0,this.pcmFrames=[],this.downBufctl=void 0,this.visibility=!0,this.offScreen={playedTime:0,start:0},this.onMediaSourceOpen=()=>{this.log.debug("media source opened")},this.onMediaSourceEnded=()=>{this.log.debug("media source ended")},this.onMediaSourceClose=()=>{this.log.debug("media source closed")},this.visibilityChange=()=>{if(this.statusUtil.hasStatus(g.PLAYING))if("visible"===document.visibilityState){this.visibility=!0;const e=Math.floor(this.buffered);this.el.currentTime=e,this.offScreen={start:0,playedTime:0},this.el.paused&&this.el.play(),this.log.debug(`[visibilitychange] currentTime set to ${e}`)}else this.el.pause(),this.offScreen.start=Date.now(),this.visibility=!1,this.offScreen.playedTime=this.el.currentTime},this.onSBUpdateStart=()=>{},this.onSBUpdateError=e=>{this.log.error(!0,this.el,e)},this.onSBAbort=e=>{this.trackList.forEach(e=>this.removeSourceBuffer(e.type))},this.onSBUpdateEnd=e=>{this.doAppend();const t=this.statusUtil.hasStatus(g.PLAYING);Object.keys(this.sourceBuffer).forEach(e=>{const s=t&&!this.visibility?this.getOffscreenTime():this.el.currentTime,n=Math.max(Math.floor(s)-5,0);this.removeBufferRange(e,0,n,10)})},this.appendSemgemt=e=>{this.pendingSemgemt.push(e),this.buffered=e.endPTS,this.doAppend()},this.initSemgemt=async e=>{this.avParams=this.avParams||{};for(let t in e){const s=t;if(this.sourceBuffer[s])break;const n={...e[s],type:s},{initSegment:i,metadata:r}=n;this.appendSemgemt({type:s,segment:i,startPTS:0,endPTS:0}),this.avParams[s]=r,this.trackList.push(n)}const[t,s]=d();"open"===this.ms.readyState?t[0]():this.ms.onsourceopen=()=>{t[0]()},await s,this.ms.onsourceopen=null,this.createSourceBuffers(this.trackList),this.doAppend()},this.onDownload=(e,t)=>this.contorller.append(e),this.onLoop=(e,t)=>{for(;this.pcmFrames.length;){const{buffer:e,pts:t}=this.pcmFrames[0],s=this.pcm.duration(e),n=1e3*this.el.currentTime,i=super.syncAudio(t,s);if(i<0)this.pcmFrames.shift();else{if(i>0)break;this.pcmFrames.shift(),this.pcm.play(e),this.lastA=t}const r=super.syncContorl(t,n);r===n?this.el.paused||this.el.paused:r===t&&(this.el.paused&&this.el.play(),this.el.currentTime=r/1e3,this.lastV=r)}},this.createMediaElement()}createMediaElement(){const e=document.createElement("video");e.style.width="100%",e.style.height="100%",e.style.objectFit="fill",e.controls=!1,e.muted=!0,e.preload="none",super.bindElement(e),this.mediaAttach(e)}getOffscreenTime(){const{start:e,playedTime:t}=this.offScreen,s=(Date.now()-e)/1e3;return Math.min(t+s,this.buffered)}removeVideo(){this.el&&(this.el.pause(),this.el.removeAttribute("src"),this.el.load())}mediaAttach(e){const t=new MediaSource();t.addEventListener("sourceopen",this.onMediaSourceOpen),t.addEventListener("sourceended",this.onMediaSourceEnded),t.addEventListener("sourceclose",this.onMediaSourceClose),document.addEventListener("visibilitychange",this.visibilityChange),document.addEventListener("unbeforeload",this.removeVideo),this.on("ratechange",e=>{this.el.playbackRate=e}),this.ms=t;const s=URL.createObjectURL(t);e.src=s,e.load(),this.objectUrl=s}mediaDetach(){if(this.ms){try{"open"===this.ms.readyState&&this.ms.endOfStream()}catch(e){this.log.debug(`onMediaDetaching:${e.message} while calling endOfStream`)}this.ms.removeEventListener("sourceopen",this.onMediaSourceOpen),this.ms.removeEventListener("sourceended",this.onMediaSourceEnded),this.ms.removeEventListener("sourceclose",this.onMediaSourceClose)}document.removeEventListener("visibilitychange",this.visibilityChange),this.objectUrl&&(URL.revokeObjectURL(this.objectUrl),this.objectUrl=null),this.removeVideo()}removeSourceBuffer(e){const t=this.sourceBuffer[e];t&&(t.abort(),this.ms.removeSourceBuffer(t),this.sourceBuffer[e]=null,this.log.debug(`[remove sourcebuffer] [${e}]`),t.removeEventListener("updatestart",this.onSBUpdateStart),t.removeEventListener("updateend",this.onSBUpdateEnd),t.removeEventListener("error",this.onSBUpdateError),t.removeEventListener("abort",this.onSBAbort))}removeBufferRange(e,t,s,n=.5){const i=this.sourceBuffer[e];if(!i||i.updating)return!0;try{for(let r=0;r<i.buffered.length;r++){const o=i.buffered.start(r),a=i.buffered.end(r),l=Math.max(o,t),c=Math.min(a,s);if(c-l>n&&r===i.buffered.length-1){const t=this.el.currentTime;return this.log.debug(`[sourcebuffer ${e} buffer remove] [${o}, ${a}], remove [${l}, ${c}] , pos: ${t}`),i.remove(l,c),!0}}}catch(e){this.log.warn(!0,e)}}doAppend(){if(!this.pendingSemgemt.length)return;if(this.el.error)return;const{type:e,segment:t}=this.pendingSemgemt[0],s=this.sourceBuffer[e];if(!s||s.updating)return;try{this.pendingSemgemt.shift(),s.appendBuffer(t)}catch(e){console.error(e)}const n=s.buffered.length;n&&(this.endV=1e3*s.buffered.end(n-1))}createSourceBuffers(e){const{sourceBuffer:t,ms:s}=this;e.forEach(e=>{const{container:n,codec:i,type:r}=e;if(t[r])return;const o=`${n};codecs="${i}"`,a=s.addSourceBuffer(o);a.addEventListener("updatestart",this.onSBUpdateStart),a.addEventListener("updateend",this.onSBUpdateEnd),a.addEventListener("error",this.onSBUpdateError),a.addEventListener("abort",this.onSBAbort),t[r]=a})}async load(){super.load(),await this.loadDownload(),this.status!==g.DISCARD&&(this.downBufctl.startCheck(),this.statusUtil.contactStatus(g.LOAD),this.emit("loadedmetadata"))}async reload(){const e=super.reload();this.pendingSemgemt=[];const t=this.trackList.map(async({type:e})=>{const[t,s]=d(),n=this.sourceBuffer[e],i=()=>{const s=n.onupdateend;this.removeBufferRange(e,0,1/0),n.onupdateend=()=>{n.onupdateend=s,t[0]()}};return n.updating?n.onupdateend=i:i(),s});await Promise.all(t),await e,this.el.currentTime=0}loadDownload(){super.loadDownload(),this.contorller=new Ce({isLive:this.isLive}),this.downBufctl=new z({unit:"buffer time",minimum:0,maximum:10,getValue:()=>this.buffered-this.el.currentTime,pause:()=>this.download.pause(),resume:()=>this.download.resume(),isDone:()=>this.download.isDone(),destory:()=>this.download.destory()});const[e,t]=d();return this.contorller.on(Xe.INIT_SEGMENT,t=>{this.initSemgemt(t),e[0]()}),this.contorller.on(Xe.PARSING_DATA,this.appendSemgemt),this.contorller.on(ke.PCM_INIT,e=>{this.pcm=new j(e)}),this.contorller.on(ke.PCM_DATA,e=>{this.pcmFrames.push(e),this.endA=e.pts}),t}play(e=!0){return!!super.play(e)&&(this.statusUtil.hasStatus(g.LOADDATA)&&(e&&this.emit("play"),this.downBufctl.startCheck()),this.statusUtil.contactStatus(g.LOADDATA),this.log.debug("start play"),"visible"===document.visibilityState?(this.el.play(),this.el.onplaying=()=>{this.el.onplaying=null,this._animate()}):(this.visibilityChange(),this._animate()),this._resetAnimate(),!0)}framePlay(){this.statusUtil.hasStatus(g.FPLAY)||(this.statusUtil.replaceStatus(g.PLAYING,g.PAUSE),this.downBufctl.startCheck(),this.el.pause()),this.el.currentTime+=1/this.avParams.video.rate}pause(e=!0){return!!super.pause(e)&&(this.el.pause(),!0)}destory(){this.mediaDetach(),this.pendingSemgemt=[],this.trackList=[],this.sourceBuffer={},super.destory()}set currentTime(e){this.el.currentTime=e/1e3}get currentTime(){return 1e3*this.el.currentTime}get debugInfo(){const e=this.sourceBuffer.video.buffered;if(!e.length)return null;const t=[];for(let s=0;s<e.length;s++)t.push(`${e.start(s)}, ${e.end(s)}`);return{"缓存区":t,"当前时间":this.el.currentTime,"音频时间":this.lastA/1e3,"缓冲到的时间":Math.max(this.endA,this.endV)/1e3,"主时钟":this._actualTime/1e3}}}const Be=new c("PlayerManager");function Ye(){return new Z({},"EmtpyPlayer")}class De{constructor(){this.x=0,this.y=0,this.w=0,this.h=0}static create(e,t,s,n){const i=new De();return i.x=e,i.y=t,i.w=s,i.h=n,i}static attach(e){const t=new De();return t.x=e.offsetLeft,t.y=e.offsetTop,t.w=e.offsetWidth,t.h=e.offsetHeight,t}static sizeOf(e){const t=new De();return t.w=e.offsetWidth,t.h=e.offsetHeight,t}static fork(e){const t=new De();return t.x=e.offsetLeft,t.y=e.offsetTop,t.w=e.offsetWidth,t.h=e.offsetHeight,t}static fromPoints(e,t){const[s,n,i,r]=[Math.min(e[0],t[0]),Math.min(e[1],t[1]),Math.max(e[0],t[0]),Math.max(e[1],t[1])];return De.create(s,n,i-s,r-n)}static fromPoint(e,t,s,n="br"){const i=new De();switch(i.x=e[0],i.y=e[1],n){case"br":i.x2=i.x+t,i.y2=i.y+s;break;case"bl":i.x2=i.x-t,i.y2=i.y+s;break;case"tl":i.x2=i.x-t,i.y2=i.y-s;break;case"tr":i.x2=i.x+t,i.y2=i.y-s}return i}set x1(e){this.w=this.x2-e,this.x=e}set y1(e){this.h=this.y2-e,this.y=e}get x2(){return this.x+this.w}set x2(e){this.w=e-this.x}get y2(){return this.y+this.h}set y2(e){this.h=e-this.y}get aspect(){return this.w/this.h}round(){return De.create(Math.round(this.x),Math.round(this.y),Math.round(this.w),Math.round(this.h))}normalize(){const[e,t,s,n]=[Math.min(this.x,this.x2),Math.min(this.y,this.y2),Math.max(this.x,this.x2),Math.max(this.y,this.y2)];return De.create(e,t,s-e,n-t)}rebound(e,t){const s=this.normalize();return s.x<0&&(s.x=0),s.y<0&&(s.y=0),s.x2>e&&(s.x=e-s.w),s.y2>t&&(s.y=t-s.h),s}scale(e,t){return t=t||e,De.create(this.x*e,this.y*t,this.w*e,this.h*t)}unscale(e,t){return t=t||e,De.create(this.x/e,this.y/t,this.w/e,this.h/t)}center(e,t){return De.create((e-this.w)/2,(t-this.h)/2,this.w,this.h)}toArray(){return[this.x,this.y,this.w,this.h]}}class ze{constructor(e){this.el=void 0,this.el=e}appendTo(e){return e.appendChild(this.el),this}emit(e){const t=document.createEvent("Event");t.initEvent(e,!0,!0),t.cropTarget=this,this.el.dispatchEvent(t)}removeClass(e){return this.el.className=this.el.className.split(" ").filter(t=>e!==t).join(" "),this}hasClass(e){return this.el.className.split(" ").filter(t=>e===t).length}addClass(e){return this.hasClass(e)||(this.el.className+=" "+e),this}listen(e,t){return this.el.addEventListener(e,e=>t(e.cropTarget,e)),this}}function Pe(e,t,s,n){let i,r,o,a;function l(s){const n=s instanceof TouchEvent?s.touches[0]:s,{top:l,left:h}=e.getBoundingClientRect();i=n.pageX,r=n.pageY,o=i-e.scrollLeft-h,a=r-e.scrollTop-l,s.preventDefault(),s.stopPropagation(),t(o,a,n)&&("mousedown"===s.type?(window.addEventListener("mousemove",c),document.addEventListener("mouseup",u)):"touchstart"===s.type&&(document.addEventListener("touchmove",c),document.addEventListener("touchend",u)))}function c(e){const t=e instanceof TouchEvent?e.changedTouches[0]:e;e.stopPropagation();const n=t.pageX-i,l=t.pageY-r;s(n+o,l+a,n,l)}function u(e){const t=e instanceof TouchEvent?e.changedTouches[0]:e,l=t.pageX-i,h=t.pageY-r;l&h&&s(l+o,h+a,l,h),document.removeEventListener("mouseup",u),window.removeEventListener("mousemove",c),document.removeEventListener("touchmove",c),document.removeEventListener("touchend",u),n()}return"string"==typeof e&&(e=document.getElementById(e)),e.addEventListener("mousedown",l),e.addEventListener("touchstart",l),{remove:function(){e.removeEventListener("mousedown",l),e.removeEventListener("touchstart",l)}}}class _e extends ze{static create(e){const t=document.createElement("div");return t.className=e,new _e(t)}}class Je{constructor(e,t,s,n){this.sw=void 0,this.sh=void 0,this.rect=void 0,this.locked=void 0,this.stuck=void 0,this.sw=t,this.sh=s,this.rect=e,this.locked=this.getCornerPoint(this.getOppositeCorner(n)),this.stuck=this.getCornerPoint(n)}static create(e,t,s,n){return new Je(e,t,s,n)}move(e,t){return De.fromPoints(this.locked,this.translateStuckPoint(e,t))}getDragQuadrant(e,t){const s=this.locked[0]-e,n=this.locked[1]-t;return s<0&&n<0?"br":s>=0&&n>=0?"tl":s<0&&n>=0?"tr":"bl"}translateStuckPoint(e,t){const[s,n,i]=this.stuck;var r=null===s?i:s+e,o=null===n?i:n+t;return r>this.sw&&(r=this.sw),o>this.sh&&(o=this.sh),r<0&&(r=0),o<0&&(o=0),[r,o]}getCornerPoint(e){const t=this.rect;switch(e){case"n":return[null,t.y,t.x];case"s":return[null,t.y2,t.x2];case"e":return[t.x2,null,t.y2];case"w":return[t.x,null,t.y];case"se":return[t.x2,t.y2];case"sw":return[t.x,t.y2];case"ne":return[t.x2,t.y];case"nw":return[t.x,t.y]}}getOppositeCorner(e){switch(e){case"n":return"se";case"s":case"e":return"nw";case"w":return"se";case"se":return"nw";case"sw":return"ne";case"ne":return"sw";case"nw":return"se"}}}var He={animateEasingFunction:"swing",animateFrames:30,multi:!1,multiMax:null,multiMin:1,cropperClass:"vcrop-widget",disabledClass:"vcrop-disable",canDrag:!0,canResize:!0,canSelect:!0,canRemove:!0,multiple:!1,autoFront:!0,active:!0,handles:["n","s","e","w","sw","nw","ne","se"],shade:!0,shadeClass:"vcrop-shade",shadeColor:"black",shadeOpacity:.5,widgetConstructor:null,x:0,y:0,w:100,h:100};class Oe extends ze{constructor(e,t){super(e),this.stage=void 0,this.pos=void 0,this.options=He,this.stage=t,this.pos=De.fork(this.el),this.createMover(),this.createHandles()}static create(e){const t=document.createElement("div");return t.setAttribute("tabindex","0"),t.className="vcrop-widget",new Oe(t,e)}createMover(){let e,t,s;Pe(this.el,()=>!!this.stage.enabled&&(e=this.el.parentElement.offsetWidth,t=this.el.parentElement.offsetHeight,s=De.fork(this.el),this.el.focus(),this.stage.activate(this),!0),(n,i,r,o)=>{this.pos.x=s.x+r,this.pos.y=s.y+o,this.render(this.pos.rebound(e,t))},()=>{this.emit("crop.change")})}createHandles(){this.options.handles.forEach(e=>{const t=_e.create("vcrop-handle "+e);let s;t.appendTo(this.el),Pe(t.el,()=>{if(!this.stage.enabled)return!1;const t=this.el.parentElement,n=t.offsetWidth,i=t.offsetHeight;return s=Je.create(De.fork(this.el),n,i,e),this.el.focus(),this.emit("crop.active"),!0},(e,t)=>this.render(s.move(e,t)),()=>{this.emit("crop.change")})})}render(e){e=e||this.pos,this.el.style.top=Math.round(e.y)+"px",this.el.style.left=Math.round(e.x)+"px",this.el.style.width=Math.round(e.w)+"px",this.el.style.height=Math.round(e.h)+"px",this.pos=e,this.stage.updateShades()}}class Qe{constructor(e){this.el=void 0,this.keys=["t","l","b","r"],this.shades=null,this.maskSahde=Ke.create("all"),this.el=e}static attach(e){const t=new Qe(e);return t.init(),t}init(){this.shades={},this.keys.forEach(e=>{this.shades[e]=Ke.create(e)})}enable(){this.keys.forEach(e=>this.shades[e].insert(this.el))}disable(){this.keys.forEach(e=>this.shades[e].remove())}adjust(e){const t=De.fork(this.el),s=this.shades;s.t.h=e.y,s.b.h=t.h-e.y2,s.t.w=s.b.w=Math.floor(e.w),s.l.w=s.t.x=s.b.x=Math.ceil(e.x),s.r.w=t.w-(Math.ceil(e.x)+Math.floor(e.w))}enableMask(){this.maskSahde.w=this.el.offsetWidth,this.maskSahde.h=this.el.offsetHeight,this.maskSahde.x=0,this.maskSahde.insert(this.el)}disableMask(){this.maskSahde.remove()}}class Ke{constructor(e){this.el=void 0,this.el=e}static create(e){const t=document.createElement("div");return t.className=`vcrop-shade ${e}`,new Ke(t).color("#000").opacity("0.6")}insert(e){e.appendChild(this.el)}remove(){this.el.remove()}set w(e){this.el.style.width=e+"px"}set h(e){this.el.style.height=e+"px"}set x(e){this.el.style.left=e+"px"}color(e){return e&&(this.el.style.backgroundColor=e),this}opacity(e){return e&&(this.el.style.opacity=e),this}}class je extends ze{constructor(e,t){super(e),this.options=void 0,this.enabled=!0,this.shapesManager=void 0,this.widgets=new Set(),this.active=void 0,this.options={...He,...t},this.initDrag(),this.shapesManager=Qe.attach(this.el),this.shapesManager.enableMask()}canCreate(){return!!this.enabled&&(!!this.options.multi||!(this.widgets.size>=1))}initDrag(){let e,t,s;Pe(this.el,(n,i,r)=>{if(!this.canCreate())return!1;e=Oe.create(this),t=e.pos,t.x=n,t.y=i;const{offsetWidth:o,offsetHeight:a}=this.el;return s=Je.create(t,o,a,"se"),this.addWidget(e),e.render(t),!0},(t,n,i,r)=>{e.render(s.move(i,r))},()=>{this.active.emit("crop.change")})}updateShades(){this.active&&this.shapesManager.adjust(this.active.pos)}refresh(){this.widgets.forEach(e=>{e.render()})}reorderWidgets(){var e=10;this.widgets.forEach(t=>{t.el.style.zIndex=`${e++}`,this.active===t?t.addClass("active"):t.removeClass("active")}),this.refresh()}activate(e){if(!this.enabled)return this;if(e=e||Array.from(this.widgets).pop()){if(this.active===e)return;this.active=e,this.widgets.delete(e),this.widgets.add(e),this.reorderWidgets(),this.active.el.focus(),this.shapesManager.enable(),this.shapesManager.disableMask(),e.emit("crop.activate")}else this.shapesManager.disable();return this}addWidget(e){return e.appendTo(this.el),this.activate(e),this.emit("new widget"),this}newWidget(e,t={}){const s=Oe.create(this);return s.render(e),this.addWidget(s),s.el.focus(),s}startDrag(){}}s(".vcrop-widget .vcrop-handle {\n  display: none;\n  position: absolute;\n  border: 1px rgba(127, 127, 127, 0.8) solid;\n  width: 10px;\n  height: 10px;\n  box-sizing: border-box;\n  background: rgba(255, 255, 255, 0.8);\n}\n.vcrop-widget .vcrop-handle.nw {\n  top: -3px;\n  left: -3px;\n  cursor: nwse-resize;\n}\n.vcrop-widget .vcrop-handle.w {\n  top: 50%;\n  transform: translateY(-50%);\n  left: -3px;\n  cursor: ew-resize;\n}\n.vcrop-widget .vcrop-handle.sw {\n  bottom: -3px;\n  left: -3px;\n  cursor: nesw-resize;\n}\n.vcrop-widget .vcrop-handle.ne {\n  top: -3px;\n  right: -3px;\n  cursor: nesw-resize;\n}\n.vcrop-widget .vcrop-handle.e {\n  top: 50%;\n  transform: translateY(-50%);\n  right: -3px;\n  cursor: ew-resize;\n}\n.vcrop-widget .vcrop-handle.se {\n  bottom: -3px;\n  right: -3px;\n  cursor: nwse-resize;\n}\n.vcrop-widget .vcrop-handle.n {\n  left: 50%;\n  transform: translateX(-50%);\n  top: -3px;\n  cursor: ns-resize;\n}\n.vcrop-widget .vcrop-handle.s {\n  left: 50%;\n  transform: translateX(-50%);\n  bottom: -3px;\n  cursor: ns-resize;\n}\n.vcrop-widget.active .vcrop-handle {\n  display: block;\n}\n.vcrop-widget {\n  position: absolute;\n  box-sizing: border-box;\n  border: 1px white dashed;\n  opacity: 0.7;\n  background: transparent;\n  transition: opacity 1s;\n  padding: 0;\n  margin: 0;\n  cursor: move;\n}\n.vcrop-widget:hover {\n  transition: opacity 0.8s;\n  opacity: 0.8;\n}\n.vcrop-widget:focus {\n  transition: opacity 0.5s;\n  opacity: 1;\n  outline-style: auto;\n  outline-width: 3px;\n  outline-color: rgba(0, 0, 0, 0.3);\n}\n.vcrop-shade {\n  background: rgba(0, 0, 0, 0.5);\n  transition: opacity 0.4s, background-color 0.7s;\n  position: absolute;\n}\n.vcrop-shade.l {\n  top: 0px;\n  left: 0px;\n  height: 100%;\n}\n.vcrop-shade.r {\n  top: 0px;\n  right: 0px;\n  height: 100%;\n}\n.vcrop-shade.t {\n  top: 0px;\n}\n.vcrop-shade.b {\n  bottom: 0px;\n}\n.vcrop-stage {\n  position: absolute;\n  width: 100%;\n}\n.vcrop-image-stage img {\n  position: absolute;\n  z-index: -1;\n}\n.vcrop-ux-inactive-handles .vcrop-widget .vcrop-handle {\n  display: block;\n}\n.vcrop-widget img {\n  width: 100%;\n  height: auto;\n}\n.vcrop-ux-fade-more .vcrop-widget {\n  opacity: 0.25;\n}\n.vcrop-ux-fade-more .vcrop-widget:hover {\n  transition: opacity 0.4s;\n  opacity: 0.8;\n}\n.vcrop-ux-fade-more .vcrop-widget:focus {\n  transition: opacity 0.5s;\n  opacity: 1;\n  outline-style: auto;\n  outline-width: 3px;\n  outline-color: rgba(0, 0, 0, 0.3);\n}\n.vcrop-ux-fade-more .vcrop-widget {\n  opacity: 0.25;\n}\n.vcrop-ux-fade-more .vcrop-widget:hover {\n  opacity: 0.65;\n}\n.vcrop-ux-keep-current .vcrop-widget.active {\n  opacity: 1;\n  outline-style: auto;\n  outline-width: 3px;\n  outline-color: rgba(0, 0, 0, 0.3);\n}\n.vcrop-ux-no-outline .vcrop-widget {\n  outline: none !important;\n}\n.vcrop-disable.vcrop-stage {\n  opacity: 0.8;\n}\n.vcrop-disable.vcrop-stage .vcrop-widget {\n  outline: none !important;\n}\n");var $e={attach:function(e,t){return new je(e,t)},Rect:De};function qe(e){const{type:t,roate:s,...i}=e;return n.createElement("i",i,n.createElement("svg",{className:`icon${s?" icon-roate":""}`,"aria-hidden":"true"},n.createElement("use",{xlinkHref:`#icon${t}`})))}s(".player {\n  display: inline-block;\n  height: 100%;\n  width: 100%;\n  min-width: 100px;\n  min-height: 100%;\n  color: #ddd;\n  position: relative;\n}\n.player * {\n  margin: 0;\n  padding: 0;\n  font-size: 16px;\n  box-sizing: border-box;\n  user-select: none;\n}\n.player .icon {\n  width: 1em;\n  height: 1em;\n  vertical-align: 0em;\n  fill: currentColor;\n  overflow: hidden;\n}\n.player .icon-roate {\n  animation: loadingCircle 1s infinite linear;\n}\n.player .info {\n  display: inline-block;\n  vertical-align: bottom;\n}\n.player-container {\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  height: 100%;\n  background: #000;\n}\n.player-video-warp {\n  position: relative;\n  flex: 1;\n  width: 100%;\n}\n.player-video-instance {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n}\n.player-video-state {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n}\n.player-video-infos {\n  position: absolute;\n  padding-right: 20px;\n  bottom: 10px;\n  background-color: #ddd;\n  color: #000;\n  min-width: 100px;\n}\n.player-video-bottom {\n  width: 100%;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  transition: height 0.5s;\n  overflow: hidden;\n}\n.player-video-btnWrap {\n  position: absolute;\n  left: 0;\n  bottom: 4px;\n  display: flex;\n  z-index: 1;\n}\n.player-video-btnWrap-btn {\n  width: 20px;\n  height: 16px;\n  align-items: center;\n  cursor: pointer;\n}\n.player-video-progress {\n  position: relative;\n  overflow: hidden;\n  height: 6.5em;\n  background: rgba(0, 0, 0, 0.5);\n}\n.player-video-progress-speed {\n  height: 30px;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n}\n.player-video-progress-speed-wrap {\n  width: 100px;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n}\n.player-video-progress-speed-wrap span {\n  display: inline-block;\n  width: 30px;\n  color: #ffffff;\n  font-size: 12px;\n  line-height: 30px;\n  text-align: center;\n}\n.player-video-progress-bar-time {\n  position: relative;\n  height: 30px;\n  display: flex;\n  flex-direction: row;\n}\n.player-video-progress-bar-time-wrap {\n  position: relative;\n  top: 20px;\n  flex: 1;\n  height: 0.5em;\n  border-bottom: 1px solid #0a92e2;\n}\n.player-video-progress-icon {\n  display: inline-block;\n  width: 30px;\n  height: 20px;\n  color: #ffffff;\n  text-align: center;\n  cursor: pointer;\n}\n.player-video-progress .time-icon:first-of-type {\n  text-align: left;\n  padding-top: 5px;\n}\n.player-video-progress .time-icon:last-of-type {\n  padding-top: 5px;\n  text-align: right;\n}\n.player-video-progress-bar-timetext {\n  position: absolute;\n  left: 0px;\n  right: -1px;\n  top: 0px;\n  height: 30px;\n  overflow: hidden;\n}\n.player-video-progress-bar-timetext-div {\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n.player-video-progress-bar-timetext span {\n  position: absolute;\n  top: 0px;\n  color: #ffffff;\n  font-size: 12px;\n  text-indent: -15px;\n}\n.player-video-progress-bar-timetext span::before {\n  content: '';\n  position: absolute;\n  left: 0;\n  bottom: -11px;\n  width: 1px;\n  height: 5px;\n  background-color: #0a92e2;\n}\n.player-video-progress-bar-timetext span:first-of-type {\n  text-indent: -10px;\n}\n.player-video-progress-bar-timetext span:last-of-type {\n  text-indent: -20px;\n}\n.player-video-progress-bar-timetext span:last-of-type::before {\n  left: -1px;\n}\n.player-video-progress-video-track {\n  position: relative;\n  margin: 10px 0px;\n  height: 0.5em;\n}\n.player-video-progress-bar,\n.player-video-progress-bar-warp {\n  position: absolute;\n  left: 0px;\n  top: 0px;\n  right: 0px;\n  height: 0.5em;\n  overflow: hidden;\n}\n.player-video-progress-bar {\n  background-color: hsla(0, 0%, 100%, 0.2);\n  transform-origin: 0 0;\n  transition: transform 0.2s;\n}\n.player-video-progress-bar-normal {\n  background-color: red;\n}\n.player-video-progress-bar-files {\n  position: relative;\n  height: 10px;\n}\n.player-video-progress-bar-files p {\n  position: absolute;\n  top: 0;\n  height: 10px;\n  background-color: #0a92e2;\n}\n.player-video-progress-scroll {\n  margin: 10px 30px;\n  height: 0.5em;\n  background-color: hsla(0, 0%, 100%, 0.2);\n}\n.player-video-progress-scroll-bar {\n  position: relative;\n  left: 0;\n  height: 0.5em;\n  background-color: hsla(0, 0%, 100%, 0.5);\n  border-radius: 0.5em;\n  transform-origin: left;\n}\n.player-video-progress-title {\n  position: absolute;\n  background-color: #ffffff;\n  width: 140px;\n  line-height: 20px;\n  border-radius: 3px;\n  text-align: center;\n  z-index: 2;\n  font-size: 12px;\n  color: #333333;\n}\n.player-video-progress-pos {\n  display: inline-block;\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  width: 2px;\n  height: 15px;\n  background-color: red;\n}\n.player-video-controls {\n  position: absolute;\n  left: 0;\n  right: 0;\n}\n.player-video-controls-left,\n.player-video-controls-right {\n  flex: 1;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  height: 32px;\n}\n.player-video-controls-right {\n  place-content: flex-end;\n}\n.player-video-controls-btn {\n  display: inline-flex;\n  align-items: center;\n  margin: 0 5px;\n  height: 24px;\n  cursor: pointer;\n  z-index: 10;\n}\n.player-center {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n}\n@keyframes loadingCircle {\n  100% {\n    transform: rotate(360deg);\n  }\n}\n");const et={rtsp:"ws",rtmp:"ws",default:"http"},tt=Object.keys(et);function st(e,t){const s=tt.find(t=>e.startsWith(t))||"default",n=et[s];return"ws"===n&&(e=`ws://${t||"127.0.0.1:19060"}/URL/`+e),{url:e,type:n}}var nt=n.forwardRef((function(e,s){const[i,r]=t.useState(!0),[o,a]=t.useState(null),[l,c]=t.useState(null),u=t.useRef(!1),[h,p]=t.useState(0),m=t.useRef(null),f=t.useRef(null),y=t.useRef(null),g=t.useRef(null);function Z(e,t=!0){if(s){const n=s.current,i=Object.create(e),r={play:V,pause:R,seek:S,capture:L,screenshot:x,showMessage:G,fullScreen:U,exitFullScreen:w,playTime:0};Object.keys(r).forEach(e=>{i[e]=r[e]}),s.current=new Proxy(i,{set:(t,s,n)=>(t.hasOwnProperty(s)?t[s]=n:e[s]=n,!0)}),t&&n&&(e.copyEvent(n),n.destory())}t&&(e.on("waiting",()=>{r(!0)}),e.on("seeking",()=>{r(!0)}),e.on("loadedmetadata",()=>{r(!1)}),e.on("playing",()=>{r(!1)}),e.on("destory",e=>{r(!1)}),e.on("error",e=>{r(!1),a(e)}),e.on("timeupdate",S))}function v(){if(!g.current)return;const{avParams:e}=g.current;if(!e)return;const{width:t,height:s}=e.video,{width:n,height:i}=f.current.getBoundingClientRect(),r=Math.floor(1e4*Math.min(n/t,i/s))/1e4;g.current.setSize(r*t,r*s)}function V(){u.current=!0,g.current&&g.current.play()}function R(){u.current=!1,g.current&&g.current.pause()}function S(t){const s=g.current;s.seek(async()=>{const n=await t();s.url=st(n,e.host).url})}t.useEffect(()=>{if(e.url){if(!g.current.error){g.current=Ye(),s&&!s.current&&Z(g.current,!1);const{type:t,url:n}=st(e.url,e.host);(async function(e){if(Be.warn(!1,"当前总播放数0, 推荐播放数16"),window.mseT){const t=b.create({url:e.url,type:e.type});await t.open();const[s,n]=d();return t.onDownBuffer=n=>{b.destory(t),Ae.probe(n)?s[0](new Ae(e)):s[0](new ee(e))},n}return new ee(e)})({el:y.current,url:n,type:t,isLive:e.isLive}).then(t=>{g.current=t,Z(t),t.load().then(()=>{(e.autoplay||u.current)&&V(),v(),t.shouldRender=e.shouldRender})})}return()=>{g.current.destory()}}},[e.url]),t.useEffect(()=>(addEventListener("resize",v),()=>removeEventListener("resize",v)),[]);const L=e=>{const t=g.current.el;let s,n,i=0,r=0;e?({x:i,y:r,w:s,h:n}=e):({width:s,height:n}=t.getBoundingClientRect());const o=document.createElement("canvas"),a=o.getContext("2d");return o.width=s,o.height=n,a.drawImage(t,i,r,s,n,0,0,s,n),o.toDataURL()},x=e=>{const t=g.current;if(!t.shouldRender)return{};t.shouldRender=!1;const s=y.current,n=document.createElement("div");n.className="player-center";const{width:i,height:r}=s.getBoundingClientRect();n.style.width=i+"px",n.style.height=r+"px",f.current.appendChild(n);const o=$e.attach(n,{multi:!1});return o.listen("new widget",()=>{const t=Array.from(o.widgets)[0];t.listen("crop.change",()=>{const{x:s,y:n,w:i,h:r}=t.pos;e&&e(t.el,{x:s,y:n,w:i,h:r})})}),{getScreenshot:function(){const e=Array.from(o.widgets)[0];if(!e)return null;const{x:t,y:s,w:n,h:a}=e.pos,l=L(e.pos),c=m.current.getBoundingClientRect();return{dataUrl:l,pos:{x:(c.width-i)/2+t,y:(c.height-r)/2+s,w:n,h:a}}},remove:function(){t.shouldRender=!0,n.remove()}}},G=(e,t="error")=>{a(e),g.current.onerror(e)},U=e=>{m.current.requestFullscreen(),m.current.onfullscreenchange=t=>{document.fullscreenElement===t.target||(m.current.onfullscreenchange=null,e&&e()),v()}},w=()=>{document.exitFullscreen()};return g.current||(g.current=Ye(),s&&Z(g.current,!1)),n.createElement("div",{className:"player",style:e.style,ref:m},n.createElement("div",{className:"player-container"},n.createElement("div",{className:"player-video-warp",ref:f},n.createElement("div",{className:"player-video-instance",ref:y}),n.createElement("div",{className:"player-center",style:{width:"100%",height:"100%"}}),o?n.createElement("span",{className:"player-center"},o):null,n.createElement("div",{className:"player-video-state"},i?n.createElement(qe,{type:"loading",roate:!0}):null),n.createElement("div",{className:"player-video-infos",style:{zIndex:100,display:"block"}},l?n.createElement("div",null,n.createElement("div",null,"大小: ",l.width," * ",l.height),n.createElement("div",null,"帧率: ",l.rate)):null,null)),e.children))}));const it=[1,2,3,4,5,6,8,10,12,15,20,24,30,40,60,120];function rt(e){const[s,n]=t.useState([]);return t.useEffect(()=>{const t=function(){let t=["0:00"];return t=function e(t,s,n){if(t<=0)return n;const i=t-s;let r=i/60+"";r=parseInt(r)<10?`0${parseInt(r)}`:parseInt(r)+"";const o=i%60<10?`0${i%60}`:i%60;return n.push(`${r}:${o}`),e(i,s,n)}(1440,e,t),t}();n([...t.reverse()])},[e]),s}function ot(e){const[s,n]=t.useState({counts:120,leftPos:0,initCount:120});return t.useEffect(()=>{const{remove:t}=function(e,t,s,n){function i(s){s.preventDefault(),s.stopPropagation(),t(s)&&"mouseenter"===s.type&&(e.addEventListener("mousewheel",r),e.addEventListener("mouseleave",o))}function r(e){e.stopPropagation(),e.preventDefault(),s(e.deltaY,e.clientX)}function o(t){e.removeEventListener("mouseleave",o),e.removeEventListener("mousewheel",r),n()}return"string"==typeof e&&(e=document.getElementById(e)),e.addEventListener("mouseenter",i),{remove:function(){e.removeEventListener("mousewheel",i)}}}(e.current,e=>!0,(t,s)=>{n(n=>{const{x:i}=e.current.getBoundingClientRect(),r=(o=n.counts,it.findIndex(e=>e===120/o));var o;let a=n.counts,l=n.counts;return t>0?r>0&&(a=120/it[r-1]):r<it.length-1&&(a=120/it[r+1]),{...n,counts:a,leftPos:s-i,initCount:l}})},()=>{});return()=>t()},[]),s}var at=n.forwardRef((function(e,s){const i=t.useRef(null),r=t.useRef(null),o=t.useRef(null),a=function(e){const[s,n]=t.useState(null);function i(){const t=e.current.offsetWidth/12;n(t)}return t.useEffect(()=>(i(),window.addEventListener("resize",i),()=>removeEventListener("resize",i)),[]),s}(r),{counts:l,leftPos:c,initCount:u}=ot(e.mouseWheelRef),h=rt(l);return t.useEffect(()=>{e.getCount&&e.getCount(l,c,u)},[l]),t.useEffect(()=>{e.getRuleRef&&e.getRuleRef(o)}),t.useEffect(()=>{e.getBaseWidth&&e.getBaseWidth(a)},[a]),n.createElement("div",{className:"player-video-progress-bar-time",ref:i},n.createElement("div",{className:"player-video-progress-bar-time-wrap",ref:r}),n.createElement("div",{className:"player-video-progress-bar-timetext"},n.createElement("div",{ref:o,className:"player-video-progress-bar-timetext-div",style:{width:`${a*(h.length-1)}px`}},h.map((e,t)=>n.createElement("span",{key:t,style:{left:`${t*a}px`}},e)))))}));async function lt(e,t,s=6e4){return e="/api/vms/v1/webuas/device"+e,new Promise((s,n)=>{fetch(e,t).then(e=>{if(e.ok)return e.json()}).then(e=>{e.error_code?n({code:e.error_code,message:e.description||e.message}):s(e.data)}).catch(e=>e)})}lt.get=(e,t,...s)=>lt(function(e,t){if(!t)return"";const s=Object.keys(t).map((e,s)=>`${e}=${t[e]}`);return`${e}${s.length?`?${s.join("&")}`:""}`}(e,t),{headers:{Accept:"application/json"}},...s),["POST","PUT","DELETE"].forEach(e=>{lt[e.toLowerCase()]=(t,s,...n)=>lt(t,{method:e,headers:{Accept:"application/json","Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(s)},...n)});const ct=lt;function ut(e,s,n){const i=t.useRef(!1),[r,o]=t.useState(!1);t.useEffect(()=>{const t=e.playerRef.current;return t.on("play",l),t.on("pause",()=>{o(!1),c(),n()}),t.on("playing",()=>{o(!0),s()}),()=>{n()}},[]);const a=t.useCallback(()=>{o(!1);const t=e.playerRef.current,{download:s}=t;s.onpause=c,s.onresume=l,t.once("playing",()=>{i.current=!1,s.onpause=null,s.onresume=null}),t.once("pause",()=>{i.current=!1,s.onpause=null,s.onresume=null})},[]);function l(){const{camera_id:t,source_type:s,id:n}=e;var i;i={camera_id:t,source_type:s,id:n},ct.get("/video/record/replay-resume",i)}function c(){const{camera_id:t,source_type:s,id:n}=e;var i;i={camera_id:t,source_type:s,id:n},ct.get("/video/record/replay-pause",i)}return{isPlaying:r,framePlay:function(){const t=e.playerRef.current;i.current||(i.current=!0,a()),t.framePlay()}}}function ht(e){return new Date(e).getTime()/1e3}function dt(e){const t=parseInt(`${e}`),s=parseInt(`${t/3600}`),n=parseInt(`${(t-60*s*60)/60}`),i=t-60*s*60-60*n;return`${s<10?"0"+s:s}:${n<10?"0"+n:n}:${i<10?"0"+i:i}`}function pt(e){const t=new Date(e),s=t.getFullYear(),n=t.getMonth()+1,i=t.getDate();return`${s}-${n<10?"0"+n:n}-${i<10?"0"+i:i}`}function mt(e,s){const[n,i]=t.useState(0),r=t.useRef({interval:0}),o=t.useRef(null);function a(){if(!e.fileData.length)return;const t=e.playerRef.current,{start_time:n}=e,r=Math.round(t.currentTime/1e3),{startTime:o,playTime:a}=function(e,t,s){let n,i;s.current&&(n=ht(s.current));for(let s=0;s<e.length;s++){const r=e[s];if(i=ht(r.end_time),n>i)continue;n<ht(r.start_time)&&(n=ht(r.start_time));const o=i-n;if(t<=o)break;t>o&&(t-=o)}return{startTime:n,playTime:t}}(e.fileData,r,s),l=ht(new Date(n).setHours(0,0,0,0));i(o-l+a),t.playTime=1e3*o+1e3*a}function l(){clearInterval(r.current.interval)}return(t.useEffect(()=>{o.current=a},[e.fileData]),{realPlayTime:n,updateTime:function(){l(),r.current.interval=window.setInterval(()=>{o.current()},1e3)},cancelTime:l})}const ft=["1/16","1/8","1/4","1/2","1","2","4","8","16"],yt=[-4,-3,-2,-1,0,1,2,3,4];function bt(e){const[s,i]=t.useState(0),[r,o]=t.useState(null),[a,l]=t.useState(ft[4]),[c,u]=t.useState(!1),h=t.useRef(null),d=t.useRef(""),p=t.useRef(null),m=t.useRef(null),f=t.useRef(null),y=t.useRef(null),b=t.useRef(null),g=t.useRef(null),Z=t.useRef(null),v=t.useRef({interval:null}),V=t.useRef({ruleLength:12}),R=t.useRef({secondsWidth:0}),S=t.useRef({leftPos:0,beforeCount:0}),{camera_id:L,source_type:x,id:G,fileData:U,start_time:w}=e;function W(e){const t=f.current.offsetWidth,{ruleLength:s}=V.current;m.current.style.width=s&&`${12/s*t}px`;const{offsetWidth:n}=m.current,i=t-n;let o=i?(s*r-t)/i:1;if(e){!function(e,t){m.current.style.left=`${e}px`,y.current.style.left=`${-e*t}px`,h.current.style.left=`${-e*t}px`}(function(){const e=f.current.offsetWidth,{offsetWidth:t,offsetLeft:s}=m.current,n=e-t;let i=1,r=s-30;i=document.fullscreenElement?e/t:t/e;r*=i,r>n&&(r=n);0===n&&(r=0);return r}(),o),E(o)}else if(T()){const{eventLeft:e,scale:t}=T();!function(e,t){h.current.style.left=`${-e}px`,m.current.style.left=1!==t?`${e/t}px`:"0px",y.current.style.left=`${-e}px`}(e,o),E(t)}}function T(){const e=f.current.offsetWidth,{leftPos:t,beforeCount:n}=S.current,i=-h.current.offsetLeft,{ruleLength:o}=V.current;let a=1;if(!s||n===s)return;a=n/s;let l=(t+i)*a-t;return l<0&&(l=0),l>o*r-e&&(l=o*r-e),{eventLeft:l,scale:a}}function E(e){if(g.current){const t=g.current.offsetLeft;g.current.style.left=`${t*e}px`}}function X(t){let s=ft.findIndex(e=>e===a);if(s<0)return;t?s+=1:s-=1,l(ft[s]);const n=yt[s];e.playerRef.current.playbackRate=n<0?1/(1<<-n):1<<n}R.current.secondsWidth=1e4*r/(60*s),t.useEffect(()=>{let e,t,s,n,i,r;const{remove:o}=Pe(m.current,(o,a,l)=>(s=f.current.offsetWidth,t=m.current.offsetLeft-30,e=m.current.offsetWidth,n=V.current.ruleLength,i=(p.current.offsetWidth-60)/12,r=(n*i-s)/(s-e),!0),(n,i,o,a)=>{if(o){let n=t+o;n>s-e&&(n=s-e),n<0&&(n=0),h.current.style.left=`${-n*r}px`,y.current.style.left=`${s/e*-n}px`,m.current.style.left=`${n}px`}},()=>{});return()=>o()},[]),t.useEffect(()=>{let e,t;function s(e,t,s){b.current.style.left=`${e}px`,b.current.style.top=`${t+40}px`,b.current.innerHTML=s}function n(e){const{secondsWidth:t}=R.current;return`${pt(w)} ${dt(1e4*e/t)}`}const{remove:i}=function(e,t,s,n){let i,r;function o(s){const n=s.target.offsetLeft;i=s.offsetX,r=s.offsetY,s.preventDefault(),s.stopPropagation(),t(i,r,n)&&"mouseenter"===s.type&&(e.addEventListener("mousemove",a),e.addEventListener("mouseleave",l))}function a(e){e.preventDefault(),e.stopPropagation();const t=e.target.offsetLeft;let n=e.offsetX-i;const o=e.offsetY-r;t>0&&(n+=t),s(n,o,n+i)}function l(t){const o=t.target.offsetLeft;let c=t.offsetX-i;const u=t.offsetY-r;o>0&&(c+=o),c&u&&s(c,u,c+i),e.removeEventListener("mouseleave",l),e.removeEventListener("mousemove",a),n()}return"string"==typeof e&&(e=document.getElementById(e)),e.addEventListener("mouseenter",o),{remove:function(){e.removeEventListener("mousemove",o)}}}(y.current,(i,r,o)=>{u(!0),e=p.current.offsetWidth;let a=i;return o<0&&(a=i+o),e-a<140&&(a=e-140),s(a,r,n(i)),t=b.current.offsetLeft,!0},(i,r,o)=>{let a=t+i;e-a<140&&(a=e-140),s(a,r,n(o))},()=>{u(!1)});return()=>i()},[]),t.useEffect(()=>{W(!1)},[s]),t.useEffect(()=>{W(!0)},[r]),t.useEffect(()=>{const{fileData:t}=e;if(t.length){const e=p.current.offsetWidth/12,s=t[0].start_time;d.current=s;const n=ht(new Date(s).setHours(0,0,0,0)),i=ht(s),r=parseInt(`${e/7200*(i-n)}`);g.current.style.left=`${r}px`}else d.current=""},[e.fileData]),t.useEffect(()=>{const e=ft.findIndex(e=>e===a);-1!==e&&(clearTimeout(v.current.interval),v.current.interval=setTimeout(()=>{!function(e){if(!G)return;t={camera_id:L,source_type:x,id:G,speed:e},ct.get("/video/record/replay-speed",t);var t}(yt[e])},300))},[a]);const{realPlayTime:k,updateTime:M,cancelTime:N}=mt(e,d),{isPlaying:I,framePlay:C}=ut(e,M,N);return t.useEffect(()=>{const{secondsWidth:e}=R.current,t=parseInt(`${e*k/1e4}`);g.current.style.left=`${t}px`},[k]),n.createElement("div",{className:"player-video-progress",ref:p},n.createElement("div",{className:"player-video-progress-speed"},n.createElement("div",{className:"player-video-progress-speed-wrap"},n.createElement(qe,{className:"player-video-progress-icon",type:"left",onClick:()=>X(!1)}),n.createElement("span",null,a,"x"),n.createElement(qe,{className:"player-video-progress-icon",type:"right",onClick:()=>X(!0)})),I?n.createElement(qe,{className:"player-video-progress-icon",type:"pause",title:"播放",onClick:function(){e.playerRef.current.pause()}}):n.createElement(qe,{className:"player-video-progress-icon",type:"play",title:"暂停",onClick:function(){e.playerRef.current.play()}}),n.createElement(qe,{className:"player-video-progress-icon",type:"singleframe",title:"单帧播放",onClick:C})),n.createElement("div",{ref:Z,style:{margin:"0 30px"}},n.createElement(at,{mouseWheelRef:Z,getCount:function(e,t,s){i(e),V.current.ruleLength=1440/e,S.current={...S.current,leftPos:t,beforeCount:s}},getRuleRef:function(e){h.current=e.current},getBaseWidth:function(e){o(e)}}),n.createElement("div",{className:"player-video-progress-video-track"},n.createElement("div",{className:"player-video-progress-bar-warp"},n.createElement("div",{className:"player-video-progress-bar player-video-progress-bar-buffer",style:{transform:"scaleX()"}},n.createElement("div",{className:"player-video-progress-bar-files",ref:y,style:{width:`${r*V.current.ruleLength}px`}},U.map(t=>{const{secondsWidth:s}=R.current,i=ht(new Date(w).setHours(0,0,0,0)),r=ht(t.start_time),o=ht(t.end_time);let a=Math.round(s*(r-i)/1e4),l=Math.round((o-r)*s/1e4);return n.createElement("p",{style:{left:`${a}px`,width:`${l}px`},key:t.file_name,onDoubleClick:t=>function(t,s){const{secondsWidth:n}=R.current,i=t.nativeEvent.layerX+s,r=`${pt(w)} ${dt(1e4*i/n)}`;g.current.style.left=`${i}px`,e.seekCallback&&e.seekCallback(r),d.current=r}(t,a)})}),n.createElement("i",{className:"player-video-progress-pos",ref:g})))))),n.createElement("div",{className:"player-video-progress-scroll",ref:f,style:{width:`${12*r}px`}},n.createElement("div",{ref:m,className:"player-video-progress-scroll-bar"})),c?n.createElement("div",{className:"player-video-progress-title",ref:b}):null)}var gt=n.forwardRef((function(e,s){const[i,r]=t.useState(!1);return n.createElement("div",{className:"player-video-controls"},n.createElement("div",{className:"player-video-controls-right"},n.createElement(qe,{className:"player-video-controls-btn",type:"mute",title:"静音"}),i?n.createElement(qe,{className:"player-video-controls-btn",type:"exitfullscreen",title:"退出全屏",onClick:function(){e.playerRef.current.exitFullScreen()}}):n.createElement(qe,{className:"player-video-controls-btn",type:"fullscreen",title:"全屏",onClick:function(){r(!0),e.playerRef.current.fullScreen(()=>{r(!1)})}})))}));const Zt=!function(){if(localStorage.getItem("browserval"))return!0;const e=navigator.userAgent.toLocaleLowerCase(),t=/(chrome)\/([\w.]+)/.exec(e);return(t&&parseInt(t[2]))>=74&&(localStorage.setItem("browserval","1"),!0)}()&&"请下载新版chrome",vt=n.createElement("div",null,"请下载插件",n.createElement("a",{href:"/bclient/commonresource/chromeocx.exe"},"点击下载")),Vt=()=>n.createElement(n.Fragment,null,n.createElement("div",null,"有可更新插件",n.createElement("a",{href:"/bclient/commonresource/chromeocx.exe"},"点击下载")),n.createElement("div",null,"当前版本",St,", 服务器版本",Rt));let Rt="",St="";function Lt(e){const[s,n]=t.useState(Zt);function i(t,s){e.current.error||function(e,t){const s=e.split(".").map(e=>Number(e)),n=t.split(".").map(e=>Number(e));for(let e=0;e<s.length;e++)if(n[e]=n[e]||0,s[e]!==n[e])return s[e]>n[e];return s.length===n.length}(t,s)||(e.current.showMessage(Vt),n(vt))}return t.useEffect(()=>{s&&e.current.showMessage(s),e.current.on("downerror",t=>{"network error 22"===t&&(e.current.showMessage(vt),n(vt))}),e.current.on("downmsg",e=>{St=e.server_version,Rt&&i(St,Rt)}),async function(){if(Rt)return Rt;const e=await fetch("/bclient/commonresource/config.json"),t=(await e.json()).chromeocxVersion;return Rt=t.split(" ")[0].substr(2),Rt}().then(e=>{St&&i(St,e)})},[]),s}function xt(e){const s=Lt(e),[n,i]=t.useState(s);return t.useEffect(()=>{e.current.on("error",e=>i(e))},[]),{broken:s,error:n,setErrorStatus:function(t){e.current.showMessage(t),i(t)}}}function Gt(e,s){s||(s=t.useRef(null));const[r,o]=t.useState(null),{camera_id:a,stream_mode:l,stream_type:c,is_local:u}=e,{broken:h,error:d,setErrorStatus:p}=xt(s);return t.useEffect(()=>{var e;(e={camera_id:a,stream_mode:l,stream_type:c,is_local:u},ct.get("/video/preview",e)).then(e=>{h||(o(e),p(!1))}).catch(e=>{s.current.showMessage(`${e.code} ${e.message}`)})},[e.camera_id]),n.createElement(nt,i({ref:s},e,{url:r,autoplay:!0,shouldRender:!0,isLive:!0}),d?null:n.createElement("div",{className:"player-video-bottom",style:{height:32}},n.createElement(gt,{playerRef:s})))}function Ut(e,s){s||(s=t.useRef(null));const[r,o]=t.useState(null),[a,l]=t.useState(null),[c,u]=t.useState([]),[h,d]=t.useState(!1!==e.progress),{broken:p,error:m,setErrorStatus:f}=xt(s),y=t.useRef(null);function b(t,n){const{camera_id:i,source_type:r,stream_mode:o,is_local:a,rate:c}=e;return(u={camera_id:i,stream_mode:o,source_type:r,start_time:t,end_time:n,is_local:a,rate:c},ct.get("/video/record/replay-url",u)).then(({url:e,id:t})=>{if(!p)return l(t),y.current=t,e}).catch(e=>{s.current.showMessage(`${e.code} ${e.message}`)});var u}function g(){s.current.pause()}function Z(t){s.current.seek(()=>b(t,e.end_time))}return t.useEffect(()=>{const{start_time:t,end_time:n}=e;!function(t,n){const{camera_id:i,source_type:r}=e;(o={camera_id:i,source_type:r,start_time:t,end_time:n},ct.get("/video/files",o)).then(e=>{!function(e,t,s){let n=[];e.forEach(e=>{e.start_time<t&&(e.start_time=t),e.end_time>s&&(e.end_time=s);let i=n[n.length-1];i&&e.start_time===i.end_time?(i.end_time=e.end_time,n[n.length-1]={...i}):n.push({...e})}),u(n)}(e,t,n)}).catch(e=>{s.current.showMessage(`${e.error} ${e.message}`)});var o}(t,n),b(t,n).then(e=>{o(e),e&&f(!1)})},[e.camera_id,e.start_time,e.end_time]),n.createElement(n.Fragment,null,n.createElement(nt,i({ref:s},e,{url:r,autoplay:!0,shouldRender:!0,pauseCallback:g,seekCallback:Z}),m?null:n.createElement("div",{className:"player-video-bottom",style:{height:h?"120px":"25px"}},n.createElement("div",{className:"player-video-btnWrap"},h?n.createElement(qe,{type:"close",className:"player-video-btnWrap-btn",onClick:function(){d(!1)}}):n.createElement(qe,{type:"open",className:"player-video-btnWrap-btn",onClick:function(){d(!0)}})),n.createElement(gt,{playerRef:s}),n.createElement(bt,i({playerRef:s},e,{id:a,fileData:c,pauseCallback:g,seekCallback:Z})))))}function wt(e,s){s||(s=t.useRef(null));const{broken:r,error:o,setErrorStatus:a}=xt(s);return t.useEffect(()=>{e.url&&!r&&a(!1)},[e.url]),n.createElement(nt,i({ref:s,autoplay:!0,shouldRender:!0,isLive:!0},e),o?null:n.createElement("div",{className:"player-video-bottom",style:{height:32}},n.createElement(gt,{playerRef:s})))}Gt=n.forwardRef(Gt),Ut=n.forwardRef(Ut),wt=n.forwardRef(wt),function(e){var t,s='<svg><symbol id="iconopen" viewBox="0 0 1024 1024"><path d="M894.31191406 389.28183594L552.5 763.06044922a53.79082031 53.79082031 0 0 1-40.40507813 18.28212891 53.79082031 53.79082031 0 0 1-40.40859375-18.28212891L129.87441406 389.28183594c-16.68603516-17.62382812-21.84257812-43.31162109-13.21875-65.99970703s29.43720703-38.53125 53.62558594-40.68632813h683.34433594c24.28154297 2.06279297 45.18632812 17.81103516 53.81191406 40.59404297 8.71875 22.78125 3.56308594 48.37324219-13.12558594 66.09199219z"  ></path></symbol><symbol id="iconclose" viewBox="0 0 1024 1024"><path d="M129.68808594 634.71816406L471.5 260.93955078a53.79082031 53.79082031 0 0 1 40.40507813-18.28212891 53.79082031 53.79082031 0 0 1 40.40859375 18.28212891L894.12558594 634.71816406c16.68603516 17.62382812 21.84257812 43.31162109 13.21875 65.99970703s-29.43720703 38.53125-53.62558595 40.68632813l-683.34433593 1e-8c-24.28154297-2.06279297-45.18632812-17.81103516-53.81191406-40.59404297-8.71875-22.78125-3.56308594-48.37324219 13.12558594-66.0919922z"  ></path></symbol><symbol id="iconsingleframe" viewBox="0 0 1024 1024"><path d="M144.39853408 916.80564219c15.27794121 7.37679815 33.44832247 5.36756045 46.75030313-5.21106681l459.21065537-364.9653536c10.55614307-8.39220996 16.71336826-21.14196592 16.71336826-34.63102002 0-13.48905411-6.15722519-26.23881006-16.71336826-34.63102002l-459.21065537-364.96535361c-7.98208857-6.34519776-17.71349063-9.6063873-27.53033468-9.6063873-6.5340703 0-13.11131074 1.44621915-19.21906933 4.39531962-15.29323154 7.38219463-25.01384063 22.86429785-25.01384062 39.84208682L119.38559258 876.96355449C119.38469346 893.94134346 129.10530255 909.42344668 144.39853408 916.80564219zM207.86130635 238.70139629L551.73505976 511.99820088l-343.87375341 273.29680459L207.86130635 238.70139629zM805.07979161 858.98654317L805.07979161 156.27857891c0-27.48716367 22.28059335-49.76775703 49.76775702-49.76775704 27.48806279 0 49.76775703 22.28059335 49.76775703 49.76775703L904.61530654 858.98654317c0 27.48626455-22.28059335 49.76775703-49.76775703 49.76775703C827.36038584 908.7543002 805.07979161 886.47280771 805.07979161 858.98654317z"  ></path></symbol><symbol id="iconsync" viewBox="0 0 1024 1024"><path d="M417.32703828 417.31849443l488.15573027 0 0 488.15483115-488.15573027 0 0-488.15483115Z"  ></path><path d="M362.61173516 362.60319131L606.6720626 362.60319131 606.6720626 118.52577529 118.51633232 118.52577529 118.51633232 606.68150557 362.61173516 606.68150557Z"  ></path></symbol><symbol id="iconiconstop" viewBox="0 0 1024 1024"><path d="M276.11153281 117.01749834l470.5690544 0c86.63016445 0 156.85365323 70.54546992 156.85365321 157.57316543l0 472.71949629c0 87.01960078-70.22348877 157.57316542-156.85365321 157.57316543L276.11153281 904.88332549c-86.6220706 0-156.84555849-70.55356464-156.8455585-157.57316543l2e-8-472.71949629C119.26597344 187.56296826 189.48946221 117.01749834 276.11153281 117.01749834z"  ></path></symbol><symbol id="iconright" viewBox="0 0 1024 1024"><path d="M118.25 118.25h787.5v787.5H118.25V118.25z m723.95507813 63.54492188H181.79492187v660.49804687h660.49804688V181.79492187zM372.25390625 664.40234375L581.87304688 512 372.25390625 359.59765625l38.14453125-50.80078125L683.47460938 512 410.3984375 715.203125 372.25390625 664.40234375z"  ></path></symbol><symbol id="iconleft" viewBox="0 0 1024 1024"><path d="M905.75 118.25H118.25v787.5h787.5V118.25z m-723.95507813 63.54492188h660.49804688v660.49804687H181.79492187V181.79492187zM651.74609375 664.40234375L442.12695312 512 651.74609375 359.59765625l-38.14453125-50.80078125L340.52539062 512l273.07617188 203.203125 38.14453125-50.80078125z"  ></path></symbol><symbol id="iconcut" viewBox="0 0 1024 1024"><path d="M814.81066895 165.93066406c23.86951447 0 43.258667 19.38915253 43.25866699 43.258667v605.62133789c0 23.86951447-19.38915253 43.258667-43.258667 43.25866699H209.18933105c-23.86951447 0-43.258667-19.38915253-43.25866699-43.25866699V209.18933105c0-23.86951447 19.38915253-43.258667 43.258667-43.25866699h605.62133789m0-49.43847656H209.18933105C157.97415924 116.4921875 116.4921875 157.97415924 116.4921875 209.18933105v605.62133789c0 51.21517182 41.48197175 92.69714356 92.69714356 92.69714356h605.62133789c51.21517182 0 92.69714356-41.48197175 92.69714355-92.69714356V209.18933105c0-51.21517182-41.48197175-92.69714356-92.69714355-92.69714355z" fill="" ></path><path d="M685.03466797 487.28076172H338.96533203c-13.67282868 0-24.71923828 11.04640961-24.71923828 24.71923828s11.04640961 24.71923828 24.71923828 24.71923828h346.06933594c13.67282868 0 24.71923828-11.04640961 24.71923828-24.71923828s-11.04640961-24.71923828-24.71923828-24.71923828z" fill="" ></path></symbol><symbol id="iconadd" viewBox="0 0 1024 1024"><path d="M862.29546875 826.3559375c-2.295 45.48234375-58.22296875 35.70328125-89.319375 35.70328125H239.36328125c-29.4553125 0-68.90484375 3.57328125-68.90484375-38.70703125v-106.04671875-392.293125-113.805c0-40.48734375 33.12984375-40.9978125 63.061875-40.9978125H765.2684375c28.31203125 0 75.8615625-9.01546875 93.05296875 19.2796875 5.61515625 9.24328125 3.9740625 23.135625 3.9740625 33.64875V826.3559375c0 27.2025 42.1875 27.2025 42.1875 0V221.66140625c0-13.095 0.02109375-25.29984375-3.3075-38.23875-8.6821875-33.76265625-42.90046875-55.39640625-76.41-55.39640625H213.32515625c-50.304375 0-85.05 34.745625-85.05 85.05v611.45296875c0 36.13359375 22.15265625 64.24734375 55.39640625 76.41 11.8209375 4.3284375 25.74703125 3.3075 38.23875 3.3075H826.5921875c43.925625 0 75.75609375-35.63578125 77.89078125-77.89078125 1.37109375-27.20671875-40.820625-27.07171875-42.1875 0z"  ></path><path d="M495.2853125 279.88015625v472.5c0 27.2025 42.18328125 27.2025 42.18328125 0v-472.5c0-27.2025-42.18328125-27.2025-42.18328125 0z"  ></path><path d="M280.1290625 537.22390625h472.49578125c27.2025 0 27.2025-42.1875 0-42.1875H280.1290625c-27.20671875 0-27.20671875 42.1875 0 42.1875z"  ></path></symbol><symbol id="iconfullscreen" viewBox="0 0 1024 1024"><path d="M148.86663321 643.52658191h0.10791492a32.37444571 32.37444571 0 0 1 32.37444573 32.37444571V869.73762596a32.37444571 32.37444571 0 0 1-32.37444573 32.37444571H148.86663321a32.37444571 32.37444571 0 0 1-32.37444571-32.37444571V675.90102762a32.37444571 32.37444571 0 0 1 32.37444571-32.37444572z"  ></path><path d="M149.9457817 837.46030367h194.73229143a32.37444571 32.37444571 0 0 1 32.37444573 32.37444572 32.37444571 32.37444571 0 0 1-32.37444573 32.37444572H149.9457817a32.37444571 32.37444571 0 0 1-32.37444573-32.37444572 32.37444571 32.37444571 0 0 1 32.37444572-32.37444572z"  ></path><path d="M126.91675917 891.21267511a32.2449478 32.2449478 0 0 1 0.74461221-45.70192656l264.06756255-254.77609678a32.37444571 32.37444571 0 1 1 45.10839445 46.40337277L172.76976583 891.95728731a32.50394362 32.50394362 0 0 1-45.85300665-0.7446122zM875.03624335 120.80878063h0.09712344a32.37444571 32.37444571 0 0 1 32.37444571 32.3744457v193.84738984a32.37444571 32.37444571 0 0 1-32.37444571 32.37444573h-0.09712344a32.37444571 32.37444571 0 0 1-32.37444571-32.37444573V153.18322633a32.37444571 32.37444571 0 0 1 32.37444571-32.3744457z"  ></path><path d="M679.32192687 120.80878063H874.0542183a32.37444571 32.37444571 0 0 1 32.37444573 32.3744457 32.37444571 32.37444571 0 0 1-32.37444572 32.37444572H679.32192687a32.37444571 32.37444571 0 0 1-32.37444573-32.37444572 32.37444571 32.37444571 0 0 1 32.37444572-32.3744457z"  ></path><path d="M897.08324083 131.70817721a32.2449478 32.2449478 0 0 1-0.74461221 45.70192576l-264.06756255 254.78688829a32.37444571 32.37444571 0 1 1-45.10839445-46.40337201l264.06756255-254.7760968a32.50394362 32.50394362 0 0 1 45.85300666 0.69065474zM154.26237404 116.4921875h193.83659834a32.37444571 32.37444571 0 0 1 32.37444572 32.37444571v0.09712344a32.37444571 32.37444571 0 0 1-32.37444571 32.37444571H154.26237404a32.37444571 32.37444571 0 0 1-32.37444571-32.37444571V148.86663321A32.37444571 32.37444571 0 0 1 154.26237404 116.4921875z"  ></path><path d="M154.26237404 117.57133597a32.37444571 32.37444571 0 0 1 32.37444571 32.37444573v194.78624812a32.37444571 32.37444571 0 0 1-32.37444571 32.37444649 32.37444571 32.37444571 0 0 1-32.37444571-32.37444649V149.9457817A32.37444571 32.37444571 0 0 1 154.26237404 117.57133597z"  ></path><path d="M132.78732489 126.91675917a32.2449478 32.2449478 0 0 1 45.70192656 0.74461221l254.77609678 264.06756255a32.37444571 32.37444571 0 1 1-46.40337277 45.10839445L132.04271269 172.76976583a32.50394362 32.50394362 0 0 1 0.7446122-45.85300665zM676.96938383 842.66179764H870.81677367a32.37444571 32.37444571 0 0 1 32.3744457 32.37444571v0.09712344a32.37444571 32.37444571 0 0 1-32.3744457 32.37444571H676.96938383a32.37444571 32.37444571 0 0 1-32.37444573-32.37444571v-0.09712344a32.37444571 32.37444571 0 0 1 32.37444573-32.37444571z"  ></path><path d="M870.81677367 646.99064711a32.37444571 32.37444571 0 0 1 32.3744457 32.37444572V874.0542183a32.37444571 32.37444571 0 0 1-32.3744457 32.37444573 32.37444571 32.37444571 0 0 1-32.37444572-32.37444572V679.32192687a32.37444571 32.37444571 0 0 1 32.37444572-32.33127976z"  ></path><path d="M892.29182279 897.08324083a32.2449478 32.2449478 0 0 1-45.70192576-0.74461221l-254.78688829-264.06756255a32.37444571 32.37444571 0 1 1 46.40337201-45.10839445l254.7760968 264.06756255a32.50394362 32.50394362 0 0 1-0.69065474 45.85300666z"  ></path></symbol><symbol id="iconloading" viewBox="0 0 1024 1024"><path d="M873.29375001 569.0375c-15.1875-3.6-30.20625001 5.79375001-33.86250002 20.86875001C803.31875001 742.7375 668.375 849.5 511.38124999 849.5c-94.78125001 0-181.06875001-39.375-242.83124999-103.89375001-7.70625001-7.93125001-14.34375001-16.425-21.09375001-24.91874999-5.4-6.80625001-10.9125-13.3875-15.74999998-20.64374999-4.44375001-6.525-8.04374999-13.44375001-11.92500002-20.19375001-5.85-10.18125001-11.64375001-20.30625001-16.48124999-31.1625-2.025-4.6125-3.4875-9.3375-5.2875-14.00624999C192.78124999 621.29375001 188 607.68125001 184.4 593.39375001c-14.11875001-56.75625001-12.9375-116.325 3.4875-173.58750002C191.4875 407.375 195.14374999 395 199.98124999 383.24374999c5.34375001-12.88125001 11.98125001-25.25625001 19.01250002-37.63124999C277.60624999 241.94375001 387.125 174.5 511.38124999 174.5c157.05 0 291.9375 106.7625 328.10625001 259.59375001C842.525 447.0875 854.05625001 455.75 866.825 455.75c2.19375001 0 4.275-0.225 6.46875001-0.7875 15.1875-3.54375001 24.525-18.73125001 20.86874999-33.8625C851.975 242.84374999 694.53125001 118.25 511.38124999 118.25 371.54374999 118.25 247.175 191.15 177.0875 304.83124999 176.91874999 305.1125 176.6375 305.28124999 176.46874999 305.5625 173.76874999 309.89374999 172.1375 314.61874999 169.6625 319.00624999 161.84374999 332.84374999 154.19374999 346.7375 148.11874999 361.64374999c-5.90625001 14.175-10.06875001 28.6875-14.23124999 43.25625001C132.3125 410.35624999 129.89374999 415.475 128.54374999 421.15624999 128.43124999 421.55 128.6 421.8875 128.4875 422.28124999 114.5375 481.0625 115.15624999 541.53125001 128.43124999 599.69375001c0.1125 1.125-0.1125 2.08124999 0.11250002 3.20624999 0.3375 1.40625001 1.0125 2.75625001 1.35 4.1625 4.05 16.36874999 9.5625 32.23125001 15.75 48.0375 2.08124999 5.45625001 3.825 11.025 6.24374999 16.36874999 5.5125 12.54375001 12.31875001 24.525 19.2375 36.39375001 4.5 7.9875 8.775 15.975 13.78125001 23.5125 5.7375 8.38125001 12.2625 16.3125 18.61874999 24.4125 7.81875001 9.9 15.58125001 19.6875 24.3 28.74374999 1.8 1.9125 3.20625001 4.10625001 5.0625 5.9625l0.675-0.675C305.3375 861.7625 403.55 905.75 511.38124999 905.75c183.15 0 340.59375001-124.59375001 382.78125001-302.90625001C897.7625 587.76875001 888.425 572.58125001 873.29375001 569.0375z"  ></path></symbol><symbol id="iconplay" viewBox="0 0 1024 1024"><path d="M859.97188741 465.05141158L219.26174595 67.36925455c-35.90186097-22.0934536-82.85044939 5.52336372-82.85044938 46.94858842v795.36431406c0 41.42522469 46.94858842 69.04204071 82.85044938 46.94858842l637.94846025-397.68215703c38.66354348-19.33177108 38.66354348-74.56540445 2.76168121-93.89717684z"  ></path></symbol><symbol id="iconpause" viewBox="0 0 1024 1024"><path d="M349.866667 149.333333h-14.933334c-21.333333 0-36.266667 14.933333-36.266666 34.133334v654.933333c0 19.2 14.933333 34.133333 34.133333 34.133333h14.933333c19.2 0 34.133333-14.933333 34.133334-34.133333V183.466667c2.133333-19.2-12.8-34.133333-32-34.133334z m341.333333 0h-14.933333c-21.333333 0-36.266667 14.933333-36.266667 34.133334v654.933333c0 19.2 14.933333 34.133333 34.133333 34.133333h14.933334c19.2 0 34.133333-14.933333 34.133333-34.133333V183.466667c2.133333-19.2-12.8-34.133333-32-34.133334z"  ></path></symbol><symbol id="iconmute" viewBox="0 0 1024 1024"><path d="M525.65333333 125.1555552h-2.2755552c-9.10222187 0-18.2044448 2.2755552-27.30666666 9.10222293-134.25777813 116.05333333-204.8 177.49333333-211.62666667 184.32H175.21777813c-13.65333333 0-25.03111147 4.55111147-34.13333333 13.65333334-11.37777813 11.37777813-15.92888853 22.7555552-15.9288896 34.13333333v295.82222187c0 13.65333333 4.55111147 25.03111147 13.65333333 34.13333333 9.10222187 9.10222187 20.48 13.65333333 34.13333334 13.65333333H284.4444448c2.2755552 2.2755552 22.7555552 20.48 56.88888853 50.06222187 34.13333333 29.58222187 70.54222187 59.1644448 102.4 86.47111147 34.13333333 27.30666667 50.06222187 43.2355552 52.33777814 43.2355552 9.10222187 6.82666667 18.2044448 9.10222187 27.30666666 9.10222293h2.2755552c18.2044448-2.2755552 29.58222187-13.65333333 34.13333334-34.13333333v-705.42222294c-4.55111147-20.48-15.92888853-31.85777813-34.13333334-34.13333333z m-9.10222186 721.35111147c-6.82666667-4.55111147-211.62666667-182.0444448-211.62666667-182.0444448H172.94222187V361.81333333h131.98222293s50.06222187-45.51111147 211.62666667-186.5955552v671.28888854zM794.16888853 512l95.57333334-95.57333333c9.10222187-9.10222187 9.10222187-22.7555552 0-31.85777814s-22.7555552-9.10222187-31.85777707 0L762.31111147 480.14222187l-95.57333334-95.57333334c-9.10222187-9.10222187-22.7555552-9.10222187-31.85777813 0s-9.10222187 22.7555552 0 31.85777814l95.57333333 95.57333333-95.57333333 95.57333333c-9.10222187 9.10222187-9.10222187 22.7555552 0 31.85777814s22.7555552 9.10222187 31.85777813 0l95.57333334-95.57333334 95.57333333 95.57333334c9.10222187 9.10222187 22.7555552 9.10222187 31.85777707 0s9.10222187-22.7555552 0-31.85777814L794.16888853 512z"  ></path></symbol><symbol id="iconvolume" viewBox="0 0 1024 1024"><path d="M535.466667 149.333333H533.333333c-8.533333 0-17.066667 2.133333-25.6 8.533334-125.866667 108.8-192 166.4-198.4 172.8H204.8c-12.8 0-23.466667 4.266667-32 12.8-8.533333 8.533333-12.8 19.2-12.8 32v277.333333c0 12.8 4.266667 23.466667 12.8 32 8.533333 8.533333 19.2 12.8 32 12.8h102.4c2.133333 2.133333 21.333333 19.2 53.333333 46.933333 32 27.733333 66.133333 55.466667 96 81.066667 32 25.6 46.933333 40.533333 49.066667 40.533333 8.533333 6.4 17.066667 8.533333 25.6 8.533334h2.133333c17.066667-2.133333 27.733333-12.8 32-32v-661.333334c-2.133333-19.2-12.8-29.866667-29.866666-32z m-10.666667 676.266667c-6.4-4.266667-198.4-170.666667-198.4-170.666667H202.666667V371.2h123.733333s46.933333-42.666667 198.4-174.933333v629.333333z m262.4-535.466667c-8.533333-10.666667-21.333333-10.666667-32-2.133333-8.533333 8.533333-8.533333 19.2-2.133333 27.733333 42.666667 53.333333 68.266667 121.6 68.266666 196.266667 0 74.666667-25.6 142.933333-68.266666 196.266667-6.4 8.533333-6.4 19.2 2.133333 27.733333s23.466667 8.533333 32-2.133333c49.066667-61.866667 76.8-138.666667 76.8-224s-29.866667-157.866667-76.8-219.733334z m-123.733333 89.6c-8.533333 8.533333-8.533333 19.2-4.266667 25.6 21.333333 29.866667 32 68.266667 32 106.666667 0 40.533333-12.8 76.8-32 106.666667-6.4 8.533333-4.266667 19.2 2.133333 25.6 8.533333 8.533333 23.466667 8.533333 32-2.133334 25.6-38.4 40.533333-83.2 40.533334-130.133333 0-49.066667-14.933333-93.866667-40.533334-130.133333-4.266667-10.666667-19.2-12.8-29.866666-2.133334z"  ></path></symbol><symbol id="iconexitfullscreen" viewBox="0 0 1024 1024"><path d="M692 842v-90c0-51 39-90 90-90h90c18 0 30-12 30-30s-12-30-30-30h-90c-84 0-150 66-150 150v90c0 18 12 30 30 30s30-12 30-30z m-60-660v90c0 84 66 150 150 150h90c18 0 30-12 30-30s-12-30-30-30h-90c-51 0-90-39-90-90v-90c0-18-12-30-30-30s-30 12-30 30z m-240 660v-90c0-84-66-150-150-150h-90c-18 0-30 12-30 30s12 30 30 30h90c51 0 90 39 90 90v90c0 18 12 30 30 30s30-12 30-30z m-60-660v90c0 51-39 90-90 90h-90c-18 0-30 12-30 30s12 30 30 30h90c84 0 150-66 150-150v-90c0-18-12-30-30-30s-30 12-30 30z"  ></path></symbol></svg>';if((t=document.getElementsByTagName("script"))[t.length-1].getAttribute("data-injectcss")&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(t){console&&console.log(t)}}!function(t){if(document.addEventListener)if(~["complete","loaded","interactive"].indexOf(document.readyState))setTimeout(t,0);else{var s=function(){document.removeEventListener("DOMContentLoaded",s,!1),t()};document.addEventListener("DOMContentLoaded",s,!1)}else document.attachEvent&&(i=t,r=e.document,o=!1,(a=function(){try{r.documentElement.doScroll("left")}catch(e){return void setTimeout(a,50)}n()})(),r.onreadystatechange=function(){"complete"==r.readyState&&(r.onreadystatechange=null,n())});function n(){o||(o=!0,i())}var i,r,o,a}((function(){var e,t,n,i,r,o;(e=document.createElement("div")).innerHTML=s,s=null,(t=e.getElementsByTagName("svg")[0])&&(t.setAttribute("aria-hidden","true"),t.style.position="absolute",t.style.width=0,t.style.height=0,t.style.overflow="hidden",n=t,(i=document.body).firstChild?(r=n,(o=i.firstChild).parentNode.insertBefore(r,o)):i.appendChild(n))}))}(window),e.PreviewPlayer=Gt,e.ReplayPlayer=Ut,e.UrlPlayer=wt,Object.defineProperty(e,"__esModule",{value:!0})}));
